{"version":3,"sources":["plugins/experimentalWarnings/plugin.js"],"names":["define","_require","_exports","_globalize","userSettings","_apphost","_interopRequireDefault","obj","__esModule","default","_typeof","Symbol","iterator","constructor","prototype","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_getRequireWildcardCache","WeakMap","cache","_interopRequireWildcard","has","get","newObj","hasPropertyDescriptor","getOwnPropertyDescriptor","hasOwnProperty","call","desc","set","showMessage","text","userSettingsKey","appHostFeature","appHost","supports","Promise","resolve","now","Date","getFullYear","getWeek","date","d","UTC","getMonth","getDate","dayNum","getUTCDay","setUTCDate","getUTCDate","yearStart","getUTCFullYear","Math","ceil","reject","_resolve","_reject","imported","then","_ref","alert","value","_default","ExpirementalPlaybackWarnings","_classCallCheck","instance","Constructor","TypeError","this","name","type","id","_createClass","protoProps","staticProps","intercept","options","item","VideoType","showIsoMessage","globalize","translate","showBlurayMessage","showDvdMessage"],"mappings":"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","file":"plugin.js","sourcesContent":["import globalize from 'globalize';\nimport * as userSettings from 'userSettings';\nimport appHost from 'apphost';\n\n// TODO: Replace with date-fns\n// https://stackoverflow.com/questions/6117814/get-week-of-year-in-javascript-like-in-php\nfunction getWeek(date) {\n    const d = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));\n    const dayNum = d.getUTCDay() || 7;\n    d.setUTCDate(d.getUTCDate() + 4 - dayNum);\n    const yearStart = new Date(Date.UTC(d.getUTCFullYear(), 0, 1));\n    return Math.ceil((((d - yearStart) / 86400000) + 1) / 7);\n}\n\nfunction showMessage(text, userSettingsKey, appHostFeature) {\n    if (appHost.supports(appHostFeature)) {\n        return Promise.resolve();\n    }\n\n    const now = new Date();\n\n    // TODO: Use date-fns\n    userSettingsKey += now.getFullYear() + '-w' + getWeek(now);\n\n    if (userSettings.get(userSettingsKey, false) === '1') {\n        return Promise.resolve();\n    }\n\n    return new Promise(function (resolve, reject) {\n        userSettings.set(userSettingsKey, '1', false);\n\n        import('alert').then(({default: alert}) => {\n            return alert(text).then(resolve, resolve);\n        });\n    });\n}\n\nfunction showBlurayMessage() {\n    return showMessage(globalize.translate('UnsupportedPlayback'), 'blurayexpirementalinfo', 'nativeblurayplayback');\n}\n\nfunction showDvdMessage() {\n    return showMessage(globalize.translate('UnsupportedPlayback'), 'dvdexpirementalinfo', 'nativedvdplayback');\n}\n\nfunction showIsoMessage() {\n    return showMessage(globalize.translate('UnsupportedPlayback'), 'isoexpirementalinfo', 'nativeisoplayback');\n}\n\nclass ExpirementalPlaybackWarnings {\n    constructor() {\n        this.name = 'Experimental playback warnings';\n        this.type = 'preplayintercept';\n        this.id = 'expirementalplaybackwarnings';\n    }\n\n    intercept(options) {\n        const item = options.item;\n        if (!item) {\n            return Promise.resolve();\n        }\n\n        if (item.VideoType === 'Iso') {\n            return showIsoMessage();\n        }\n\n        if (item.VideoType === 'BluRay') {\n            return showBlurayMessage();\n        }\n\n        if (item.VideoType === 'Dvd') {\n            return showDvdMessage();\n        }\n\n        return Promise.resolve();\n    }\n}\n\nexport default ExpirementalPlaybackWarnings;\n"]}