{"version":3,"sources":["scripts/themeManager.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","define","_exports","webSettings","_getRequireWildcardCache","WeakMap","cache","Object","defineProperty","value","default","_interopRequireWildcard","__esModule","has","get","newObj","hasPropertyDescriptor","getOwnPropertyDescriptor","key","hasOwnProperty","call","desc","set","currentThemeId","themeStyleElement","document","querySelector","getThemes","_default","setTheme","id","Promise","resolve","reject","getThemeStylesheetInfo","then","themes","theme","find","stylesheetPath","themeId","info","linkUrl","unloadTheme","removeAttribute","link","createElement","setAttribute","body","appendChild","addEventListener","onLoad","e","target","removeEventListener"],"mappings":"AAAA,SAASA,QAAQC,KAAmV,OAAtOD,QAArD,mBAAXE,QAAoD,iBAApBA,OAAOC,SAAmC,SAASH,QAAQC,KAAO,cAAcA,KAA2B,SAASD,QAAQC,KAAO,OAAOA,KAAyB,mBAAXC,QAAyBD,IAAIG,cAAgBF,QAAUD,MAAQC,OAAOG,UAAY,gBAAkBJ,MAAyBA,KAEnXK,OAAO,CAAC,UAAW,gBAAgB,SAAUC,SAAUC,aACrD,aAQA,SAASC,2BAA6B,GAAuB,mBAAZC,QAAwB,OAAO,KAAM,IAAIC,MAAQ,IAAID,QAA6F,OAAlFD,yBAA2B,SAASA,2BAA6B,OAAOE,OAAiBA,MAN1MC,OAAOC,eAAeN,SAAU,aAAc,CAC5CO,OAAO,IAETP,SAASQ,aAAU,EARrBP,YAaE,SAASQ,wBAAwBf,KAAO,GAAIA,KAAOA,IAAIgB,WAAc,OAAOhB,IAAO,GAAY,OAARA,KAAiC,WAAjBD,QAAQC,MAAoC,mBAARA,IAAsB,MAAO,CAAEc,QAASd,KAAS,IAAIU,MAAQF,2BAA4B,GAAIE,OAASA,MAAMO,IAAIjB,KAAQ,OAAOU,MAAMQ,IAAIlB,KAAQ,IAAImB,OAAS,GAAQC,sBAAwBT,OAAOC,gBAAkBD,OAAOU,yBAA0B,IAAK,IAAIC,OAAOtB,IAAO,GAAIW,OAAOP,UAAUmB,eAAeC,KAAKxB,IAAKsB,KAAM,CAAE,IAAIG,KAAOL,sBAAwBT,OAAOU,yBAAyBrB,IAAKsB,KAAO,KAAUG,OAASA,KAAKP,KAAOO,KAAKC,KAAQf,OAAOC,eAAeO,OAAQG,IAAKG,MAAgBN,OAAOG,KAAOtB,IAAIsB,KAAYH,OAAOL,QAAUd,IAASU,OAASA,MAAMgB,IAAI1B,IAAKmB,QAAW,OAAOA,OAbluBJ,CAAAR,aAEA,IACIoB,eADAC,kBAAoBC,SAASC,cAAc,aAW/C,SAASC,YACL,OAAOxB,YAAYwB,YAqErB,IAAIC,SAXS,CACXD,UAAWA,UACXE,SA5CJ,SAASA,SAASC,IACd,OAAO,IAAIC,SAAQ,SAAUC,QAASC,QAC9BV,gBAAkBA,iBAAmBO,GACrCE,UAhBZ,SAASE,uBAAuBJ,IAC5B,OAAOH,YAAYQ,MAAK,SAAAC,QACpB,IAAIC,MAAQD,OAAOE,MAAK,SAAAD,OACpB,OAAOP,GAAKO,MAAMP,KAAOA,GAAKO,MAAM3B,WAGxC,MAAO,CACH6B,eAAgB,UAAYF,MAAMP,GAAK,aACvCU,QAASH,MAAMP,OAYnBI,CAAuBJ,IAAIK,MAAK,SAAUM,MACtC,GAAIlB,gBAAkBA,iBAAmBkB,KAAKD,QAC1CR,cADJ,CAKA,IAAIU,QAAUD,KAAKF,gBAtC/B,SAASI,cACMnB,oBAAAA,kBAEFoB,gBAAgB,QACrBrB,eAAiB,MAmCboB,GAEA,IAAIE,KAAOrB,kBAENqB,QAGDA,KAAOpB,SAASqB,cAAc,SACzBhB,GAAK,WACVe,KAAKE,aAAa,MAAO,cACzBF,KAAKE,aAAa,OAAQ,YAC1BtB,SAASuB,KAAKC,YAAYJ,OAQ9BA,KAAKK,iBAAiB,QALP,SAATC,OAAmBC,GACrBA,EAAEC,OAAOC,oBAAoB,OAAQH,QACrCnB,aAKJa,KAAKE,aAAa,OAAQL,SAC1BlB,kBAAoBqB,KACpBtB,eAAiBkB,KAAKD,iBAoBhCtC,SAASQ,QAAUkB","file":"themeManager.js","sourcesContent":["import * as webSettings from 'webSettings';\n\nvar themeStyleElement = document.querySelector('#cssTheme');\nvar currentThemeId;\n\nfunction unloadTheme() {\n    var elem = themeStyleElement;\n    if (elem) {\n        elem.removeAttribute('href');\n        currentThemeId = null;\n    }\n}\n\nfunction getThemes() {\n    return webSettings.getThemes();\n}\n\nfunction getThemeStylesheetInfo(id) {\n    return getThemes().then(themes => {\n        var theme = themes.find(theme => {\n            return id ? theme.id === id : theme.default;\n        });\n\n        return {\n            stylesheetPath: 'themes/' + theme.id + '/theme.css',\n            themeId: theme.id\n        };\n    });\n}\n\nfunction setTheme(id) {\n    return new Promise(function (resolve, reject) {\n        if (currentThemeId && currentThemeId === id) {\n            resolve();\n            return;\n        }\n\n        getThemeStylesheetInfo(id).then(function (info) {\n            if (currentThemeId && currentThemeId === info.themeId) {\n                resolve();\n                return;\n            }\n\n            var linkUrl = info.stylesheetPath;\n            unloadTheme();\n\n            let link = themeStyleElement;\n\n            if (!link) {\n                // Inject the theme css as a dom element in body so it will take\n                // precedence over other stylesheets\n                link = document.createElement('link');\n                link.id = 'cssTheme';\n                link.setAttribute('rel', 'stylesheet');\n                link.setAttribute('type', 'text/css');\n                document.body.appendChild(link);\n            }\n\n            const onLoad = function (e) {\n                e.target.removeEventListener('load', onLoad);\n                resolve();\n            };\n\n            link.addEventListener('load', onLoad);\n\n            link.setAttribute('href', linkUrl);\n            themeStyleElement = link;\n            currentThemeId = info.themeId;\n        });\n    });\n}\n\nexport default {\n    getThemes: getThemes,\n    setTheme: setTheme\n};\n"]}