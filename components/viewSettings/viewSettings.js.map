{"version":3,"sources":["components/viewSettings/viewSettings.js"],"names":["define","_require","_exports","_dialogHelper","_layoutManager","_globalize","userSettings","_embyCheckbox","_embyInput","_paperIconButtonLight","_embySelect","_materialIcons","_formdialog","_embyButton","_flexStyles","_interopRequireDefault","obj","__esModule","default","_typeof","Symbol","iterator","constructor","prototype","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_getRequireWildcardCache","WeakMap","cache","_interopRequireWildcard","has","get","newObj","hasPropertyDescriptor","getOwnPropertyDescriptor","hasOwnProperty","call","desc","set","_createForOfIteratorHelper","o","allowArrayLike","it","Array","isArray","_unsupportedIterableToArray","minLen","_arrayLikeToArray","n","toString","slice","name","from","test","F","s","done","value","e","_e","f","TypeError","err","normalCompletion","didErr","step","next","_e2","return","arr","len","arr2","onSubmit","preventDefault","centerFocus","elem","horiz","on","Promise","_resolve","_reject","imported","then","_ref","scrollHelper","fn","showIfAllowed","context","selector","visible","querySelector","classList","contains","remove","add","_default","ViewSettings","_classCallCheck","instance","Constructor","this","_createClass","protoProps","staticProps","show","options","resolve","reject","_ref2","template","dialogOptions","removeOnClose","scrollY","layoutManager","tv","size","dlg","dialogHelper","createDialog","html","innerHTML","globalize","translateHtml","_step3","submitted","_iterator3","querySelectorAll","settingElement","visibleSettings","indexOf","getAttribute","initEditor","settings","addEventListener","_step","_iterator","checked","imageType","close","dispatchEvent","CustomEvent","open","saveValues","settingsKey","_step2","_iterator2"],"mappings":"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","file":"viewSettings.js","sourcesContent":["import dialogHelper from 'dialogHelper';\nimport layoutManager from 'layoutManager';\nimport globalize from 'globalize';\nimport * as userSettings from 'userSettings';\nimport 'emby-checkbox';\nimport 'emby-input';\nimport 'paper-icon-button-light';\nimport 'emby-select';\nimport 'material-icons';\nimport 'css!./../formdialog';\nimport 'emby-button';\nimport 'flexStyles';\n\nfunction onSubmit(e) {\n    e.preventDefault();\n    return false;\n}\n\nfunction initEditor(context, settings) {\n    context.querySelector('form').addEventListener('submit', onSubmit);\n\n    const elems = context.querySelectorAll('.viewSetting-checkboxContainer');\n\n    for (const elem of elems) {\n        elem.querySelector('input').checked = settings[elem.getAttribute('data-settingname')] || false;\n    }\n\n    context.querySelector('.selectImageType').value = settings.imageType || 'primary';\n}\n\nfunction saveValues(context, settings, settingsKey) {\n    const elems = context.querySelectorAll('.viewSetting-checkboxContainer');\n    for (const elem of elems) {\n        userSettings.set(settingsKey + '-' + elem.getAttribute('data-settingname'), elem.querySelector('input').checked);\n    }\n\n    userSettings.set(settingsKey + '-imageType', context.querySelector('.selectImageType').value);\n}\n\nfunction centerFocus(elem, horiz, on) {\n    import('scrollHelper').then(({default: scrollHelper}) => {\n        const fn = on ? 'on' : 'off';\n        scrollHelper.centerFocus[fn](elem, horiz);\n    });\n}\n\nfunction showIfAllowed(context, selector, visible) {\n    const elem = context.querySelector(selector);\n\n    if (visible && !elem.classList.contains('hiddenFromViewSettings')) {\n        elem.classList.remove('hide');\n    } else {\n        elem.classList.add('hide');\n    }\n}\n\nclass ViewSettings {\n    constructor() {\n    }\n    show(options) {\n        return new Promise(function (resolve, reject) {\n            import('text!./viewSettings.template.html').then(({default: template}) => {\n                const dialogOptions = {\n                    removeOnClose: true,\n                    scrollY: false\n                };\n\n                if (layoutManager.tv) {\n                    dialogOptions.size = 'fullscreen';\n                } else {\n                    dialogOptions.size = 'small';\n                }\n\n                const dlg = dialogHelper.createDialog(dialogOptions);\n\n                dlg.classList.add('formDialog');\n\n                let html = '';\n\n                html += '<div class=\"formDialogHeader\">';\n                html += '<button is=\"paper-icon-button-light\" class=\"btnCancel hide-mouse-idle-tv\" tabindex=\"-1\"><span class=\"material-icons arrow_back\"></span></button>';\n                html += '<h3 class=\"formDialogHeaderTitle\">${Settings}</h3>';\n\n                html += '</div>';\n\n                html += template;\n\n                dlg.innerHTML = globalize.translateHtml(html, 'core');\n\n                const settingElements = dlg.querySelectorAll('.viewSetting');\n                for (const settingElement of settingElements) {\n                    if (options.visibleSettings.indexOf(settingElement.getAttribute('data-settingname')) === -1) {\n                        settingElement.classList.add('hide');\n                        settingElement.classList.add('hiddenFromViewSettings');\n                    } else {\n                        settingElement.classList.remove('hide');\n                        settingElement.classList.remove('hiddenFromViewSettings');\n                    }\n                }\n\n                initEditor(dlg, options.settings);\n\n                dlg.querySelector('.selectImageType').addEventListener('change', function () {\n                    showIfAllowed(dlg, '.chkTitleContainer', this.value !== 'list');\n                    showIfAllowed(dlg, '.chkYearContainer', this.value !== 'list');\n                });\n\n                dlg.querySelector('.btnCancel').addEventListener('click', function () {\n                    dialogHelper.close(dlg);\n                });\n\n                if (layoutManager.tv) {\n                    centerFocus(dlg.querySelector('.formDialogContent'), false, true);\n                }\n\n                let submitted;\n\n                dlg.querySelector('.selectImageType').dispatchEvent(new CustomEvent('change', {}));\n\n                dlg.querySelector('form').addEventListener('change', function () {\n                    submitted = true;\n                }, true);\n\n                dialogHelper.open(dlg).then(function () {\n                    if (layoutManager.tv) {\n                        centerFocus(dlg.querySelector('.formDialogContent'), false, false);\n                    }\n\n                    if (submitted) {\n                        saveValues(dlg, options.settings, options.settingsKey);\n                        resolve();\n                        return;\n                    }\n\n                    reject();\n                });\n            });\n        });\n    }\n}\n\nexport default ViewSettings;\n"]}