{"version":3,"sources":["components/guide/guide-settings.js"],"names":["define","_require","_exports","_dialogHelper","_globalize","userSettings","_layoutManager","_scrollHelper","_embyCheckbox","_embyRadio","_formdialog","_materialIcons","_interopRequireDefault","obj","__esModule","default","_typeof","Symbol","iterator","constructor","prototype","_getRequireWildcardCache","WeakMap","cache","_interopRequireWildcard","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","hasOwnProperty","call","desc","set","_createForOfIteratorHelper","o","allowArrayLike","it","Array","isArray","_unsupportedIterableToArray","minLen","_arrayLikeToArray","n","toString","slice","name","from","test","length","i","F","s","done","value","e","_e","f","TypeError","err","normalCompletion","didErr","step","next","_e2","return","arr","len","arr2","_default","show","showEditor","options","Promise","resolve","reject","settingsChanged","_resolve","_reject","imported","then","_ref","template","dialogOptions","removeOnClose","scrollY","layoutManager","tv","size","dlg","dialogHelper","createDialog","classList","add","html","globalize","translateHtml","innerHTML","addEventListener","scrollHelper","centerFocus","off","querySelector","save","context","_step3","_iterator3","querySelectorAll","chkIndicator","type","getAttribute","checked","_step4","_iterator4","sortBy","saveCategories","_step","categories","_iterator","chkCategory","push","close","on","load","_step5","_iterator5","_step6","sortByValue","_iterator6","loadCategories","_step2","selectedCategories","_iterator2","indexOf","open"],"mappings":"AAAAA,OAAO,CAAC,UAAW,UAAW,eAAgB,YAAa,eAAgB,gBAAiB,eAAgB,gBAAiB,aAAc,sBAAuB,mBAAmB,SAAUC,SAAUC,SAAUC,cAAeC,WAAYC,aAAcC,eAAgBC,cAAeC,cAAeC,WAAYC,YAAaC,gBACjU,aAYA,SAASC,uBAAuBC,KAAO,OAAOA,KAAOA,IAAIC,WAAaD,IAAM,CAAEE,QAASF,KAEvF,SAASG,QAAQH,KAAmV,OAAtOG,QAArD,mBAAXC,QAAoD,iBAApBA,OAAOC,SAAmC,SAASF,QAAQH,KAAO,cAAcA,KAA2B,SAASG,QAAQH,KAAO,OAAOA,KAAyB,mBAAXI,QAAyBJ,IAAIM,cAAgBF,QAAUJ,MAAQI,OAAOG,UAAY,gBAAkBP,MAAyBA,KAEnX,SAASQ,2BAA6B,GAAuB,mBAAZC,QAAwB,OAAO,KAAM,IAAIC,MAAQ,IAAID,QAA6F,OAAlFD,yBAA2B,SAASA,2BAA6B,OAAOE,OAAiBA,MAE1M,SAASC,wBAAwBX,KAAO,GAAIA,KAAOA,IAAIC,WAAc,OAAOD,IAAO,GAAY,OAARA,KAAiC,WAAjBG,QAAQH,MAAoC,mBAARA,IAAsB,MAAO,CAAEE,QAASF,KAAS,IAAIU,MAAQF,2BAA4B,GAAIE,OAASA,MAAME,IAAIZ,KAAQ,OAAOU,MAAMG,IAAIb,KAAQ,IAAIc,OAAS,GAAQC,sBAAwBC,OAAOC,gBAAkBD,OAAOE,yBAA0B,IAAK,IAAIC,OAAOnB,IAAO,GAAIgB,OAAOT,UAAUa,eAAeC,KAAKrB,IAAKmB,KAAM,CAAE,IAAIG,KAAOP,sBAAwBC,OAAOE,yBAAyBlB,IAAKmB,KAAO,KAAUG,OAASA,KAAKT,KAAOS,KAAKC,KAAQP,OAAOC,eAAeH,OAAQK,IAAKG,MAAgBR,OAAOK,KAAOnB,IAAImB,KAAyE,OAA7DL,OAAOZ,QAAUF,IAASU,OAASA,MAAMa,IAAIvB,IAAKc,QAAkBA,OAEhuB,SAASU,2BAA2BC,EAAGC,gBAAkB,IAAIC,GAAI,GAAsB,oBAAXvB,QAAgD,MAAtBqB,EAAErB,OAAOC,UAAmB,CAAE,GAAIuB,MAAMC,QAAQJ,KAAOE,GAE7J,SAASG,4BAA4BL,EAAGM,QAAU,IAAKN,EAAG,OAAQ,GAAiB,iBAANA,EAAgB,OAAOO,kBAAkBP,EAAGM,QAAS,IAAIE,EAAIjB,OAAOT,UAAU2B,SAASb,KAAKI,GAAGU,MAAM,GAAI,GAAc,WAANF,GAAkBR,EAAEnB,cAAa2B,EAAIR,EAAEnB,YAAY8B,MAAM,GAAU,QAANH,GAAqB,QAANA,EAAa,OAAOL,MAAMS,KAAKZ,GAAI,GAAU,cAANQ,GAAqB,2CAA2CK,KAAKL,GAAI,OAAOD,kBAAkBP,EAAGM,QAFpPD,CAA4BL,KAAOC,gBAAkBD,GAAyB,iBAAbA,EAAEc,OAAqB,CAAMZ,KAAIF,EAAIE,IAAI,IAAIa,EAAI,EAAOC,EAAI,SAASA,MAAQ,MAAO,CAAEC,EAAGD,EAAGR,EAAG,SAASA,IAAM,OAAIO,GAAKf,EAAEc,OAAe,CAAEI,MAAM,GAAe,CAAEA,MAAM,EAAOC,MAAOnB,EAAEe,OAAWK,EAAG,SAASA,EAAEC,IAAM,MAAMA,IAAOC,EAAGN,GAAO,MAAM,IAAIO,UAAU,yIAA4I,IAA6CC,IAAzCC,kBAAmB,EAAMC,QAAS,EAAY,MAAO,CAAET,EAAG,SAASA,IAAMf,GAAKF,EAAErB,OAAOC,aAAgB4B,EAAG,SAASA,IAAM,IAAImB,KAAOzB,GAAG0B,OAAsC,OAA9BH,iBAAmBE,KAAKT,KAAaS,MAASP,EAAG,SAASA,EAAES,KAAOH,QAAS,EAAMF,IAAMK,KAAQP,EAAG,SAASA,IAAM,IAAWG,kBAAiC,MAAbvB,GAAG4B,QAAgB5B,GAAG4B,SAAY,QAAU,GAAIJ,OAAQ,MAAMF,OAIl9B,SAASjB,kBAAkBwB,IAAKC,MAAkB,MAAPA,KAAeA,IAAMD,IAAIjB,UAAQkB,IAAMD,IAAIjB,QAAQ,IAAK,IAAIC,EAAI,EAAGkB,KAAO,IAAI9B,MAAM6B,KAAMjB,EAAIiB,IAAKjB,IAAOkB,KAAKlB,GAAKgB,IAAIhB,GAAM,OAAOkB,KAtBhL1C,OAAOC,eAAe5B,SAAU,aAAc,CAC5CuD,OAAO,IAETvD,SAASa,aAAU,EANrBZ,cAAAS,uBAAAT,eACAC,WAAAQ,uBAAAR,YACAC,aAAAmB,wBAAAnB,cACAC,eAAAM,uBAAAN,gBACAC,cAAAK,uBAAAL,eAyNE,IAAIiE,SA3ES,CACXC,KA7DJ,SAASC,WAAWC,SAChB,OAAO,IAAIC,SAAQ,SAAUC,QAASC,QAClC,IAAIC,iBAAkB,EAEtB,IAAAH,SAAA,SAAAI,SAAAC,SAAA,OAAAhF,SAAA,CAAO,wCAAP,SAAAiF,UAAA,OAAAF,SAAAxD,wBAAA0D,aAAAD,YAA8CE,MAAK,SAAAC,MAA2B,IAAfC,SAAeD,KAAxBrE,QAC5CuE,cAAgB,CAClBC,eAAe,EACfC,SAAS,GAGTC,eAAAA,QAAcC,GACdJ,cAAcK,KAAO,aAErBL,cAAcK,KAAO,QAGzB,IAAMC,IAAMC,cAAAA,QAAaC,aAAaR,eAEtCM,IAAIG,UAAUC,IAAI,cAElB,IAAIC,KAAO,GAEXA,MAAQC,WAAAA,QAAUC,cAAcd,SAAU,QAE1CO,IAAIQ,UAAYH,KAEhBL,IAAIS,iBAAiB,UAAU,WAC3BtB,iBAAkB,KAGtBa,IAAIS,iBAAiB,SAAS,WACtBZ,eAAAA,QAAcC,IACdY,cAAAA,QAAaC,YAAYC,IAAIZ,IAAIa,cAAc,uBAAuB,GA5E1F,SAASC,KAAKC,SACV,IADmBC,OAAAC,WAAAxE,2BACGsE,QAAQG,iBAAiB,kBAD5B,IAGnB,IAAAD,WAAAtD,MAAAqD,OAAAC,WAAA/D,KAAAU,MAA0C,CAAA,IAA/BuD,aAA+BH,OAAAnD,MAChCuD,KAAOD,aAAaE,aAAa,aACvC5G,aAAa+B,IAAI,mBAAqB4E,KAAMD,aAAaG,UAL1C,MAAApD,KAAA+C,WAAAnD,EAAAI,KAAA,QAAA+C,WAAAjD,IAQnBvD,aAAa+B,IAAI,8BAA+BuE,QAAQF,cAAc,6BAA6BS,SACnG7G,aAAa+B,IAAI,+BAAgCuE,QAAQF,cAAc,6BAA6BS,SAEpG,IAXmBC,OAAAC,WAAA/E,2BAWHsE,QAAQG,iBAAiB,kBAXtB,IAYnB,IAAAM,WAAA7D,MAAA4D,OAAAC,WAAAtE,KAAAU,MAA8B,CAAA,IAAnB6D,OAAmBF,OAAA1D,MAC1B,GAAI4D,OAAOH,QAAS,CAChB7G,aAAa+B,IAAI,sBAAuBiF,OAAO5D,OAC/C,QAfW,MAAAK,KAAAsD,WAAA1D,EAAAI,KAAA,QAAAsD,WAAAxD,KA+EP8C,CAAKd,KA/GrB,SAAS0B,eAAeX,QAAShC,SAC7B,IADsC4C,MAChCC,WAAa,GADmBC,UAAApF,2BAGjBsE,QAAQG,iBAAiB,iBAHR,IAItC,IAAAW,UAAAlE,MAAAgE,MAAAE,UAAA3E,KAAAU,MAAwC,CAAA,IAA7BkE,YAA6BH,MAAA9D,MAC9BuD,KAAOU,YAAYT,aAAa,aAElCS,YAAYR,SACZM,WAAWG,KAAKX,OARc,MAAAlD,KAAA2D,UAAA/D,EAAAI,KAAA,QAAA2D,UAAA7D,IAYlC4D,WAAWpE,QAAU,GACrBoE,WAAWG,KAAK,UAIpBH,WAAWG,KAAK,OAChBhD,QAAQ6C,WAAaA,WA8FTF,CAAe1B,IAAKjB,SAEhBI,gBACAF,UAEAC,YAIRc,IAAIa,cAAc,cAAcJ,iBAAiB,SAAS,WACtDR,cAAAA,QAAa+B,MAAMhC,QAGnBH,eAAAA,QAAcC,IACdY,cAAAA,QAAaC,YAAYsB,GAAGjC,IAAIa,cAAc,uBAAuB,GA1ErF,SAASqB,KAAKnB,SACV,IADmBoB,OAAAC,WAAA3F,2BACGsE,QAAQG,iBAAiB,kBAD5B,IAGnB,IAAAkB,WAAAzE,MAAAwE,OAAAC,WAAAlF,KAAAU,MAA0C,CAAA,IAA/BuD,aAA+BgB,OAAAtE,MAChCuD,KAAOD,aAAaE,aAAa,aAEW,SAA9CF,aAAaE,aAAa,gBAC1BF,aAAaG,QAA0D,UAAhD7G,aAAaqB,IAAI,mBAAqBsF,MAE7DD,aAAaG,QAA0D,SAAhD7G,aAAaqB,IAAI,mBAAqBsF,OATlD,MAAAlD,KAAAkE,WAAAtE,EAAAI,KAAA,QAAAkE,WAAApE,IAanB+C,QAAQF,cAAc,6BAA6BS,QAA8D,SAApD7G,aAAaqB,IAAI,+BAC9EiF,QAAQF,cAAc,6BAA6BS,QAA+D,UAArD7G,aAAaqB,IAAI,gCAE9E,IAhBmBuG,OAgBbC,YAAc7H,aAAaqB,IAAI,wBAA0B,SAhB5CyG,WAAA9F,2BAkBHsE,QAAQG,iBAAiB,kBAlBtB,IAmBnB,IAAAqB,WAAA5E,MAAA0E,OAAAE,WAAArF,KAAAU,MAA8B,CAAA,IAAnB6D,OAAmBY,OAAAxE,MAC1B4D,OAAOH,QAAUG,OAAO5D,QAAUyE,aApBnB,MAAApE,KAAAqE,WAAAzE,EAAAI,KAAA,QAAAqE,WAAAvE,KA6EXkE,CAAKlC,KA5GjB,SAASwC,eAAezB,QAAShC,SAC7B,IADsC0D,OAChCC,mBAAqB3D,QAAQ6C,YAAc,GADXe,WAAAlG,2BAGjBsE,QAAQG,iBAAiB,iBAHR,IAItC,IAAAyB,WAAAhF,MAAA8E,OAAAE,WAAAzF,KAAAU,MAAwC,CAAA,IAA7BkE,YAA6BW,OAAA5E,MAC9BuD,KAAOU,YAAYT,aAAa,aAEtCS,YAAYR,SAAWoB,mBAAmBlF,SAAgD,IAAtCkF,mBAAmBE,QAAQxB,OAP7C,MAAAlD,KAAAyE,WAAA7E,EAAAI,KAAA,QAAAyE,WAAA3E,KA6G9BwE,CAAexC,IAAKjB,SACpBkB,cAAAA,QAAa4C,KAAK7C,aAmF5B1F,SAASa,QAAUyD","file":"guide-settings.js","sourcesContent":["import dialogHelper from 'dialogHelper';\nimport globalize from 'globalize';\nimport * as userSettings from 'userSettings';\nimport layoutManager from 'layoutManager';\nimport scrollHelper from 'scrollHelper';\nimport 'emby-checkbox';\nimport 'emby-radio';\nimport 'css!./../formdialog';\nimport 'material-icons';\n\nfunction saveCategories(context, options) {\n    const categories = [];\n\n    const chkCategorys = context.querySelectorAll('.chkCategory');\n    for (const chkCategory of chkCategorys) {\n        const type = chkCategory.getAttribute('data-type');\n\n        if (chkCategory.checked) {\n            categories.push(type);\n        }\n    }\n\n    if (categories.length >= 4) {\n        categories.push('series');\n    }\n\n    // differentiate between none and all\n    categories.push('all');\n    options.categories = categories;\n}\n\nfunction loadCategories(context, options) {\n    const selectedCategories = options.categories || [];\n\n    const chkCategorys = context.querySelectorAll('.chkCategory');\n    for (const chkCategory of chkCategorys) {\n        const type = chkCategory.getAttribute('data-type');\n\n        chkCategory.checked = !selectedCategories.length || selectedCategories.indexOf(type) !== -1;\n    }\n}\n\nfunction save(context) {\n    const chkIndicators = context.querySelectorAll('.chkIndicator');\n\n    for (const chkIndicator of chkIndicators) {\n        const type = chkIndicator.getAttribute('data-type');\n        userSettings.set('guide-indicator-' + type, chkIndicator.checked);\n    }\n\n    userSettings.set('guide-colorcodedbackgrounds', context.querySelector('.chkColorCodedBackgrounds').checked);\n    userSettings.set('livetv-favoritechannelsattop', context.querySelector('.chkFavoriteChannelsAtTop').checked);\n\n    const sortBys = context.querySelectorAll('.chkSortOrder');\n    for (const sortBy of sortBys) {\n        if (sortBy.checked) {\n            userSettings.set('livetv-channelorder', sortBy.value);\n            break;\n        }\n    }\n}\n\nfunction load(context) {\n    const chkIndicators = context.querySelectorAll('.chkIndicator');\n\n    for (const chkIndicator of chkIndicators) {\n        const type = chkIndicator.getAttribute('data-type');\n\n        if (chkIndicator.getAttribute('data-default') === 'true') {\n            chkIndicator.checked = userSettings.get('guide-indicator-' + type) !== 'false';\n        } else {\n            chkIndicator.checked = userSettings.get('guide-indicator-' + type) === 'true';\n        }\n    }\n\n    context.querySelector('.chkColorCodedBackgrounds').checked = userSettings.get('guide-colorcodedbackgrounds') === 'true';\n    context.querySelector('.chkFavoriteChannelsAtTop').checked = userSettings.get('livetv-favoritechannelsattop') !== 'false';\n\n    const sortByValue = userSettings.get('livetv-channelorder') || 'Number';\n\n    const sortBys = context.querySelectorAll('.chkSortOrder');\n    for (const sortBy of sortBys) {\n        sortBy.checked = sortBy.value === sortByValue;\n    }\n}\n\nfunction showEditor(options) {\n    return new Promise(function (resolve, reject) {\n        let settingsChanged = false;\n\n        import('text!./guide-settings.template.html').then(({ default: template }) => {\n            const dialogOptions = {\n                removeOnClose: true,\n                scrollY: false\n            };\n\n            if (layoutManager.tv) {\n                dialogOptions.size = 'fullscreen';\n            } else {\n                dialogOptions.size = 'small';\n            }\n\n            const dlg = dialogHelper.createDialog(dialogOptions);\n\n            dlg.classList.add('formDialog');\n\n            let html = '';\n\n            html += globalize.translateHtml(template, 'core');\n\n            dlg.innerHTML = html;\n\n            dlg.addEventListener('change', function () {\n                settingsChanged = true;\n            });\n\n            dlg.addEventListener('close', function () {\n                if (layoutManager.tv) {\n                    scrollHelper.centerFocus.off(dlg.querySelector('.formDialogContent'), false);\n                }\n\n                save(dlg);\n                saveCategories(dlg, options);\n\n                if (settingsChanged) {\n                    resolve();\n                } else {\n                    reject();\n                }\n            });\n\n            dlg.querySelector('.btnCancel').addEventListener('click', function () {\n                dialogHelper.close(dlg);\n            });\n\n            if (layoutManager.tv) {\n                scrollHelper.centerFocus.on(dlg.querySelector('.formDialogContent'), false);\n            }\n\n            load(dlg);\n            loadCategories(dlg, options);\n            dialogHelper.open(dlg);\n        });\n    });\n}\n\nexport default {\n    show: showEditor\n};\n"]}