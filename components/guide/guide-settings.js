define(["require","exports","dialogHelper","globalize","userSettings","layoutManager","scrollHelper","emby-checkbox","emby-radio","css!./../formdialog","material-icons"],(function(_require,_exports,_dialogHelper,_globalize,userSettings,_layoutManager,_scrollHelper,_embyCheckbox,_embyRadio,_formdialog,_materialIcons){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _getRequireWildcardCache(){if("function"!=typeof WeakMap)return null;var cache=new WeakMap;return _getRequireWildcardCache=function _getRequireWildcardCache(){return cache},cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;if(null===obj||"object"!==_typeof(obj)&&"function"!=typeof obj)return{default:obj};var cache=_getRequireWildcardCache();if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}return newObj.default=obj,cache&&cache.set(obj,newObj),newObj}function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,_dialogHelper=_interopRequireDefault(_dialogHelper),_globalize=_interopRequireDefault(_globalize),userSettings=_interopRequireWildcard(userSettings),_layoutManager=_interopRequireDefault(_layoutManager),_scrollHelper=_interopRequireDefault(_scrollHelper);var _default={show:function showEditor(options){return new Promise((function(resolve,reject){var settingsChanged=!1;new Promise((function(_resolve,_reject){return _require(["text!./guide-settings.template.html"],(function(imported){return _resolve(_interopRequireWildcard(imported))}),_reject)})).then((function(_ref){var template=_ref.default,dialogOptions={removeOnClose:!0,scrollY:!1};_layoutManager.default.tv?dialogOptions.size="fullscreen":dialogOptions.size="small";var dlg=_dialogHelper.default.createDialog(dialogOptions);dlg.classList.add("formDialog");var html="";html+=_globalize.default.translateHtml(template,"core"),dlg.innerHTML=html,dlg.addEventListener("change",(function(){settingsChanged=!0})),dlg.addEventListener("close",(function(){_layoutManager.default.tv&&_scrollHelper.default.centerFocus.off(dlg.querySelector(".formDialogContent"),!1),function save(context){var _step3,_iterator3=_createForOfIteratorHelper(context.querySelectorAll(".chkIndicator"));try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var chkIndicator=_step3.value,type=chkIndicator.getAttribute("data-type");userSettings.set("guide-indicator-"+type,chkIndicator.checked)}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}userSettings.set("guide-colorcodedbackgrounds",context.querySelector(".chkColorCodedBackgrounds").checked),userSettings.set("livetv-favoritechannelsattop",context.querySelector(".chkFavoriteChannelsAtTop").checked);var _step4,_iterator4=_createForOfIteratorHelper(context.querySelectorAll(".chkSortOrder"));try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var sortBy=_step4.value;if(sortBy.checked){userSettings.set("livetv-channelorder",sortBy.value);break}}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}}(dlg),function saveCategories(context,options){var _step,categories=[],_iterator=_createForOfIteratorHelper(context.querySelectorAll(".chkCategory"));try{for(_iterator.s();!(_step=_iterator.n()).done;){var chkCategory=_step.value,type=chkCategory.getAttribute("data-type");chkCategory.checked&&categories.push(type)}}catch(err){_iterator.e(err)}finally{_iterator.f()}categories.length>=4&&categories.push("series"),categories.push("all"),options.categories=categories}(dlg,options),settingsChanged?resolve():reject()})),dlg.querySelector(".btnCancel").addEventListener("click",(function(){_dialogHelper.default.close(dlg)})),_layoutManager.default.tv&&_scrollHelper.default.centerFocus.on(dlg.querySelector(".formDialogContent"),!1),function load(context){var _step5,_iterator5=_createForOfIteratorHelper(context.querySelectorAll(".chkIndicator"));try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var chkIndicator=_step5.value,type=chkIndicator.getAttribute("data-type");"true"===chkIndicator.getAttribute("data-default")?chkIndicator.checked="false"!==userSettings.get("guide-indicator-"+type):chkIndicator.checked="true"===userSettings.get("guide-indicator-"+type)}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}context.querySelector(".chkColorCodedBackgrounds").checked="true"===userSettings.get("guide-colorcodedbackgrounds"),context.querySelector(".chkFavoriteChannelsAtTop").checked="false"!==userSettings.get("livetv-favoritechannelsattop");var _step6,sortByValue=userSettings.get("livetv-channelorder")||"Number",_iterator6=_createForOfIteratorHelper(context.querySelectorAll(".chkSortOrder"));try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var sortBy=_step6.value;sortBy.checked=sortBy.value===sortByValue}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}}(dlg),function loadCategories(context,options){var _step2,selectedCategories=options.categories||[],_iterator2=_createForOfIteratorHelper(context.querySelectorAll(".chkCategory"));try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var chkCategory=_step2.value,type=chkCategory.getAttribute("data-type");chkCategory.checked=!selectedCategories.length||-1!==selectedCategories.indexOf(type)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}(dlg,options),_dialogHelper.default.open(dlg)}))}))}};_exports.default=_default}));
//# sourceMappingURL=guide-settings.js.map
