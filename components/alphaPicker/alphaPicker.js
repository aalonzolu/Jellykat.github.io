define(["exports","focusManager","layoutManager","dom","css!./style.css","paper-icon-button-light","material-icons"],(function(_exports,_focusManager,_layoutManager,_dom,_style,_paperIconButtonLight,_materialIcons){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=_exports.AlphaPicker=void 0,_focusManager=_interopRequireDefault(_focusManager),_layoutManager=_interopRequireDefault(_layoutManager),_dom=_interopRequireDefault(_dom);var selectedButtonClass="alphaPickerButton-selected";function focus(){var selected=this.querySelector(".".concat(selectedButtonClass));selected?_focusManager.default.focus(selected):_focusManager.default.autoFocus(this,!0)}function getAlphaPickerButtonClassName(vertical){var alphaPickerButtonClassName="alphaPickerButton";return _layoutManager.default.tv&&(alphaPickerButtonClassName+=" alphaPickerButton-tv"),vertical&&(alphaPickerButtonClassName+=" alphaPickerButton-vertical"),alphaPickerButtonClassName}function mapLetters(letters,vertical){return letters.map((function(l){return function getLetterButton(l,vertical){return'<button data-value="'.concat(l,'" class="').concat(getAlphaPickerButtonClassName(vertical),'">').concat(l,"</button>")}(l,vertical)}))}var AlphaPicker=function(){function AlphaPicker(options){!function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,AlphaPicker);var self=this;this.options=options;var itemFocusValue,itemFocusTimeout,alphaFocusedElement,alphaFocusTimeout,element=options.element,itemsContainer=options.itemsContainer,itemClass=options.itemClass;function onItemFocusTimeout(){itemFocusTimeout=null,self.value(itemFocusValue)}function onAlphaFocusTimeout(){if(alphaFocusTimeout=null,document.activeElement===alphaFocusedElement){var value=alphaFocusedElement.getAttribute("data-value");self.value(value,!0)}}function onAlphaPickerInKeyboardModeClick(e){var alphaPickerButton=_dom.default.parentWithClass(e.target,"alphaPickerButton");if(alphaPickerButton){var value=alphaPickerButton.getAttribute("data-value");element.dispatchEvent(new CustomEvent("alphavalueclicked",{cancelable:!1,detail:{value:value}}))}}function onAlphaPickerClick(e){var alphaPickerButton=_dom.default.parentWithClass(e.target,"alphaPickerButton");if(alphaPickerButton){var value=alphaPickerButton.getAttribute("data-value");(this._currentValue||"").toUpperCase()===value.toUpperCase()?this.value(null,!0):this.value(value,!0)}}function onAlphaPickerFocusIn(e){alphaFocusTimeout&&(clearTimeout(alphaFocusTimeout),alphaFocusTimeout=null);var alphaPickerButton=_dom.default.parentWithClass(e.target,"alphaPickerButton");alphaPickerButton&&(alphaFocusedElement=alphaPickerButton,alphaFocusTimeout=setTimeout(onAlphaFocusTimeout,600))}function onItemsFocusIn(e){var item=_dom.default.parentWithClass(e.target,itemClass);if(item){var prefix=item.getAttribute("data-prefix");prefix&&prefix.length&&(itemFocusValue=prefix[0],itemFocusTimeout&&clearTimeout(itemFocusTimeout),itemFocusTimeout=setTimeout(onItemFocusTimeout,100))}}this.enabled=function(enabled){enabled?(itemsContainer&&itemsContainer.addEventListener("focus",onItemsFocusIn,!0),"keyboard"===options.mode&&element.addEventListener("click",onAlphaPickerInKeyboardModeClick),"click"!==options.valueChangeEvent?element.addEventListener("focus",onAlphaPickerFocusIn,!0):element.addEventListener("click",onAlphaPickerClick.bind(this))):(itemsContainer&&itemsContainer.removeEventListener("focus",onItemsFocusIn,!0),element.removeEventListener("click",onAlphaPickerInKeyboardModeClick),element.removeEventListener("focus",onAlphaPickerFocusIn,!0),element.removeEventListener("click",onAlphaPickerClick.bind(this)))},function render(element,options){element.classList.add("alphaPicker"),_layoutManager.default.tv&&element.classList.add("alphaPicker-tv");var vertical=element.classList.contains("alphaPicker-vertical");vertical||element.classList.add("focuscontainer-x");var letters,html="",alphaPickerButtonClassName=getAlphaPickerButtonClassName(vertical),rowClassName="alphaPickerRow";vertical&&(rowClassName+=" alphaPickerRow-vertical"),html+='<div class="'.concat(rowClassName,'">'),"keyboard"===options.mode?html+='<button data-value=" " is="paper-icon-button-light" class="'.concat(alphaPickerButtonClassName,'"><span class="material-icons alphaPickerButtonIcon space_bar"></span></button>'):html+=mapLetters(letters=["#"],vertical).join(""),html+=mapLetters(letters=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],vertical).join(""),"keyboard"===options.mode?(html+='<button data-value="backspace" is="paper-icon-button-light" class="'.concat(alphaPickerButtonClassName,'"><span class="material-icons alphaPickerButtonIcon backspace"></span></button>'),html+="</div>",letters=["0","1","2","3","4","5","6","7","8","9"],html+='<div class="'.concat(rowClassName,'">'),html+="<br/>",html+=mapLetters(letters,vertical).join(""),html+="</div>"):html+="</div>",element.innerHTML=html,element.classList.add("focusable"),element.focus=focus}(element,options),this.enabled(!0),this.visible(!0)}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(AlphaPicker,[{key:"value",value:function value(_value,applyValue){var btn,selected,element=this.options.element;if(void 0!==_value)if(null!=_value){if(_value=_value.toUpperCase(),this._currentValue=_value,"keyboard"!==this.options.mode){selected=element.querySelector(".".concat(selectedButtonClass));try{btn=element.querySelector(".alphaPickerButton[data-value='".concat(_value,"']"))}catch(err){console.error("error in querySelector:",err)}btn&&btn!==selected&&btn.classList.add(selectedButtonClass),selected&&selected!==btn&&selected.classList.remove(selectedButtonClass)}}else this._currentValue=_value,(selected=element.querySelector(".".concat(selectedButtonClass)))&&selected.classList.remove(selectedButtonClass);return applyValue&&element.dispatchEvent(new CustomEvent("alphavaluechanged",{cancelable:!1,detail:{value:_value}})),this._currentValue}},{key:"on",value:function on(name,fn){this.options.element.addEventListener(name,fn)}},{key:"off",value:function off(name,fn){this.options.element.removeEventListener(name,fn)}},{key:"visible",value:function visible(_visible){this.options.element.style.visibility=_visible?"visible":"hidden"}},{key:"values",value:function values(){for(var elems=this.options.element.querySelectorAll(".alphaPickerButton"),values=[],i=0,length=elems.length;i<length;i++)values.push(elems[i].getAttribute("data-value"));return values}},{key:"focus",value:function focus(){var element=this.options.element;_focusManager.default.autoFocus(element,!0)}},{key:"destroy",value:function destroy(){var element=this.options.element;this.enabled(!1),element.classList.remove("focuscontainer-x"),this.options=null}}]),AlphaPicker}();_exports.AlphaPicker=AlphaPicker;var _default=AlphaPicker;_exports.default=_default}));
//# sourceMappingURL=alphaPicker.js.map
