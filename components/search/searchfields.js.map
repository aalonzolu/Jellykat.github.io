{"version":3,"sources":["components/search/searchfields.js"],"names":["define","_require","_exports","_layoutManager","_globalize","_events","_browser","_alphaPicker","_embyInput","_flexStyles","_materialIcons","_searchfields","_interopRequireDefault","obj","__esModule","default","_typeof","Symbol","iterator","constructor","prototype","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_getRequireWildcardCache","WeakMap","cache","onSearchTimeout","value","this","nextSearchValue","trim","events","trigger","triggerSearch","instance","searchTimeout","clearTimeout","setTimeout","bind","onAlphaValueClicked","e","detail","txtSearch","options","element","querySelector","val","substring","dispatchEvent","CustomEvent","bubbles","initAlphaPicker","alphaPickerElement","alphaPicker","AlphaPicker","mode","addEventListener","onSearchInput","embed","elem","Promise","_resolve","_reject","imported","_interopRequireWildcard","has","get","newObj","hasPropertyDescriptor","getOwnPropertyDescriptor","hasOwnProperty","call","desc","set","then","_ref","template","html","globalize","translateHtml","browser","tizen","orsay","replace","innerHTML","classList","add","layoutManager","tv","remove","focus","_default","SearchFields","_classCallCheck","Constructor","TypeError","_createClass","protoProps","staticProps","destroy"],"mappings":"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","file":"searchfields.js","sourcesContent":["import layoutManager from 'layoutManager';\nimport globalize from 'globalize';\nimport events from 'events';\nimport browser from 'browser';\nimport AlphaPicker from 'alphaPicker';\nimport 'emby-input';\nimport 'flexStyles';\nimport 'material-icons';\nimport 'css!./searchfields';\n\n/* eslint-disable indent */\n\n    function onSearchTimeout() {\n        const instance = this;\n        let value = instance.nextSearchValue;\n\n        value = (value || '').trim();\n        events.trigger(instance, 'search', [value]);\n    }\n\n    function triggerSearch(instance, value) {\n        if (instance.searchTimeout) {\n            clearTimeout(instance.searchTimeout);\n        }\n\n        instance.nextSearchValue = value;\n        instance.searchTimeout = setTimeout(onSearchTimeout.bind(instance), 400);\n    }\n\n    function onAlphaValueClicked(e) {\n        const value = e.detail.value;\n        const searchFieldsInstance = this;\n\n        const txtSearch = searchFieldsInstance.options.element.querySelector('.searchfields-txtSearch');\n\n        if (value === 'backspace') {\n            const val = txtSearch.value;\n            txtSearch.value = val.length ? val.substring(0, val.length - 1) : '';\n        } else {\n            txtSearch.value += value;\n        }\n\n        txtSearch.dispatchEvent(new CustomEvent('input', {\n            bubbles: true\n        }));\n    }\n\n    function initAlphaPicker(alphaPickerElement, instance) {\n        instance.alphaPicker = new AlphaPicker({\n            element: alphaPickerElement,\n            mode: 'keyboard'\n        });\n\n        alphaPickerElement.addEventListener('alphavalueclicked', onAlphaValueClicked.bind(instance));\n    }\n\n    function onSearchInput(e) {\n        const value = e.target.value;\n        const searchFieldsInstance = this;\n        triggerSearch(searchFieldsInstance, value);\n    }\n\n    function embed(elem, instance, options) {\n        import('text!./searchfields.template.html').then(({default: template}) => {\n            let html = globalize.translateHtml(template, 'core');\n\n            if (browser.tizen || browser.orsay) {\n                html = html.replace('<input ', '<input readonly ');\n            }\n\n            elem.innerHTML = html;\n\n            elem.classList.add('searchFields');\n\n            const txtSearch = elem.querySelector('.searchfields-txtSearch');\n\n            if (layoutManager.tv) {\n                const alphaPickerElement = elem.querySelector('.alphaPicker');\n\n                elem.querySelector('.alphaPicker').classList.remove('hide');\n                initAlphaPicker(alphaPickerElement, instance);\n            }\n\n            txtSearch.addEventListener('input', onSearchInput.bind(instance));\n\n            instance.focus();\n        });\n    }\n\nclass SearchFields {\n    constructor(options) {\n        this.options = options;\n        embed(options.element, this, options);\n    }\n    focus() {\n        this.options.element.querySelector('.searchfields-txtSearch').focus();\n    }\n    destroy() {\n        const options = this.options;\n        if (options) {\n            options.element.classList.remove('searchFields');\n        }\n        this.options = null;\n\n        const alphaPicker = this.alphaPicker;\n        if (alphaPicker) {\n            alphaPicker.destroy();\n        }\n        this.alphaPicker = null;\n\n        const searchTimeout = this.searchTimeout;\n        if (searchTimeout) {\n            clearTimeout(searchTimeout);\n        }\n        this.searchTimeout = null;\n        this.nextSearchValue = null;\n    }\n}\n\nexport default SearchFields;\n\n/* eslint-enable indent */\n"]}