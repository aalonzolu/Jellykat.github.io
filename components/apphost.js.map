{"version":3,"sources":["components/apphost.js"],"names":["define","_require","_exports","_appSettings","_browser","_events","htmlMediaHelper","webSettings","_globalize","_interopRequireDefault","obj","__esModule","default","_typeof","Symbol","iterator","constructor","prototype","_getRequireWildcardCache","WeakMap","cache","_interopRequireWildcard","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","hasOwnProperty","call","desc","set","getBaseProfileOptions","item","disableHlsVideoAudioCodecs","enableHlsJsPlayer","RunTimeTicks","MediaType","browser","edge","push","enableMkvProgressive","generateDeviceId","keys","navigator","userAgent","Date","getTime","window","btoa","result","replaceAll","originalString","strReplace","strWith","strReplace2","escapeRegExp","str","replace","reg","RegExp","join","Promise","resolve","onAppVisible","isHidden","console","debug","events","trigger","appHost","onAppHidden","value","features","exitPromise","deviceId","deviceName","supportedFeatures","share","edgeUwp","tv","xboxOne","ps4","operaTv","tizen","orsay","web0s","supportsVoiceInput","SpeechRecognition","webkitSpeechRecognition","mozSpeechRecognition","oSpeechRecognition","msSpeechRecognition","supportsHtmlMediaAutoplay","mobile","supportsFullscreen","element","document","documentElement","requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen","createElement","webkitEnterFullscreen","getMultiServer","then","enabled","firefox","supportsCue","video","style","textContent","body","appendChild","cue","getComputedStyle","background","removeChild","length","err","error","chrome","edgeChromium","doExit","NativeShell","AppHost","exit","application","getCurrentApplication","webOS","platformBack","close","hidden","visibilityChange","getWindowState","windowState","setWindowState","alert","appMode","askForExit","_resolve","_reject","imported","_ref2","actionsheet","show","title","globalize","translate","items","id","name","finally","supports","command","indexOf","toLowerCase","preferVisualCards","android","getDefaultLayout","getDeviceProfile","options","arguments","undefined","_ref","profile","profileBuilder","builderOpts","enableSsaRender","isRetry","appSettings","init","getDeviceName","opera","safari","ipad","iphone","getDeviceId","appName","appVersion","getPushTokenInfo","setUserScalable","scalable","att","querySelector","setAttribute","webkitHidden","addEventListener","_default"],"mappings":"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","file":"apphost.js","sourcesContent":["import appSettings from 'appSettings';\nimport browser from 'browser';\nimport events from 'events';\nimport * as htmlMediaHelper from 'htmlMediaHelper';\nimport * as webSettings from 'webSettings';\nimport globalize from 'globalize';\n\nfunction getBaseProfileOptions(item) {\n    const disableHlsVideoAudioCodecs = [];\n\n    if (item && htmlMediaHelper.enableHlsJsPlayer(item.RunTimeTicks, item.MediaType)) {\n        if (browser.edge) {\n            disableHlsVideoAudioCodecs.push('mp3');\n        }\n\n        disableHlsVideoAudioCodecs.push('ac3');\n        disableHlsVideoAudioCodecs.push('eac3');\n        disableHlsVideoAudioCodecs.push('opus');\n    }\n\n    return {\n        enableMkvProgressive: false,\n        disableHlsVideoAudioCodecs: disableHlsVideoAudioCodecs\n    };\n}\n\nfunction getDeviceProfile(item, options = {}) {\n    return new Promise(function (resolve) {\n        import('browserdeviceprofile').then(({default: profileBuilder}) => {\n            let profile;\n\n            if (window.NativeShell) {\n                profile = window.NativeShell.AppHost.getDeviceProfile(profileBuilder);\n            } else {\n                const builderOpts = getBaseProfileOptions(item);\n                builderOpts.enableSsaRender = (item && !options.isRetry && appSettings.get('subtitleburnin') !== 'allcomplexformats');\n                profile = profileBuilder(builderOpts);\n            }\n\n            resolve(profile);\n        });\n    });\n}\n\nfunction escapeRegExp(str) {\n    return str.replace(/([.*+?^=!:${}()|[\\]/\\\\])/g, '\\\\$1');\n}\n\nfunction replaceAll(originalString, strReplace, strWith) {\n    const strReplace2 = escapeRegExp(strReplace);\n    const reg = new RegExp(strReplace2, 'ig');\n    return originalString.replace(reg, strWith);\n}\n\nfunction generateDeviceId() {\n    const keys = [];\n\n    if (keys.push(navigator.userAgent), keys.push(new Date().getTime()), window.btoa) {\n        const result = replaceAll(btoa(keys.join('|')), '=', '1');\n        return Promise.resolve(result);\n    }\n\n    return Promise.resolve(new Date().getTime());\n}\n\nfunction getDeviceId() {\n    const key = '_deviceId2';\n    const deviceId = appSettings.get(key);\n\n    if (deviceId) {\n        return Promise.resolve(deviceId);\n    }\n\n    return generateDeviceId().then(function (deviceId) {\n        appSettings.set(key, deviceId);\n        return deviceId;\n    });\n}\n\nfunction getDeviceName() {\n    var deviceName;\n    if (browser.tizen) {\n        deviceName = 'Samsung Smart TV';\n    } else if (browser.web0s) {\n        deviceName = 'LG Smart TV';\n    } else if (browser.operaTv) {\n        deviceName = 'Opera TV';\n    } else if (browser.xboxOne) {\n        deviceName = 'Xbox One';\n    } else if (browser.ps4) {\n        deviceName = 'Sony PS4';\n    } else if (browser.chrome) {\n        deviceName = 'Chrome';\n    } else if (browser.edgeChromium) {\n        deviceName = 'Edge Chromium';\n    } else if (browser.edge) {\n        deviceName = 'Edge';\n    } else if (browser.firefox) {\n        deviceName = 'Firefox';\n    } else if (browser.opera) {\n        deviceName = 'Opera';\n    } else if (browser.safari) {\n        deviceName = 'Safari';\n    } else {\n        deviceName = 'Web Browser';\n    }\n\n    if (browser.ipad) {\n        deviceName += ' iPad';\n    } else if (browser.iphone) {\n        deviceName += ' iPhone';\n    } else if (browser.android) {\n        deviceName += ' Android';\n    }\n\n    return deviceName;\n}\n\nfunction supportsVoiceInput() {\n    if (!browser.tv) {\n        return window.SpeechRecognition || window.webkitSpeechRecognition || window.mozSpeechRecognition || window.oSpeechRecognition || window.msSpeechRecognition;\n    }\n\n    return false;\n}\n\nfunction supportsFullscreen() {\n    if (browser.tv) {\n        return false;\n    }\n\n    const element = document.documentElement;\n    return (element.requestFullscreen || element.mozRequestFullScreen || element.webkitRequestFullscreen || element.msRequestFullscreen) || document.createElement('video').webkitEnterFullscreen;\n}\n\nfunction getDefaultLayout() {\n    return 'desktop';\n}\n\nfunction supportsHtmlMediaAutoplay() {\n    if (browser.edgeUwp || browser.tizen || browser.web0s || browser.orsay || browser.operaTv || browser.ps4 || browser.xboxOne) {\n        return true;\n    }\n\n    if (browser.mobile) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction supportsCue() {\n    try {\n        const video = document.createElement('video');\n        const style = document.createElement('style');\n\n        style.textContent = 'video::cue {background: inherit}';\n        document.body.appendChild(style);\n        document.body.appendChild(video);\n\n        const cue = window.getComputedStyle(video, '::cue').background;\n        document.body.removeChild(style);\n        document.body.removeChild(video);\n\n        return !!cue.length;\n    } catch (err) {\n        console.error('error detecting cue support: ' + err);\n        return false;\n    }\n}\n\nfunction onAppVisible() {\n    if (isHidden) {\n        isHidden = false;\n        console.debug('triggering app resume event');\n        events.trigger(appHost, 'resume');\n    }\n}\n\nfunction onAppHidden() {\n    if (!isHidden) {\n        isHidden = true;\n        console.debug('app is hidden');\n    }\n}\n\nconst supportedFeatures = function () {\n    const features = [];\n\n    if (navigator.share) {\n        features.push('sharing');\n    }\n\n    if (!browser.edgeUwp && !browser.tv && !browser.xboxOne && !browser.ps4) {\n        features.push('filedownload');\n    }\n\n    if (browser.operaTv || browser.tizen || browser.orsay || browser.web0s) {\n        features.push('exit');\n    } else {\n        features.push('exitmenu');\n        features.push('plugins');\n    }\n\n    if (!browser.operaTv && !browser.tizen && !browser.orsay && !browser.web0s && !browser.ps4) {\n        features.push('externallinks');\n        features.push('externalpremium');\n    }\n\n    if (!browser.operaTv) {\n        features.push('externallinkdisplay');\n    }\n\n    if (supportsVoiceInput()) {\n        features.push('voiceinput');\n    }\n\n    if (supportsHtmlMediaAutoplay()) {\n        features.push('htmlaudioautoplay');\n        features.push('htmlvideoautoplay');\n    }\n\n    if (browser.edgeUwp) {\n        features.push('sync');\n    }\n\n    if (supportsFullscreen()) {\n        features.push('fullscreenchange');\n    }\n\n    if (browser.tv || browser.xboxOne || browser.ps4 || browser.mobile) {\n        features.push('physicalvolumecontrol');\n    }\n\n    if (!browser.tv && !browser.xboxOne && !browser.ps4) {\n        features.push('remotecontrol');\n    }\n\n    if (!browser.operaTv && !browser.tizen && !browser.orsay && !browser.web0s && !browser.edgeUwp) {\n        features.push('remotevideo');\n    }\n\n    features.push('displaylanguage');\n    features.push('otherapppromotions');\n    features.push('displaymode');\n    features.push('targetblank');\n    features.push('screensaver');\n\n    webSettings.getMultiServer().then(enabled => {\n        if (enabled) features.push('multiserver');\n    });\n\n    if (!browser.orsay && (browser.firefox || browser.ps4 || browser.edge || supportsCue())) {\n        features.push('subtitleappearancesettings');\n    }\n\n    if (!browser.orsay) {\n        features.push('subtitleburnsettings');\n    }\n\n    if (!browser.tv && !browser.ps4 && !browser.xboxOne) {\n        features.push('fileinput');\n    }\n\n    if (browser.chrome || browser.edgeChromium) {\n        features.push('chromecast');\n    }\n\n    return features;\n}();\n\n/**\n     * Do exit according to platform\n     */\nfunction doExit() {\n    try {\n        if (window.NativeShell) {\n            window.NativeShell.AppHost.exit();\n        } else if (browser.tizen) {\n            tizen.application.getCurrentApplication().exit();\n        } else if (browser.web0s) {\n            webOS.platformBack();\n        } else {\n            window.close();\n        }\n    } catch (err) {\n        console.error('error closing application: ' + err);\n    }\n}\n\nlet exitPromise;\n\n/**\n     * Ask user for exit\n     */\nfunction askForExit() {\n    if (exitPromise) {\n        return;\n    }\n\n    import('actionsheet').then(({default: actionsheet}) => {\n        exitPromise = actionsheet.show({\n            title: globalize.translate('MessageConfirmAppExit'),\n            items: [\n                {id: 'yes', name: globalize.translate('Yes')},\n                {id: 'no', name: globalize.translate('No')}\n            ]\n        }).then(function (value) {\n            if (value === 'yes') {\n                doExit();\n            }\n        }).finally(function () {\n            exitPromise = null;\n        });\n    });\n}\n\nlet deviceId;\nlet deviceName;\nconst appName = 'Jellyfin Web';\nconst appVersion = '10.7.0';\n\nconst appHost = {\n    getWindowState: function () {\n        return document.windowState || 'Normal';\n    },\n    setWindowState: function () {\n        alert('setWindowState is not supported and should not be called');\n    },\n    exit: function () {\n        if (!!window.appMode && browser.tizen) {\n            askForExit();\n        } else {\n            doExit();\n        }\n    },\n    supports: function (command) {\n        if (window.NativeShell) {\n            return window.NativeShell.AppHost.supports(command);\n        }\n\n        return supportedFeatures.indexOf(command.toLowerCase()) !== -1;\n    },\n    preferVisualCards: browser.android || browser.chrome,\n    getDefaultLayout: function () {\n        if (window.NativeShell) {\n            return window.NativeShell.AppHost.getDefaultLayout();\n        }\n\n        return getDefaultLayout();\n    },\n    getDeviceProfile: getDeviceProfile,\n    init: function () {\n        if (window.NativeShell) {\n            return window.NativeShell.AppHost.init();\n        }\n\n        deviceName = getDeviceName();\n        getDeviceId().then(function (id) {\n            deviceId = id;\n        });\n    },\n    deviceName: function () {\n        return window.NativeShell ? window.NativeShell.AppHost.deviceName() : deviceName;\n    },\n    deviceId: function () {\n        return window.NativeShell ? window.NativeShell.AppHost.deviceId() : deviceId;\n    },\n    appName: function () {\n        return window.NativeShell ? window.NativeShell.AppHost.appName() : appName;\n    },\n    appVersion: function () {\n        return window.NativeShell ? window.NativeShell.AppHost.appVersion() : appVersion;\n    },\n    getPushTokenInfo: function () {\n        return {};\n    },\n    setUserScalable: function (scalable) {\n        if (!browser.tv) {\n            const att = scalable ? 'width=device-width, initial-scale=1, minimum-scale=1, user-scalable=yes' : 'width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no';\n            document.querySelector('meta[name=viewport]').setAttribute('content', att);\n        }\n    }\n};\n\nlet isHidden = false;\nlet hidden;\nlet visibilityChange;\n\nif (typeof document.hidden !== 'undefined') { /* eslint-disable-line compat/compat */\n    hidden = 'hidden';\n    visibilityChange = 'visibilitychange';\n} else if (typeof document.webkitHidden !== 'undefined') {\n    hidden = 'webkitHidden';\n    visibilityChange = 'webkitvisibilitychange';\n}\n\ndocument.addEventListener(visibilityChange, function () {\n    /* eslint-disable-next-line compat/compat */\n    if (document[hidden]) {\n        onAppHidden();\n    } else {\n        onAppVisible();\n    }\n}, false);\n\nif (window.addEventListener) {\n    window.addEventListener('focus', onAppVisible);\n    window.addEventListener('blur', onAppHidden);\n}\n\nexport default appHost;\n"]}