{"version":3,"sources":["components/itemHelper.js"],"names":["define","_exports","_apphost","_globalize","_interopRequireDefault","obj","__esModule","default","getDisplayName","item","options","arguments","length","undefined","Error","Type","ProgramInfo","name","IsSeries","EpisodeTitle","Name","ChannelNumber","ParentIndexNumber","globalize","translate","IndexNumber","includeIndexNumber","displayIndexNumber","number","nameSeparator","includeParentInfo","IndexNumberEnd","supportsAddingToCollection","Status","CollectionType","indexOf","MediaType","isLocalItem","supportsAddingToPlaylist","IsFolder","canEdit","user","itemType","Policy","IsAdministrator","Id","canIdentify","canEditImages","canSync","EnableContentDownloading","SupportsSync","canShare","EnablePublicSharing","appHost","supports","enableDateAddedDisplay","canMarkPlayed","canRate","UserData","canConvert","EnableMediaConversion","mediaType","type","LocationType","IsPlaceHolder","canRefreshMetadata","supportsMediaSourceSelection","MediaSources","EnableMediaSourceDisplay","SourceType","Object","defineProperty","value","_default"],"mappings":"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","file":"itemHelper.js","sourcesContent":["import appHost from 'apphost';\nimport globalize from 'globalize';\n\nexport function getDisplayName(item, options = {}) {\n    if (!item) {\n        throw new Error('null item passed into getDisplayName');\n    }\n\n    if (item.Type === 'Timer') {\n        item = item.ProgramInfo || item;\n    }\n\n    let name = ((item.Type === 'Program' || item.Type === 'Recording') && (item.IsSeries || item.EpisodeTitle) ? item.EpisodeTitle : item.Name) || '';\n\n    if (item.Type === 'TvChannel') {\n        if (item.ChannelNumber) {\n            return item.ChannelNumber + ' ' + name;\n        }\n        return name;\n    }\n    if (item.Type === 'Episode' && item.ParentIndexNumber === 0) {\n        name = globalize.translate('ValueSpecialEpisodeName', name);\n    } else if ((item.Type === 'Episode' || item.Type === 'Program') && item.IndexNumber != null && item.ParentIndexNumber != null && options.includeIndexNumber !== false) {\n        let displayIndexNumber = item.IndexNumber;\n\n        let number = displayIndexNumber;\n        let nameSeparator = ' - ';\n\n        if (options.includeParentInfo !== false) {\n            number = 'S' + item.ParentIndexNumber + ':E' + number;\n        } else {\n            nameSeparator = '. ';\n        }\n\n        if (item.IndexNumberEnd) {\n            displayIndexNumber = item.IndexNumberEnd;\n            number += '-' + displayIndexNumber;\n        }\n\n        if (number) {\n            name = name ? (number + nameSeparator + name) : number;\n        }\n    }\n\n    return name;\n}\n\nexport function supportsAddingToCollection(item) {\n    const invalidTypes = ['Genre', 'MusicGenre', 'Studio', 'UserView', 'CollectionFolder', 'Audio', 'Program', 'Timer', 'SeriesTimer'];\n\n    if (item.Type === 'Recording') {\n        if (item.Status !== 'Completed') {\n            return false;\n        }\n    }\n\n    return !item.CollectionType && invalidTypes.indexOf(item.Type) === -1 && item.MediaType !== 'Photo' && !isLocalItem(item);\n}\n\nexport function supportsAddingToPlaylist(item) {\n    if (item.Type === 'Program') {\n        return false;\n    }\n    if (item.Type === 'TvChannel') {\n        return false;\n    }\n    if (item.Type === 'Timer') {\n        return false;\n    }\n    if (item.Type === 'SeriesTimer') {\n        return false;\n    }\n    if (item.MediaType === 'Photo') {\n        return false;\n    }\n\n    if (item.Type === 'Recording') {\n        if (item.Status !== 'Completed') {\n            return false;\n        }\n    }\n\n    if (isLocalItem(item)) {\n        return false;\n    }\n    if (item.CollectionType === 'livetv') {\n        return false;\n    }\n\n    return item.MediaType || item.IsFolder || item.Type === 'Genre' || item.Type === 'MusicGenre' || item.Type === 'MusicArtist';\n}\n\nexport function canEdit(user, item) {\n    const itemType = item.Type;\n\n    if (itemType === 'UserRootFolder' || itemType === 'UserView') {\n        return false;\n    }\n\n    if (itemType === 'Program') {\n        return false;\n    }\n\n    if (itemType === 'Timer') {\n        return false;\n    }\n\n    if (itemType === 'SeriesTimer') {\n        return false;\n    }\n\n    if (item.Type === 'Recording') {\n        if (item.Status !== 'Completed') {\n            return false;\n        }\n    }\n\n    if (isLocalItem(item)) {\n        return false;\n    }\n\n    return user.Policy.IsAdministrator;\n}\n\nexport function isLocalItem(item) {\n    if (item && item.Id && item.Id.indexOf('local') === 0) {\n        return true;\n    }\n\n    return false;\n}\n\nexport function canIdentify (user, item) {\n    const itemType = item.Type;\n\n    if (itemType === 'Movie' ||\n        itemType === 'Trailer' ||\n        itemType === 'Series' ||\n        itemType === 'BoxSet' ||\n        itemType === 'Person' ||\n        itemType === 'Book' ||\n        itemType === 'MusicAlbum' ||\n        itemType === 'MusicArtist' ||\n        itemType === 'MusicVideo') {\n        if (user.Policy.IsAdministrator) {\n            if (!isLocalItem(item)) {\n                return true;\n            }\n        }\n    }\n\n    return false;\n}\n\nexport function canEditImages (user, item) {\n    const itemType = item.Type;\n\n    if (item.MediaType === 'Photo') {\n        return false;\n    }\n\n    if (itemType === 'UserView') {\n        if (user.Policy.IsAdministrator) {\n            return true;\n        }\n\n        return false;\n    }\n\n    if (item.Type === 'Recording') {\n        if (item.Status !== 'Completed') {\n            return false;\n        }\n    }\n\n    return itemType !== 'Timer' && itemType !== 'SeriesTimer' && canEdit(user, item) && !isLocalItem(item);\n}\n\nexport function canSync (user, item) {\n    if (user && !user.Policy.EnableContentDownloading) {\n        return false;\n    }\n\n    if (isLocalItem(item)) {\n        return false;\n    }\n\n    return item.SupportsSync;\n}\n\nexport function canShare (item, user) {\n    if (item.Type === 'Program') {\n        return false;\n    }\n    if (item.Type === 'TvChannel') {\n        return false;\n    }\n    if (item.Type === 'Timer') {\n        return false;\n    }\n    if (item.Type === 'SeriesTimer') {\n        return false;\n    }\n    if (item.Type === 'Recording') {\n        if (item.Status !== 'Completed') {\n            return false;\n        }\n    }\n    if (isLocalItem(item)) {\n        return false;\n    }\n    return user.Policy.EnablePublicSharing && appHost.supports('sharing');\n}\n\nexport function enableDateAddedDisplay (item) {\n    return !item.IsFolder && item.MediaType && item.Type !== 'Program' && item.Type !== 'TvChannel' && item.Type !== 'Trailer';\n}\n\nexport function canMarkPlayed (item) {\n    if (item.Type === 'Program') {\n        return false;\n    }\n\n    if (item.MediaType === 'Video') {\n        if (item.Type !== 'TvChannel') {\n            return true;\n        }\n    } else if (item.MediaType === 'Audio') {\n        if (item.Type === 'AudioPodcast') {\n            return true;\n        }\n        if (item.Type === 'AudioBook') {\n            return true;\n        }\n    }\n\n    if (item.Type === 'Series' ||\n        item.Type === 'Season' ||\n        item.Type === 'BoxSet' ||\n        item.MediaType === 'Book' ||\n        item.MediaType === 'Recording') {\n        return true;\n    }\n\n    return false;\n}\n\nexport function canRate (item) {\n    if (item.Type === 'Program'\n        || item.Type === 'Timer'\n        || item.Type === 'SeriesTimer'\n        || item.Type === 'CollectionFolder'\n        || item.Type === 'UserView'\n        || item.Type === 'Channel'\n        || !item.UserData) {\n        return false;\n    }\n\n    return true;\n}\n\nexport function canConvert (item, user) {\n    if (!user.Policy.EnableMediaConversion) {\n        return false;\n    }\n\n    if (isLocalItem(item)) {\n        return false;\n    }\n\n    const mediaType = item.MediaType;\n    if (mediaType === 'Book' || mediaType === 'Photo' || mediaType === 'Audio') {\n        return false;\n    }\n\n    const collectionType = item.CollectionType;\n    if (collectionType === 'livetv') {\n        return false;\n    }\n\n    const type = item.Type;\n    if (type === 'Channel' || type === 'Person' || type === 'Year' || type === 'Program' || type === 'Timer' || type === 'SeriesTimer') {\n        return false;\n    }\n\n    if (item.LocationType === 'Virtual' && !item.IsFolder) {\n        return false;\n    }\n\n    if (item.IsPlaceHolder) {\n        return false;\n    }\n\n    return true;\n}\n\nexport function canRefreshMetadata (item, user) {\n    if (user.Policy.IsAdministrator) {\n        const collectionType = item.CollectionType;\n        if (collectionType === 'livetv') {\n            return false;\n        }\n\n        if (item.Type !== 'Timer' && item.Type !== 'SeriesTimer' && item.Type !== 'Program' && item.Type !== 'TvChannel' && !(item.Type === 'Recording' && item.Status !== 'Completed')) {\n            if (!isLocalItem(item)) {\n                return true;\n            }\n        }\n    }\n\n    return false;\n}\n\nexport function supportsMediaSourceSelection (item) {\n    if (item.MediaType !== 'Video') {\n        return false;\n    }\n    if (item.Type === 'TvChannel') {\n        return false;\n    }\n    if (!item.MediaSources || (item.MediaSources.length === 1 && item.MediaSources[0].Type === 'Placeholder')) {\n        return false;\n    }\n    if (item.EnableMediaSourceDisplay === false) {\n        return false;\n    }\n    if (item.EnableMediaSourceDisplay == null && item.SourceType && item.SourceType !== 'Library') {\n        return false;\n    }\n\n    return true;\n}\n\nexport default {\n    getDisplayName: getDisplayName,\n    supportsAddingToCollection: supportsAddingToCollection,\n    supportsAddingToPlaylist: supportsAddingToPlaylist,\n    isLocalItem: isLocalItem,\n    canIdentify: canIdentify,\n    canEdit: canEdit,\n    canEditImages: canEditImages,\n    canSync: canSync,\n    canShare: canShare,\n    enableDateAddedDisplay: enableDateAddedDisplay,\n    canMarkPlayed: canMarkPlayed,\n    canRate: canRate,\n    canConvert: canConvert,\n    canRefreshMetadata: canRefreshMetadata,\n    supportsMediaSourceSelection: supportsMediaSourceSelection\n};\n"]}