define(["require","exports","dom","browser","events","emby-tabs","emby-button"],(function(_require,_exports,_dom,_browser,_events,_embyTabs,_embyButton){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _getRequireWildcardCache(){if("function"!=typeof WeakMap)return null;var cache=new WeakMap;return _getRequireWildcardCache=function _getRequireWildcardCache(){return cache},cache}var tabOwnerView;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.setTabs=function setTabs(view,selectedIndex,getTabsFn,getTabContainersFn,onBeforeTabChange,onTabChange,setSelectedIndex){if(!view)return tabOwnerView&&(headerTabsContainer||(headerTabsContainer=queryScope.querySelector(".headerTabs")),ensureElements(),document.body.classList.remove("withSectionTabs"),headerTabsContainer.innerHTML="",headerTabsContainer.classList.add("hide"),tabOwnerView=null),{tabsContainer:headerTabsContainer,replaced:!1};ensureElements();var tabsContainerElem=headerTabsContainer;tabOwnerView||tabsContainerElem.classList.remove("hide");if(tabOwnerView!==view){var index=0,tabsHtml='<div is="emby-tabs"'+(null==selectedIndex?"":' data-index="'+selectedIndex+'"')+' class="tabs-viewmenubar"><div class="emby-tabs-slider" style="white-space:nowrap;">'+getTabsFn().map((function(t){var tabHtml,tabClass="emby-tab-button";return!1===t.enabled&&(tabClass+=" hide"),t.cssClass&&(tabClass+=" "+t.cssClass),tabHtml=t.href?'<a href="'+t.href+'" is="emby-linkbutton" class="'+tabClass+'" data-index="'+index+'"><div class="emby-button-foreground">'+t.name+"</div></a>":'<button type="button" is="emby-button" class="'+tabClass+'" data-index="'+index+'"><div class="emby-button-foreground">'+t.name+"</div></button>",index++,tabHtml})).join("")+"</div></div>";return tabsContainerElem.innerHTML=tabsHtml,window.CustomElements.upgradeSubtree(tabsContainerElem),document.body.classList.add("withSectionTabs"),tabOwnerView=view,tabsElem=tabsContainerElem.querySelector('[is="emby-tabs"]'),function configureSwipeTabs(view,tabsElem,getTabContainersFn){if(!_browser.default.touch)return;var onSwipeLeft=function onSwipeLeft(e,target){allowSwipe(target)&&view.contains(target)&&tabsElem.selectNext()},onSwipeRight=function onSwipeRight(e,target){allowSwipe(target)&&view.contains(target)&&tabsElem.selectPrevious()};new Promise((function(_resolve,_reject){return _require(["touchHelper"],(function(imported){return _resolve(function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;if(null===obj||"object"!==_typeof(obj)&&"function"!=typeof obj)return{default:obj};var cache=_getRequireWildcardCache();if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}newObj.default=obj,cache&&cache.set(obj,newObj);return newObj}(imported))}),_reject)})).then((function(_ref){var touchHelper=new(0,_ref.default)(view.parentNode.parentNode);_events.default.on(touchHelper,"swipeleft",onSwipeLeft),_events.default.on(touchHelper,"swiperight",onSwipeRight),view.addEventListener("viewdestroy",(function(){touchHelper.destroy()}))}))}(view,tabsElem),tabsElem.addEventListener("beforetabchange",(function(e){var tabContainers=getTabContainersFn();if(null!=e.detail.previousIndex){var previousPanel=tabContainers[e.detail.previousIndex];previousPanel&&previousPanel.classList.remove("is-active")}var newPanel=tabContainers[e.detail.selectedTabIndex];newPanel&&newPanel.classList.add("is-active")})),onBeforeTabChange&&tabsElem.addEventListener("beforetabchange",onBeforeTabChange),onTabChange&&tabsElem.addEventListener("tabchange",onTabChange),!1!==setSelectedIndex&&(tabsElem.selectedIndex?tabsElem.selectedIndex(selectedIndex):(tabsElem.readySelectedIndex=selectedIndex,tabsElem.addEventListener("ready",onViewTabsReady))),{tabsContainer:tabsContainerElem,tabs:tabsContainerElem.querySelector('[is="emby-tabs"]'),replaced:!0}}tabsElem||(tabsElem=tabsContainerElem.querySelector('[is="emby-tabs"]'));return tabsElem.selectedIndex(selectedIndex),tabOwnerView=view,{tabsContainer:tabsContainerElem,tabs:tabsElem,replaced:!1}},_exports.selectedTabIndex=function selectedTabIndex(index){var tabsContainerElem=headerTabsContainer;tabsElem||(tabsElem=tabsContainerElem.querySelector('[is="emby-tabs"]'));null!=index?tabsElem.selectedIndex(index):tabsElem.triggerTabChange()},_exports.getTabsElement=function getTabsElement(){return document.querySelector(".tabs-viewmenubar")},_dom=_interopRequireDefault(_dom),_browser=_interopRequireDefault(_browser),_events=_interopRequireDefault(_events);var headerTabsContainer,tabsElem,queryScope=document.querySelector(".skinHeader");function ensureElements(){headerTabsContainer||(headerTabsContainer=queryScope.querySelector(".headerTabs"))}function onViewTabsReady(){this.selectedIndex(this.readySelectedIndex),this.readySelectedIndex=null}function allowSwipe(target){function allowSwipeOn(elem){if(_dom.default.parentWithTag(elem,"input"))return!1;var classList=elem.classList;return!classList||!classList.contains("scrollX")&&!classList.contains("animatedScrollX")}for(var parent=target;null!=parent;){if(!allowSwipeOn(parent))return!1;parent=parent.parentNode}return!0}}));
//# sourceMappingURL=maintabsmanager.js.map
