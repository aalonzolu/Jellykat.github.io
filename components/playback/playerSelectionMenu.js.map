{"version":3,"sources":["components/playback/playerSelectionMenu.js"],"names":["define","_require","_exports","_appSettings","_events","_browser","_loading","_playbackManager","_appRouter","_globalize","_apphost","_interopRequireDefault","obj","__esModule","default","_typeof","Symbol","iterator","constructor","prototype","_slicedToArray","arr","i","_arrayWithHoles","Array","isArray","_iterableToArrayLimit","Object","_arr","_n","_d","_e","undefined","_s","_i","next","done","push","value","length","err","_unsupportedIterableToArray","o","minLen","_arrayLikeToArray","n","toString","call","slice","name","from","test","_nonIterableRest","TypeError","len","arr2","_getRequireWildcardCache","WeakMap","cache","_interopRequireWildcard","has","get","newObj","hasPropertyDescriptor","defineProperty","getOwnPropertyDescriptor","key","hasOwnProperty","desc","set","mirrorIfEnabled","info","playbackManager","enableDisplayMirroring","getPlayerInfo","isLocalPlayer","supportedCommands","indexOf","mirrorItem","player","item","displayContent","ItemName","Name","ItemId","Id","ItemType","Type","Context","context","getCurrentPlayer","emptyCallback","getIcon","target","deviceType","browser","tv","mobile","show","button","currentPlayerInfo","currentPlayerId","id","loading","getTargets","then","targets","menuItems","map","t","appName","selected","secondaryText","user","icon","Promise","_resolve","_reject","imported","_ref","actionsheet","hide","menuOptions","title","globalize","translate","items","positionTo","resolveOnClick","border","chrome","edgeChromium","appHost","supports","enableHistory","filter","trySetActivePlayer","playerName","showActivePlayerMenu","playerInfo","all","_ref2","showActivePlayerMenuInternal","dialogHelper","html","dialogOptions","removeOnClose","dlg","createDialog","classList","add","currentDeviceName","deviceName","checkedHtml","innerHTML","chkMirror","querySelector","addEventListener","onMirrorChange","destination","btnRemoteControl","close","open","appRouter","showNowPlaying","disconnectFromPlayer","getSupportedCommands","_ref4","dialog","buttons","text","endSession","setDefaultPlayerActive","this","checked","document","e","detail","state","ServerId","events","on","appSettings","_default"],"mappings":"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","file":"playerSelectionMenu.js","sourcesContent":["import appSettings from 'appSettings';\nimport events from 'events';\nimport browser from 'browser';\nimport loading from 'loading';\nimport playbackManager from 'playbackManager';\nimport appRouter from 'appRouter';\nimport globalize from 'globalize';\nimport appHost from 'apphost';\n\nfunction mirrorItem(info, player) {\n    var item = info.item;\n\n    playbackManager.displayContent({\n\n        ItemName: item.Name,\n        ItemId: item.Id,\n        ItemType: item.Type,\n        Context: info.context\n    }, player);\n}\n\nfunction mirrorIfEnabled(info) {\n    if (info && playbackManager.enableDisplayMirroring()) {\n        var getPlayerInfo = playbackManager.getPlayerInfo();\n\n        if (getPlayerInfo) {\n            if (!getPlayerInfo.isLocalPlayer && getPlayerInfo.supportedCommands.indexOf('DisplayContent') !== -1) {\n                mirrorItem(info, playbackManager.getCurrentPlayer());\n            }\n        }\n    }\n}\n\nfunction emptyCallback() {\n    // avoid console logs about uncaught promises\n}\n\nfunction getTargetSecondaryText(target) {\n    if (target.user) {\n        return target.user.Name;\n    }\n\n    return null;\n}\n\nfunction getIcon(target) {\n    var deviceType = target.deviceType;\n\n    if (!deviceType && target.isLocalPlayer) {\n        if (browser.tv) {\n            deviceType = 'tv';\n        } else if (browser.mobile) {\n            deviceType = 'smartphone';\n        } else {\n            deviceType = 'desktop';\n        }\n    }\n\n    if (!deviceType) {\n        deviceType = 'tv';\n    }\n\n    switch (deviceType) {\n        case 'smartphone':\n            return 'smartphone';\n        case 'tablet':\n            return 'tablet';\n        case 'tv':\n            return 'tv';\n        case 'cast':\n            return 'cast';\n        case 'desktop':\n            return 'computer';\n        default:\n            return 'tv';\n    }\n}\n\nexport function show(button) {\n    var currentPlayerInfo = playbackManager.getPlayerInfo();\n\n    if (currentPlayerInfo) {\n        if (!currentPlayerInfo.isLocalPlayer) {\n            showActivePlayerMenu(currentPlayerInfo);\n            return;\n        }\n    }\n\n    var currentPlayerId = currentPlayerInfo ? currentPlayerInfo.id : null;\n\n    loading.show();\n\n    playbackManager.getTargets().then(function (targets) {\n        var menuItems = targets.map(function (t) {\n            var name = t.name;\n\n            if (t.appName && t.appName !== t.name) {\n                name += ' - ' + t.appName;\n            }\n\n            return {\n                name: name,\n                id: t.id,\n                selected: currentPlayerId === t.id,\n                secondaryText: getTargetSecondaryText(t),\n                icon: getIcon(t)\n            };\n        });\n\n        import('actionsheet').then(({default: actionsheet}) => {\n            loading.hide();\n\n            var menuOptions = {\n                title: globalize.translate('HeaderPlayOn'),\n                items: menuItems,\n                positionTo: button,\n\n                resolveOnClick: true,\n                border: true\n            };\n\n            // Unfortunately we can't allow the url to change or chromecast will throw a security error\n            // Might be able to solve this in the future by moving the dialogs to hashbangs\n            if (!(!browser.chrome && !browser.edgeChromium || appHost.supports('castmenuhashchange'))) {\n                menuOptions.enableHistory = false;\n            }\n\n            actionsheet.show(menuOptions).then(function (id) {\n                var target = targets.filter(function (t) {\n                    return t.id === id;\n                })[0];\n\n                playbackManager.trySetActivePlayer(target.playerName, target);\n\n                mirrorIfEnabled();\n            }, emptyCallback);\n        });\n    });\n}\n\nfunction showActivePlayerMenu(playerInfo) {\n    Promise.all([\n        import('dialogHelper'),\n        import('dialog'),\n        import('emby-checkbox'),\n        import('emby-button')\n    ]).then(([dialogHelper]) => {\n        showActivePlayerMenuInternal(dialogHelper, playerInfo);\n    });\n}\n\nfunction disconnectFromPlayer(currentDeviceName) {\n    if (playbackManager.getSupportedCommands().indexOf('EndSession') !== -1) {\n        import('dialog').then(({default: dialog}) => {\n            var menuItems = [];\n\n            menuItems.push({\n                name: globalize.translate('Yes'),\n                id: 'yes'\n            });\n            menuItems.push({\n                name: globalize.translate('No'),\n                id: 'no'\n            });\n\n            dialog({\n                buttons: menuItems,\n                text: globalize.translate('ConfirmEndPlayerSession', currentDeviceName)\n\n            }).then(function (id) {\n                switch (id) {\n                    case 'yes':\n                        playbackManager.getCurrentPlayer().endSession();\n                        playbackManager.setDefaultPlayerActive();\n                        break;\n                    case 'no':\n                        playbackManager.setDefaultPlayerActive();\n                        break;\n                    default:\n                        break;\n                }\n            });\n        });\n    } else {\n        playbackManager.setDefaultPlayerActive();\n    }\n}\n\nfunction showActivePlayerMenuInternal(dialogHelper, playerInfo) {\n    var html = '';\n\n    var dialogOptions = {\n        removeOnClose: true\n    };\n\n    dialogOptions.modal = false;\n    dialogOptions.entryAnimationDuration = 160;\n    dialogOptions.exitAnimationDuration = 160;\n    dialogOptions.autoFocus = false;\n\n    var dlg = dialogHelper.createDialog(dialogOptions);\n\n    dlg.classList.add('promptDialog');\n\n    var currentDeviceName = (playerInfo.deviceName || playerInfo.name);\n\n    html += '<div class=\"promptDialogContent\" style=\"padding:1.5em;\">';\n    html += '<h2 style=\"margin-top:.5em;\">';\n    html += currentDeviceName;\n    html += '</h2>';\n\n    html += '<div>';\n\n    if (playerInfo.supportedCommands.indexOf('DisplayContent') !== -1) {\n        html += '<label class=\"checkboxContainer\">';\n        var checkedHtml = playbackManager.enableDisplayMirroring() ? ' checked' : '';\n        html += '<input type=\"checkbox\" is=\"emby-checkbox\" class=\"chkMirror\"' + checkedHtml + '/>';\n        html += '<span>' + globalize.translate('EnableDisplayMirroring') + '</span>';\n        html += '</label>';\n    }\n\n    html += '</div>';\n\n    html += '<div style=\"margin-top:1em;display:flex;justify-content: flex-end;\">';\n\n    html += '<button is=\"emby-button\" type=\"button\" class=\"button-flat btnRemoteControl promptDialogButton\">' + globalize.translate('HeaderRemoteControl') + '</button>';\n    html += '<button is=\"emby-button\" type=\"button\" class=\"button-flat btnDisconnect promptDialogButton \">' + globalize.translate('Disconnect') + '</button>';\n    html += '<button is=\"emby-button\" type=\"button\" class=\"button-flat btnCancel promptDialogButton\">' + globalize.translate('ButtonCancel') + '</button>';\n    html += '</div>';\n\n    html += '</div>';\n    dlg.innerHTML = html;\n\n    var chkMirror = dlg.querySelector('.chkMirror');\n\n    if (chkMirror) {\n        chkMirror.addEventListener('change', onMirrorChange);\n    }\n\n    var destination = '';\n\n    var btnRemoteControl = dlg.querySelector('.btnRemoteControl');\n    if (btnRemoteControl) {\n        btnRemoteControl.addEventListener('click', function () {\n            destination = 'nowplaying';\n            dialogHelper.close(dlg);\n        });\n    }\n\n    dlg.querySelector('.btnDisconnect').addEventListener('click', function () {\n        destination = 'disconnectFromPlayer';\n        dialogHelper.close(dlg);\n    });\n\n    dlg.querySelector('.btnCancel').addEventListener('click', function () {\n        dialogHelper.close(dlg);\n    });\n\n    dialogHelper.open(dlg).then(function () {\n        if (destination === 'nowplaying') {\n            appRouter.showNowPlaying();\n        } else if (destination === 'disconnectFromPlayer') {\n            disconnectFromPlayer(currentDeviceName);\n        }\n    }, emptyCallback);\n}\n\nfunction onMirrorChange() {\n    playbackManager.enableDisplayMirroring(this.checked);\n}\n\ndocument.addEventListener('viewshow', function (e) {\n    var state = e.detail.state || {};\n    var item = state.item;\n\n    if (item && item.ServerId) {\n        mirrorIfEnabled({\n            item: item\n        });\n        return;\n    }\n});\n\nevents.on(appSettings, 'change', function (e, name) {\n    if (name === 'displaymirror') {\n        mirrorIfEnabled();\n    }\n});\n\nevents.on(playbackManager, 'pairing', function (e) {\n    loading.show();\n});\n\nevents.on(playbackManager, 'paired', function (e) {\n    loading.hide();\n});\n\nevents.on(playbackManager, 'pairerror', function (e) {\n    loading.hide();\n});\n\nexport default {\n    show: show\n};\n"]}