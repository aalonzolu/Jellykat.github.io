define(["exports","globalize","dom","dialogHelper","emby-checkbox","emby-select","emby-input"],(function(_exports,_globalize,_dom,_dialogHelper,_embyCheckbox,_embySelect,_embyInput){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function findImageOptions(imageOptions,type){return imageOptions.filter((function(i){return i.Type==type}))[0]}function getImageConfig(options,availableOptions,imageType,itemType){return findImageOptions(options.ImageOptions||[],imageType)||findImageOptions(availableOptions.DefaultImageOptions||[],imageType)||function getDefaultImageConfig(itemType,type){return{Type:type,MinWidth:0,Limit:"Primary"===type?1:0}}(0,imageType)}function setVisibilityOfBackdrops(elem,visible){visible?(elem.classList.remove("hide"),elem.querySelector("input").setAttribute("required","required")):(elem.classList.add("hide"),elem.querySelector("input").setAttribute("required",""),elem.querySelector("input").removeAttribute("required"))}function loadValues(context,itemType,options,availableOptions){var supportedImageTypes=availableOptions.SupportedImageTypes||[];setVisibilityOfBackdrops(context.querySelector(".backdropFields"),supportedImageTypes.includes("Backdrop")),setVisibilityOfBackdrops(context.querySelector(".screenshotFields"),supportedImageTypes.includes("Screenshot")),Array.prototype.forEach.call(context.querySelectorAll(".imageType"),(function(i){var imageType=i.getAttribute("data-imagetype"),container=_dom.default.parentWithTag(i,"LABEL");supportedImageTypes.includes(imageType)?container.classList.remove("hide"):container.classList.add("hide"),getImageConfig(options,availableOptions,imageType).Limit?i.checked=!0:i.checked=!1}));var backdropConfig=getImageConfig(options,availableOptions,"Backdrop");context.querySelector("#txtMaxBackdrops").value=backdropConfig.Limit,context.querySelector("#txtMinBackdropDownloadWidth").value=backdropConfig.MinWidth;var screenshotConfig=getImageConfig(options,availableOptions,"Screenshot");context.querySelector("#txtMaxScreenshots").value=screenshotConfig.Limit,context.querySelector("#txtMinScreenshotDownloadWidth").value=screenshotConfig.MinWidth}function saveValues(context,options){options.ImageOptions=Array.prototype.map.call(context.querySelectorAll(".imageType:not(.hide)"),(function(c){return{Type:c.getAttribute("data-imagetype"),Limit:c.checked?1:0,MinWidth:0}})),options.ImageOptions.push({Type:"Backdrop",Limit:context.querySelector("#txtMaxBackdrops").value,MinWidth:context.querySelector("#txtMinBackdropDownloadWidth").value}),options.ImageOptions.push({Type:"Screenshot",Limit:context.querySelector("#txtMaxScreenshots").value,MinWidth:context.querySelector("#txtMinScreenshotDownloadWidth").value})}function showEditor(_x,_x2,_x3){return _showEditor.apply(this,arguments)}function _showEditor(){return(_showEditor=_asyncToGenerator(regeneratorRuntime.mark((function _callee(itemType,options,availableOptions){var response,template,dlg;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,fetch("components/imageOptionsEditor/imageOptionsEditor.template.html");case 2:return response=_context.sent,_context.next=5,response.text();case 5:template=_context.sent,(dlg=_dialogHelper.default.createDialog({size:"small",removeOnClose:!0,scrollY:!1})).classList.add("formDialog"),dlg.innerHTML=_globalize.default.translateHtml(template),dlg.addEventListener("close",(function(){saveValues(dlg,options)})),loadValues(dlg,0,options,availableOptions),_dialogHelper.default.open(dlg).then((function(){})).catch((function(){})),dlg.querySelector(".btnCancel").addEventListener("click",(function(){_dialogHelper.default.close(dlg)}));case 13:case"end":return _context.stop()}}),_callee)})))).apply(this,arguments)}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=_exports.editor=void 0,_globalize=_interopRequireDefault(_globalize),_dom=_interopRequireDefault(_dom),_dialogHelper=_interopRequireDefault(_dialogHelper);var editor=function editor(){!function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,editor),this.show=showEditor};_exports.editor=editor;var _default=editor;_exports.default=_default}));
//# sourceMappingURL=imageOptionsEditor.js.map
