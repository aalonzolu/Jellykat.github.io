{"version":3,"sources":["controllers/dashboard/metadatanfo.js"],"names":["define","_require","_jQuery","_loading","_libraryMenu","_globalize","_interopRequireDefault","obj","__esModule","default","_typeof","Symbol","iterator","constructor","prototype","_getRequireWildcardCache","WeakMap","cache","onSubmit","loading","show","form","this","ApiClient","getNamedConfiguration","metadataKey","then","config","UserId","val","ReleaseDateFormat","SaveImagePathsInNfo","querySelector","checked","EnablePathSubstitution","EnableExtraThumbsDuplication","updateNamedConfiguration","Dashboard","processServerConfigurationUpdateResult","showConfirmMessage","msg","push","globalize","translate","Promise","_resolve","_reject","imported","_interopRequireWildcard","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","hasOwnProperty","call","desc","set","_ref","alert","text","join","getTabs","href","name","document","on","off","libraryMenu","setTabs","page","promise1","getUsers","promise2","all","responses","loadPage","users","html","map","user","Id","Name","hide"],"mappings":"AAAAA,OAAO,CAAC,UAAW,SAAU,UAAW,cAAe,cAAc,SAAUC,SAAUC,QAASC,SAAUC,aAAcC,YACxH,aAOA,SAASC,uBAAuBC,KAAO,OAAOA,KAAOA,IAAIC,WAAaD,IAAM,CAAEE,QAASF,KAEvF,SAASG,QAAQH,KAAmV,OAAtOG,QAArD,mBAAXC,QAAoD,iBAApBA,OAAOC,SAAmC,SAASF,QAAQH,KAAO,cAAcA,KAA2B,SAASG,QAAQH,KAAO,OAAOA,KAAyB,mBAAXI,QAAyBJ,IAAIM,cAAgBF,QAAUJ,MAAQI,OAAOG,UAAY,gBAAkBP,MAAyBA,KAEnX,SAASQ,2BAA6B,GAAuB,mBAAZC,QAAwB,OAAO,KAAM,IAAIC,MAAQ,IAAID,QAA6F,OAAlFD,yBAA2B,SAASA,2BAA6B,OAAOE,OAAiBA,MAQxM,SAASC,WACLC,SAAAA,QAAQC,OACR,IAAMC,KAAOC,KAYb,OAXAC,UAAUC,sBAAsBC,aAAaC,MAAK,SAAUC,QACxDA,OAAOC,QAAS,EAAA1B,QAAAO,SAAE,cAAeY,MAAMQ,OAAS,KAChDF,OAAOG,mBAAoB,EAAA5B,QAAAO,SAAE,2BAA4BY,MAAMQ,MAC/DF,OAAOI,oBAAsBV,KAAKW,cAAc,sBAAsBC,QACtEN,OAAOO,uBAAyBb,KAAKW,cAAc,8BAA8BC,QACjFN,OAAOQ,6BAA+Bd,KAAKW,cAAc,yBAAyBC,QAClFV,UAAUa,yBAAyBX,YAAaE,QAAQD,MAAK,WACzDW,UAAUC,yCAOtB,SAASC,mBAAmBZ,QACxB,IAAMa,IAAM,GACZA,IAAIC,KAAKC,WAAAA,QAAUC,UAAU,8BAE7B,IAAAC,SAAA,SAAAC,SAAAC,SAAA,OAAA7C,SAAA,CAAO,UAAP,SAAA8C,UAAA,OAAAF,SA3BN,SAASG,wBAAwBzC,KAAO,GAAIA,KAAOA,IAAIC,WAAc,OAAOD,IAAO,GAAY,OAARA,KAAiC,WAAjBG,QAAQH,MAAoC,mBAARA,IAAsB,MAAO,CAAEE,QAASF,KAAS,IAAIU,MAAQF,2BAA4B,GAAIE,OAASA,MAAMgC,IAAI1C,KAAQ,OAAOU,MAAMiC,IAAI3C,KAAQ,IAAI4C,OAAS,GAAQC,sBAAwBC,OAAOC,gBAAkBD,OAAOE,yBAA0B,IAAK,IAAIC,OAAOjD,IAAO,GAAI8C,OAAOvC,UAAU2C,eAAeC,KAAKnD,IAAKiD,KAAM,CAAE,IAAIG,KAAOP,sBAAwBC,OAAOE,yBAAyBhD,IAAKiD,KAAO,KAAUG,OAASA,KAAKT,KAAOS,KAAKC,KAAQP,OAAOC,eAAeH,OAAQK,IAAKG,MAAgBR,OAAOK,KAAOjD,IAAIiD,KAAyE,OAA7DL,OAAO1C,QAAUF,IAASU,OAASA,MAAM2C,IAAIrD,IAAK4C,QAAkBA,OA2B1tBH,CAAAD,aAAAD,YAAgBpB,MAAK,SAAAmC,OACjBC,EADuCD,KAApBpD,SACb,CACFsD,KAAMvB,IAAIwB,KAAK,mBAZfzB,UAGD,EAcX,SAAS0B,UACL,MAAO,CAAC,CACJC,KAAM,eACNC,KAAMzB,WAAAA,QAAUC,UAAU,oBAC3B,CACCuB,KAAM,sBACNC,KAAMzB,WAAAA,QAAUC,UAAU,YAC3B,CACCuB,KAAM,sBACNC,KAAMzB,WAAAA,QAAUC,UAAU,aAC3B,CACCuB,KAAM,mBACNC,KAAMzB,WAAAA,QAAUC,UAAU,oBA5DtCzC,QAAAI,uBAAAJ,SACAC,SAAAG,uBAAAH,UACAC,aAAAE,uBAAAF,cACAC,WAAAC,uBAAAD,YA6DI,IAAMoB,YAAc,gBACpB,EAAAvB,QAAAO,SAAE2D,UAAUC,GAAG,WAAY,oBAAoB,YAC3C,EAAAnE,QAAAO,SAAE,oBAAoB6D,IAAI,SAAUpD,UAAUmD,GAAG,SAAUnD,aAC5DmD,GAAG,WAAY,oBAAoB,WAClCE,aAAAA,QAAYC,QAAQ,WAAY,EAAGP,SACnC9C,SAAAA,QAAQC,OACR,IAAMqD,KAAOnD,KACPoD,SAAWnD,UAAUoD,WACrBC,SAAWrD,UAAUC,sBAAsBC,aACjDmB,QAAQiC,IAAI,CAACH,SAAUE,WAAWlD,MAAK,SAAUoD,YAlErD,SAASC,SAASN,KAAM9C,OAAQqD,OAC5B,IAAIC,KAAO,wCAA0CvC,WAAAA,QAAUC,UAAU,cAAgB,YACzFsC,MAAQD,MAAME,KAAI,SAAUC,MACxB,MAAO,kBAAoBA,KAAKC,GAAK,KAAOD,KAAKE,KAAO,eACzDrB,KAAK,KACR,EAAA9D,QAAAO,SAAE,cAAegE,MAAMQ,KAAKA,MAAMpD,IAAIF,OAAOC,QAAU,KACvD,EAAA1B,QAAAO,SAAE,2BAA4BgE,MAAM5C,IAAIF,OAAOG,mBAC/C2C,KAAKzC,cAAc,sBAAsBC,QAAUN,OAAOI,oBAC1D0C,KAAKzC,cAAc,8BAA8BC,QAAUN,OAAOO,uBAClEuC,KAAKzC,cAAc,yBAAyBC,QAAUN,OAAOQ,6BAC7DhB,SAAAA,QAAQmE,OAyDJP,CAASN,KAAMK,UAAU,GAAIA,UAAU","file":"metadatanfo.js","sourcesContent":["import $ from 'jQuery';\nimport loading from 'loading';\nimport libraryMenu from 'libraryMenu';\nimport globalize from 'globalize';\n\n/* eslint-disable indent */\n\n    function loadPage(page, config, users) {\n        let html = '<option value=\"\" selected=\"selected\">' + globalize.translate('OptionNone') + '</option>';\n        html += users.map(function (user) {\n            return '<option value=\"' + user.Id + '\">' + user.Name + '</option>';\n        }).join('');\n        $('#selectUser', page).html(html).val(config.UserId || '');\n        $('#selectReleaseDateFormat', page).val(config.ReleaseDateFormat);\n        page.querySelector('#chkSaveImagePaths').checked = config.SaveImagePathsInNfo;\n        page.querySelector('#chkEnablePathSubstitution').checked = config.EnablePathSubstitution;\n        page.querySelector('#chkEnableExtraThumbs').checked = config.EnableExtraThumbsDuplication;\n        loading.hide();\n    }\n\n    function onSubmit() {\n        loading.show();\n        const form = this;\n        ApiClient.getNamedConfiguration(metadataKey).then(function (config) {\n            config.UserId = $('#selectUser', form).val() || null;\n            config.ReleaseDateFormat = $('#selectReleaseDateFormat', form).val();\n            config.SaveImagePathsInNfo = form.querySelector('#chkSaveImagePaths').checked;\n            config.EnablePathSubstitution = form.querySelector('#chkEnablePathSubstitution').checked;\n            config.EnableExtraThumbsDuplication = form.querySelector('#chkEnableExtraThumbs').checked;\n            ApiClient.updateNamedConfiguration(metadataKey, config).then(function () {\n                Dashboard.processServerConfigurationUpdateResult();\n                showConfirmMessage(config);\n            });\n        });\n        return false;\n    }\n\n    function showConfirmMessage(config) {\n        const msg = [];\n        msg.push(globalize.translate('MetadataSettingChangeHelp'));\n\n        import('alert').then(({default: alert}) => {\n            alert({\n                text: msg.join('<br/><br/>')\n            });\n        });\n    }\n\n    function getTabs() {\n        return [{\n            href: 'library.html',\n            name: globalize.translate('HeaderLibraries')\n        }, {\n            href: 'librarydisplay.html',\n            name: globalize.translate('Display')\n        }, {\n            href: 'metadataimages.html',\n            name: globalize.translate('Metadata')\n        }, {\n            href: 'metadatanfo.html',\n            name: globalize.translate('TabNfoSettings')\n        }];\n    }\n\n    const metadataKey = 'xbmcmetadata';\n    $(document).on('pageinit', '#metadataNfoPage', function () {\n        $('.metadataNfoForm').off('submit', onSubmit).on('submit', onSubmit);\n    }).on('pageshow', '#metadataNfoPage', function () {\n        libraryMenu.setTabs('metadata', 3, getTabs);\n        loading.show();\n        const page = this;\n        const promise1 = ApiClient.getUsers();\n        const promise2 = ApiClient.getNamedConfiguration(metadataKey);\n        Promise.all([promise1, promise2]).then(function (responses) {\n            loadPage(page, responses[1], responses[0]);\n        });\n    });\n\n/* eslint-enable indent */\n"]}