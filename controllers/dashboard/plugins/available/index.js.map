{"version":3,"sources":["controllers/dashboard/plugins/available/index.js"],"names":["define","_exports","_loading","_libraryMenu","_globalize","_cardStyle","_embyButton","_embyCheckbox","_embySelect","_interopRequireDefault","obj","__esModule","default","getPluginHtml","plugin","options","installedPlugins","html","href","externalUrl","encodeURIComponent","name","guid","context","installedPlugin","filter","ip","Id","globalize","translate","Version","getTabs","Object","defineProperty","value","_default","view","addEventListener","libraryMenu","setTabs","reloadList","page","loading","show","promise1","ApiClient","getAvailablePlugins","promise2","getInstalledPlugins","Promise","all","then","responses","populateList","availablePlugins","forEach","index","array","category","categoryDisplayName","getHeaderText","replace","sort","a","b","currentCategory","i","length","noItemsElement","classList","remove","catalogElement","innerHTML","hide","querySelector","this"],"mappings":"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","file":"index.js","sourcesContent":["import loading from 'loading';\nimport libraryMenu from 'libraryMenu';\nimport globalize from 'globalize';\nimport 'cardStyle';\nimport 'emby-button';\nimport 'emby-checkbox';\nimport 'emby-select';\n\nfunction reloadList(page) {\n    loading.show();\n    const promise1 = ApiClient.getAvailablePlugins();\n    const promise2 = ApiClient.getInstalledPlugins();\n    Promise.all([promise1, promise2]).then(function (responses) {\n        populateList({\n            catalogElement: page.querySelector('#pluginTiles'),\n            noItemsElement: page.querySelector('#noPlugins'),\n            availablePlugins: responses[0],\n            installedPlugins: responses[1]\n        });\n    });\n}\n\nfunction getHeaderText(category) {\n    category = category.replace(' ', '');\n    // TODO: Replace with switch\n    if (category === 'Channel') {\n        category = 'Channels';\n    } else if (category === 'Theme') {\n        category = 'Themes';\n    } else if (category === 'LiveTV') {\n        category = 'LiveTV';\n    } else if (category === 'ScreenSaver') {\n        category = 'HeaderScreenSavers';\n    }\n\n    return globalize.translate(category);\n}\n\nfunction populateList(options) {\n    const availablePlugins = options.availablePlugins;\n    const installedPlugins = options.installedPlugins;\n\n    availablePlugins.forEach(function (plugin, index, array) {\n        plugin.category = plugin.category || 'General';\n        plugin.categoryDisplayName = getHeaderText(plugin.category);\n        array[index] = plugin;\n    });\n\n    availablePlugins.sort(function (a, b) {\n        if (a.category > b.category) {\n            return 1;\n        } else if (b.category > a.category) {\n            return -1;\n        }\n        if (a.name > b.name) {\n            return 1;\n        } else if (b.name > a.name) {\n            return -1;\n        }\n        return 0;\n    });\n\n    let currentCategory = null;\n    let html = '';\n\n    for (let i = 0; i < availablePlugins.length; i++) {\n        const plugin = availablePlugins[i];\n        const category = plugin.categoryDisplayName;\n        if (category != currentCategory) {\n            if (currentCategory) {\n                html += '</div>';\n                html += '</div>';\n            }\n            html += '<div class=\"verticalSection\">';\n            html += '<h2 class=\"sectionTitle sectionTitle-cards\">' + category + '</h2>';\n            html += '<div class=\"itemsContainer vertical-wrap\">';\n            currentCategory = category;\n        }\n        html += getPluginHtml(plugin, options, installedPlugins);\n    }\n    html += '</div>';\n    html += '</div>';\n\n    if (!availablePlugins.length && options.noItemsElement) {\n        options.noItemsElement.classList.remove('hide');\n    }\n\n    options.catalogElement.innerHTML = html;\n    loading.hide();\n}\n\nfunction getPluginHtml(plugin, options, installedPlugins) {\n    let html = '';\n    let href = plugin.externalUrl ? plugin.externalUrl : 'addplugin.html?name=' + encodeURIComponent(plugin.name) + '&guid=' + plugin.guid;\n\n    if (options.context) {\n        href += '&context=' + options.context;\n    }\n\n    const target = plugin.externalUrl ? ' target=\"_blank\"' : '';\n    html += \"<div class='card backdropCard'>\";\n    html += '<div class=\"cardBox visualCardBox\">';\n    html += '<div class=\"cardScalable visualCardBox-cardScalable\">';\n    html += '<div class=\"cardPadder cardPadder-backdrop\"></div>';\n    html += '<a class=\"cardContent cardImageContainer\" is=\"emby-linkbutton\" href=\"' + href + '\"' + target + '>';\n    html += '<span class=\"cardImageIcon material-icons folder\"></span>';\n    html += '</a>';\n    html += '</div>';\n    html += '<div class=\"cardFooter\">';\n    html += \"<div class='cardText'>\";\n    html += plugin.name;\n    html += '</div>';\n    const installedPlugin = installedPlugins.filter(function (ip) {\n        return ip.Id == plugin.guid;\n    })[0];\n    html += \"<div class='cardText cardText-secondary'>\";\n    html += installedPlugin ? globalize.translate('LabelVersionInstalled', installedPlugin.Version) : '&nbsp;';\n    html += '</div>';\n    html += '</div>';\n    html += '</div>';\n    return html += '</div>';\n}\n\nfunction getTabs() {\n    return [{\n        href: 'installedplugins.html',\n        name: globalize.translate('TabMyPlugins')\n    }, {\n        href: 'availableplugins.html',\n        name: globalize.translate('TabCatalog')\n    }, {\n        href: 'repositories.html',\n        name: globalize.translate('TabRepositories')\n    }];\n}\n\nexport default function (view) {\n    view.addEventListener('viewshow', function () {\n        libraryMenu.setTabs('plugins', 1, getTabs);\n        reloadList(this);\n    });\n}\n"]}