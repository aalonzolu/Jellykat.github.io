{"version":3,"sources":["controllers/dashboard/metadataImages.js"],"names":["define","_jQuery","_loading","_libraryMenu","_globalize","_listViewStyle","_interopRequireDefault","obj","__esModule","default","populateCountries","select","ApiClient","getCountries","then","allCountries","html","i","length","culture","TwoLetterISORegionName","DisplayName","innerHTML","onSubmit","form","this","loading","show","getServerConfiguration","config","PreferredMetadataLanguage","querySelector","value","MetadataCountryCode","updateServerConfiguration","Dashboard","processServerConfigurationUpdateResult","getTabs","href","name","globalize","translate","document","on","off","libraryMenu","setTabs","loadPage","page","promises","getCultures","languages","TwoLetterISOLanguageName","Promise","all","responses","hide"],"mappings":"AAAAA,OAAO,CAAC,SAAU,UAAW,cAAe,YAAa,kBAAkB,SAAUC,QAASC,SAAUC,aAAcC,WAAYC,gBAChI,aAOA,SAASC,uBAAuBC,KAAO,OAAOA,KAAOA,IAAIC,WAAaD,IAAM,CAAEE,QAASF,KAYrF,SAASG,kBAAkBC,QACvB,OAAOC,UAAUC,eAAeC,MAAK,SAASC,cAC1C,IAAIC,KAAO,GACXA,MAAQ,6BACR,IAAK,IAAIC,EAAI,EAAGC,OAASH,aAAaG,OAAQD,EAAIC,OAAQD,IAAK,CAC3D,IAAME,QAAUJ,aAAaE,GAC7BD,MAAQ,kBAAoBG,QAAQC,uBAAyB,KAAOD,QAAQE,YAAc,YAE9FV,OAAOW,UAAYN,QAc3B,SAASO,WACL,IAAMC,KAAOC,KACb,OAAOC,SAAAA,QAAQC,OAAQf,UAAUgB,yBAAyBd,MAAK,SAASe,QACpEA,OAAOC,0BAA4BN,KAAKO,cAAc,mBAAmBC,MACzEH,OAAOI,oBAAsBT,KAAKO,cAAc,kBAAkBC,MAClEpB,UAAUsB,0BAA0BL,QAAQf,KAAKqB,UAAUC,4CAC3D,EAGR,SAASC,UACL,MAAO,CAAC,CACJC,KAAM,eACNC,KAAMC,WAAAA,QAAUC,UAAU,oBAC3B,CACCH,KAAM,sBACNC,KAAMC,WAAAA,QAAUC,UAAU,YAC3B,CACCH,KAAM,sBACNC,KAAMC,WAAAA,QAAUC,UAAU,aAC3B,CACCH,KAAM,mBACNC,KAAMC,WAAAA,QAAUC,UAAU,oBA/DtCxC,QAAAK,uBAAAL,SACAC,SAAAI,uBAAAJ,UACAC,aAAAG,uBAAAH,cACAC,WAAAE,uBAAAF,aAgEI,EAAAH,QAAAQ,SAAEiC,UAAUC,GAAG,WAAY,oCAAoC,YAC3D,EAAA1C,QAAAQ,SAAE,oCAAoCmC,IAAI,SAAUrB,UAAUoB,GAAG,SAAUpB,aAC5EoB,GAAG,WAAY,oCAAoC,WAClDE,aAAAA,QAAYC,QAAQ,WAAY,EAAGT,SACnCX,SAAAA,QAAQC,OAvCZ,SAASoB,SAASC,MACd,IAzBuBrC,OAyBjBsC,SAAW,CAACrC,UAAUgB,0BAzBLjB,OAyBiDqC,KAAKjB,cAAc,mBAxBpFnB,UAAUsC,cAAcpC,MAAK,SAASqC,WACzC,IAAInC,KAAO,GACXA,MAAQ,6BACR,IAAK,IAAIC,EAAI,EAAGC,OAASiC,UAAUjC,OAAQD,EAAIC,OAAQD,IAAK,CACxD,IAAME,QAAUgC,UAAUlC,GAC1BD,MAAQ,kBAAoBG,QAAQiC,yBAA2B,KAAOjC,QAAQE,YAAc,YAEhGV,OAAOW,UAAYN,SAiByFN,kBAAkBsC,KAAKjB,cAAc,oBACrJsB,QAAQC,IAAIL,UAAUnC,MAAK,SAASyC,WAChC,IAAM1B,OAAS0B,UAAU,GACzBP,KAAKjB,cAAc,mBAAmBC,MAAQH,OAAOC,2BAA6B,GAClFkB,KAAKjB,cAAc,kBAAkBC,MAAQH,OAAOI,qBAAuB,GAC3EP,SAAAA,QAAQ8B,UAkCZT,CAAStB","file":"metadataImages.js","sourcesContent":["import $ from 'jQuery';\nimport loading from 'loading';\nimport libraryMenu from 'libraryMenu';\nimport globalize from 'globalize';\nimport 'listViewStyle';\n\n/* eslint-disable indent */\n\n    function populateLanguages(select) {\n        return ApiClient.getCultures().then(function(languages) {\n            let html = '';\n            html += \"<option value=''></option>\";\n            for (let i = 0, length = languages.length; i < length; i++) {\n                const culture = languages[i];\n                html += \"<option value='\" + culture.TwoLetterISOLanguageName + \"'>\" + culture.DisplayName + '</option>';\n            }\n            select.innerHTML = html;\n        });\n    }\n\n    function populateCountries(select) {\n        return ApiClient.getCountries().then(function(allCountries) {\n            let html = '';\n            html += \"<option value=''></option>\";\n            for (let i = 0, length = allCountries.length; i < length; i++) {\n                const culture = allCountries[i];\n                html += \"<option value='\" + culture.TwoLetterISORegionName + \"'>\" + culture.DisplayName + '</option>';\n            }\n            select.innerHTML = html;\n        });\n    }\n\n    function loadPage(page) {\n        const promises = [ApiClient.getServerConfiguration(), populateLanguages(page.querySelector('#selectLanguage')), populateCountries(page.querySelector('#selectCountry'))];\n        Promise.all(promises).then(function(responses) {\n            const config = responses[0];\n            page.querySelector('#selectLanguage').value = config.PreferredMetadataLanguage || '';\n            page.querySelector('#selectCountry').value = config.MetadataCountryCode || '';\n            loading.hide();\n        });\n    }\n\n    function onSubmit() {\n        const form = this;\n        return loading.show(), ApiClient.getServerConfiguration().then(function(config) {\n            config.PreferredMetadataLanguage = form.querySelector('#selectLanguage').value;\n            config.MetadataCountryCode = form.querySelector('#selectCountry').value;\n            ApiClient.updateServerConfiguration(config).then(Dashboard.processServerConfigurationUpdateResult);\n        }), !1;\n    }\n\n    function getTabs() {\n        return [{\n            href: 'library.html',\n            name: globalize.translate('HeaderLibraries')\n        }, {\n            href: 'librarydisplay.html',\n            name: globalize.translate('Display')\n        }, {\n            href: 'metadataimages.html',\n            name: globalize.translate('Metadata')\n        }, {\n            href: 'metadatanfo.html',\n            name: globalize.translate('TabNfoSettings')\n        }];\n    }\n\n    $(document).on('pageinit', '#metadataImagesConfigurationPage', function() {\n        $('.metadataImagesConfigurationForm').off('submit', onSubmit).on('submit', onSubmit);\n    }).on('pageshow', '#metadataImagesConfigurationPage', function() {\n        libraryMenu.setTabs('metadata', 2, getTabs);\n        loading.show();\n        loadPage(this);\n    });\n\n/* eslint-enable indent */\n"]}