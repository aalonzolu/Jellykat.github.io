{"version":3,"sources":["controllers/dashboard/users/userparentalcontrol.js"],"names":["define","_require","_jQuery","_datetime","_loading","_libraryMenu","_globalize","_listViewStyle","_paperIconButtonLight","_interopRequireDefault","obj","__esModule","default","_typeof","Symbol","iterator","constructor","prototype","_getRequireWildcardCache","WeakMap","cache","_interopRequireWildcard","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","hasOwnProperty","call","desc","set","loadUser","page","user","allParentalRatings","querySelector","innerHTML","Name","libraryMenu","setTitle","loadUnratedItems","items","name","globalize","translate","value","html","i","length","item","checkedAttribute","Policy","BlockUnratedItems","indexOf","trigger","loadBlockedTags","BlockedTags","populateRatings","rating","ratings","lastRating","Value","push","ratingValue","MaxParentalRating","val","IsAdministrator","hide","show","renderAccessSchedule","AccessSchedules","loading","tags","map","h","li","join","elem","on","tag","this","getAttribute","newTags","filter","t","schedules","index","a","itemHtml","DayOfWeek","StartHour","EndHour","getDisplayTime","accessScheduleList","deleteAccessSchedule","splice","parseInt","saveUser","checked","getSchedulesFromPage","getBlockedTagsFromPage","ApiClient","updateUserPolicy","Id","then","onSaveComplete","Promise","_resolve","_reject","imported","_ref","toast","hours","minutes","pct","datetime","Date","window","UserParentalControlPage","onSubmit","parents","userId","getParameterByName","getUser","result","document","showSchedulePopup","schedule","_ref2","updatedSchedule","showBlockedTagPopup","_ref3","prompt","label","off","promise1","promise2","getParentalRatings","all","responses"],"mappings":"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","file":"userparentalcontrol.js","sourcesContent":["import $ from 'jQuery';\nimport datetime from 'datetime';\nimport loading from 'loading';\nimport libraryMenu from 'libraryMenu';\nimport globalize from 'globalize';\nimport 'listViewStyle';\nimport 'paper-icon-button-light';\n\n/* eslint-disable indent */\n\n    function populateRatings(allParentalRatings, page) {\n        let html = '';\n        html += \"<option value=''></option>\";\n        let rating;\n        const ratings = [];\n\n        for (let i = 0, length = allParentalRatings.length; i < length; i++) {\n            if (rating = allParentalRatings[i], ratings.length) {\n                const lastRating = ratings[ratings.length - 1];\n\n                if (lastRating.Value === rating.Value) {\n                    lastRating.Name += '/' + rating.Name;\n                    continue;\n                }\n            }\n\n            ratings.push({\n                Name: rating.Name,\n                Value: rating.Value\n            });\n        }\n\n        for (let i = 0, length = ratings.length; i < length; i++) {\n            rating = ratings[i];\n            html += \"<option value='\" + rating.Value + \"'>\" + rating.Name + '</option>';\n        }\n\n        $('#selectMaxParentalRating', page).html(html);\n    }\n\n    function loadUnratedItems(page, user) {\n        const items = [{\n            name: globalize.translate('OptionBlockBooks'),\n            value: 'Book'\n        }, {\n            name: globalize.translate('OptionBlockChannelContent'),\n            value: 'ChannelContent'\n        }, {\n            name: globalize.translate('OptionBlockLiveTvChannels'),\n            value: 'LiveTvChannel'\n        }, {\n            name: globalize.translate('OptionBlockMovies'),\n            value: 'Movie'\n        }, {\n            name: globalize.translate('OptionBlockMusic'),\n            value: 'Music'\n        }, {\n            name: globalize.translate('OptionBlockTrailers'),\n            value: 'Trailer'\n        }, {\n            name: globalize.translate('OptionBlockTvShows'),\n            value: 'Series'\n        }];\n        let html = '';\n        html += '<h3 class=\"checkboxListLabel\">' + globalize.translate('HeaderBlockItemsWithNoRating') + '</h3>';\n        html += '<div class=\"checkboxList paperList checkboxList-paperList\">';\n\n        for (let i = 0, length = items.length; i < length; i++) {\n            const item = items[i];\n            const checkedAttribute = user.Policy.BlockUnratedItems.indexOf(item.value) != -1 ? ' checked=\"checked\"' : '';\n            html += '<label><input type=\"checkbox\" is=\"emby-checkbox\" class=\"chkUnratedItem\" data-itemtype=\"' + item.value + '\" type=\"checkbox\"' + checkedAttribute + '><span>' + item.name + '</span></label>';\n        }\n\n        html += '</div>';\n        $('.blockUnratedItems', page).html(html).trigger('create');\n    }\n\n    function loadUser(page, user, allParentalRatings) {\n        page.querySelector('.username').innerHTML = user.Name;\n        libraryMenu.setTitle(user.Name);\n        loadUnratedItems(page, user);\n        loadBlockedTags(page, user.Policy.BlockedTags);\n        populateRatings(allParentalRatings, page);\n        let ratingValue = '';\n\n        if (user.Policy.MaxParentalRating) {\n            for (let i = 0, length = allParentalRatings.length; i < length; i++) {\n                const rating = allParentalRatings[i];\n\n                if (user.Policy.MaxParentalRating >= rating.Value) {\n                    ratingValue = rating.Value;\n                }\n            }\n        }\n\n        $('#selectMaxParentalRating', page).val(ratingValue);\n\n        if (user.Policy.IsAdministrator) {\n            $('.accessScheduleSection', page).hide();\n        } else {\n            $('.accessScheduleSection', page).show();\n        }\n\n        renderAccessSchedule(page, user.Policy.AccessSchedules || []);\n        loading.hide();\n    }\n\n    function loadBlockedTags(page, tags) {\n        let html = tags.map(function (h) {\n            let li = '<div class=\"listItem\">';\n            li += '<div class=\"listItemBody\">';\n            li += '<h3 class=\"listItemBodyText\">';\n            li += h;\n            li += '</h3>';\n            li += '</div>';\n            li += '<button type=\"button\" is=\"paper-icon-button-light\" class=\"blockedTag btnDeleteTag listItemButton\" data-tag=\"' + h + '\"><span class=\"material-icons delete\"></span></button>';\n            return li += '</div>';\n        }).join('');\n\n        if (html) {\n            html = '<div class=\"paperList\">' + html + '</div>';\n        }\n\n        const elem = $('.blockedTags', page).html(html).trigger('create');\n        $('.btnDeleteTag', elem).on('click', function () {\n            const tag = this.getAttribute('data-tag');\n            const newTags = tags.filter(function (t) {\n                return t != tag;\n            });\n            loadBlockedTags(page, newTags);\n        });\n    }\n\n    function deleteAccessSchedule(page, schedules, index) {\n        schedules.splice(index, 1);\n        renderAccessSchedule(page, schedules);\n    }\n\n    function renderAccessSchedule(page, schedules) {\n        let html = '';\n        let index = 0;\n        html += schedules.map(function (a) {\n            let itemHtml = '';\n            itemHtml += '<div class=\"liSchedule listItem\" data-day=\"' + a.DayOfWeek + '\" data-start=\"' + a.StartHour + '\" data-end=\"' + a.EndHour + '\">';\n            itemHtml += '<div class=\"listItemBody two-line\">';\n            itemHtml += '<h3 class=\"listItemBodyText\">';\n            itemHtml += globalize.translate('Option' + a.DayOfWeek);\n            itemHtml += '</h3>';\n            itemHtml += '<div class=\"listItemBodyText secondary\">' + getDisplayTime(a.StartHour) + ' - ' + getDisplayTime(a.EndHour) + '</div>';\n            itemHtml += '</div>';\n            itemHtml += '<button type=\"button\" is=\"paper-icon-button-light\" class=\"btnDelete listItemButton\" data-index=\"' + index + '\"><span class=\"material-icons delete\"></span></button>';\n            itemHtml += '</div>';\n            index++;\n            return itemHtml;\n        }).join('');\n        const accessScheduleList = page.querySelector('.accessScheduleList');\n        accessScheduleList.innerHTML = html;\n        $('.btnDelete', accessScheduleList).on('click', function () {\n            deleteAccessSchedule(page, schedules, parseInt(this.getAttribute('data-index')));\n        });\n    }\n\n    function onSaveComplete(page) {\n        loading.hide();\n\n        import('toast').then(({default: toast}) => {\n            toast(globalize.translate('SettingsSaved'));\n        });\n    }\n\n    function saveUser(user, page) {\n        user.Policy.MaxParentalRating = $('#selectMaxParentalRating', page).val() || null;\n        user.Policy.BlockUnratedItems = $('.chkUnratedItem', page).get().filter(function (i) {\n            return i.checked;\n        }).map(function (i) {\n            return i.getAttribute('data-itemtype');\n        });\n        user.Policy.AccessSchedules = getSchedulesFromPage(page);\n        user.Policy.BlockedTags = getBlockedTagsFromPage(page);\n        ApiClient.updateUserPolicy(user.Id, user.Policy).then(function () {\n            onSaveComplete(page);\n        });\n    }\n\n    function getDisplayTime(hours) {\n        let minutes = 0;\n        const pct = hours % 1;\n\n        if (pct) {\n            minutes = parseInt(60 * pct);\n        }\n\n        return datetime.getDisplayTime(new Date(2000, 1, 1, hours, minutes, 0, 0));\n    }\n\n    function showSchedulePopup(page, schedule, index) {\n        schedule = schedule || {};\n        import('components/accessSchedule/accessSchedule').then(({default: accessschedule}) => {\n            accessschedule.show({\n                schedule: schedule\n            }).then(function (updatedSchedule) {\n                const schedules = getSchedulesFromPage(page);\n\n                if (index == -1) {\n                    index = schedules.length;\n                }\n\n                schedules[index] = updatedSchedule;\n                renderAccessSchedule(page, schedules);\n            });\n        });\n    }\n\n    function getSchedulesFromPage(page) {\n        return $('.liSchedule', page).map(function () {\n            return {\n                DayOfWeek: this.getAttribute('data-day'),\n                StartHour: this.getAttribute('data-start'),\n                EndHour: this.getAttribute('data-end')\n            };\n        }).get();\n    }\n\n    function getBlockedTagsFromPage(page) {\n        return $('.blockedTag', page).map(function () {\n            return this.getAttribute('data-tag');\n        }).get();\n    }\n\n    function showBlockedTagPopup(page) {\n        import('prompt').then(({default: prompt}) => {\n            prompt({\n                label: globalize.translate('LabelTag')\n            }).then(function (value) {\n                const tags = getBlockedTagsFromPage(page);\n\n                if (tags.indexOf(value) == -1) {\n                    tags.push(value);\n                    loadBlockedTags(page, tags);\n                }\n            });\n        });\n    }\n\n    window.UserParentalControlPage = {\n        onSubmit: function () {\n            const page = $(this).parents('.page');\n            loading.show();\n            const userId = getParameterByName('userId');\n            ApiClient.getUser(userId).then(function (result) {\n                saveUser(result, page);\n            });\n            return false;\n        }\n    };\n    $(document).on('pageinit', '#userParentalControlPage', function () {\n        const page = this;\n        $('.btnAddSchedule', page).on('click', function () {\n            showSchedulePopup(page, {}, -1);\n        });\n        $('.btnAddBlockedTag', page).on('click', function () {\n            showBlockedTagPopup(page);\n        });\n        $('.userParentalControlForm').off('submit', UserParentalControlPage.onSubmit).on('submit', UserParentalControlPage.onSubmit);\n    }).on('pageshow', '#userParentalControlPage', function () {\n        const page = this;\n        loading.show();\n        const userId = getParameterByName('userId');\n        const promise1 = ApiClient.getUser(userId);\n        const promise2 = ApiClient.getParentalRatings();\n        Promise.all([promise1, promise2]).then(function (responses) {\n            loadUser(page, responses[0], responses[1]);\n        });\n    });\n\n/* eslint-enable indent */\n"]}