define(["require","datetime","loading","dom","globalize","emby-button"],(function(_require,_datetime,_loading,_dom,_globalize,_embyButton){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _getRequireWildcardCache(){if("function"!=typeof WeakMap)return null;var cache=new WeakMap;return _getRequireWildcardCache=function _getRequireWildcardCache(){return cache},cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;if(null===obj||"object"!==_typeof(obj)&&"function"!=typeof obj)return{default:obj};var cache=_getRequireWildcardCache();if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}return newObj.default=obj,cache&&cache.set(obj,newObj),newObj}function loadData(page){_loading.default.show(),ApiClient.getJSON(ApiClient.getUrl("Auth/Keys")).then((function(result){!function renderKeys(page,keys){var rows=keys.map((function(item){var html="";html+='<tr class="detailTableBodyRow detailTableBodyRow-shaded">',html+='<td class="detailTableBodyCell">',html+='<button type="button" is="emby-button" data-token="'+item.AccessToken+'" class="raised raised-mini btnRevoke" data-mini="true" title="'+_globalize.default.translate("ButtonRevoke")+'" style="margin:0;">'+_globalize.default.translate("ButtonRevoke")+"</button>",html+="</td>",html+='<td class="detailTableBodyCell" style="vertical-align:middle;">',html+=item.AccessToken,html+="</td>",html+='<td class="detailTableBodyCell" style="vertical-align:middle;">',html+=item.AppName||"",html+="</td>",html+='<td class="detailTableBodyCell" style="vertical-align:middle;">';var date=_datetime.default.parseISO8601Date(item.DateCreated,!0);return html+=_datetime.default.toLocaleDateString(date)+" "+_datetime.default.getDisplayTime(date),(html+="</td>")+"</tr>"})).join("");page.querySelector(".resultBody").innerHTML=rows,_loading.default.hide()}(page,result.Items)}))}_datetime=_interopRequireDefault(_datetime),_loading=_interopRequireDefault(_loading),_dom=_interopRequireDefault(_dom),_globalize=_interopRequireDefault(_globalize),pageIdOn("pageinit","apiKeysPage",(function(){var page=this;page.querySelector(".btnNewKey").addEventListener("click",(function(){!function showNewKeyPrompt(page){new Promise((function(_resolve,_reject){return _require(["prompt"],(function(imported){return _resolve(_interopRequireWildcard(imported))}),_reject)})).then((function(_ref2){(0,_ref2.default)({title:_globalize.default.translate("HeaderNewApiKey"),label:_globalize.default.translate("LabelAppName"),description:_globalize.default.translate("LabelAppNameExample")}).then((function(value){ApiClient.ajax({type:"POST",url:ApiClient.getUrl("Auth/Keys",{App:value})}).then((function(){loadData(page)}))}))}))}(page)})),page.querySelector(".tblApiKeys").addEventListener("click",(function(e){var btnRevoke=_dom.default.parentWithClass(e.target,"btnRevoke");btnRevoke&&function revoke(page,key){new Promise((function(_resolve,_reject){return _require(["confirm"],(function(imported){return _resolve(_interopRequireWildcard(imported))}),_reject)})).then((function(_ref){(0,_ref.default)(_globalize.default.translate("MessageConfirmRevokeApiKey"),_globalize.default.translate("HeaderConfirmRevokeApiKey")).then((function(){_loading.default.show(),ApiClient.ajax({type:"DELETE",url:ApiClient.getUrl("Auth/Keys/"+key)}).then((function(){loadData(page)}))}))}))}(page,btnRevoke.getAttribute("data-token"))}))})),pageIdOn("pagebeforeshow","apiKeysPage",(function(){loadData(this)}))}));
//# sourceMappingURL=apikeys.js.map
