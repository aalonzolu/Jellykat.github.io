define(["require","jQuery","loading","globalize","emby-select","emby-button","emby-input","emby-checkbox","listViewStyle"],(function(_require,_jQuery,_loading,_globalize,_embySelect,_embyButton,_embyInput,_embyCheckbox,_listViewStyle){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _getRequireWildcardCache(){if("function"!=typeof WeakMap)return null;var cache=new WeakMap;return _getRequireWildcardCache=function _getRequireWildcardCache(){return cache},cache}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function loadProfile(page){_loading.default.show();var promise1=function getProfile(){var id=getParameterByName("id"),url=id?"Dlna/Profiles/"+id:"Dlna/Profiles/Default";return ApiClient.getJSON(ApiClient.getUrl(url))}(),promise2=ApiClient.getUsers();Promise.all([promise1,promise2]).then((function(responses){currentProfile=responses[0],function renderProfile(page,profile,users){(0,_jQuery.default)("#txtName",page).val(profile.Name),(0,_jQuery.default)(".chkMediaType",page).each((function(){this.checked=-1!=(profile.SupportedMediaTypes||"").split(",").indexOf(this.getAttribute("data-value"))})),(0,_jQuery.default)("#chkEnableAlbumArtInDidl",page).prop("checked",profile.EnableAlbumArtInDidl),(0,_jQuery.default)("#chkEnableSingleImageLimit",page).prop("checked",profile.EnableSingleAlbumArtLimit),renderXmlDocumentAttributes(page,profile.XmlRootAttributes||[]);var idInfo=profile.Identification||{};renderIdentificationHeaders(page,idInfo.Headers||[]),renderSubtitleProfiles(page,profile.SubtitleProfiles||[]),(0,_jQuery.default)("#txtInfoFriendlyName",page).val(profile.FriendlyName||""),(0,_jQuery.default)("#txtInfoModelName",page).val(profile.ModelName||""),(0,_jQuery.default)("#txtInfoModelNumber",page).val(profile.ModelNumber||""),(0,_jQuery.default)("#txtInfoModelDescription",page).val(profile.ModelDescription||""),(0,_jQuery.default)("#txtInfoModelUrl",page).val(profile.ModelUrl||""),(0,_jQuery.default)("#txtInfoManufacturer",page).val(profile.Manufacturer||""),(0,_jQuery.default)("#txtInfoManufacturerUrl",page).val(profile.ManufacturerUrl||""),(0,_jQuery.default)("#txtInfoSerialNumber",page).val(profile.SerialNumber||""),(0,_jQuery.default)("#txtIdFriendlyName",page).val(idInfo.FriendlyName||""),(0,_jQuery.default)("#txtIdModelName",page).val(idInfo.ModelName||""),(0,_jQuery.default)("#txtIdModelNumber",page).val(idInfo.ModelNumber||""),(0,_jQuery.default)("#txtIdModelDescription",page).val(idInfo.ModelDescription||""),(0,_jQuery.default)("#txtIdModelUrl",page).val(idInfo.ModelUrl||""),(0,_jQuery.default)("#txtIdManufacturer",page).val(idInfo.Manufacturer||""),(0,_jQuery.default)("#txtIdManufacturerUrl",page).val(idInfo.ManufacturerUrl||""),(0,_jQuery.default)("#txtIdSerialNumber",page).val(idInfo.SerialNumber||""),(0,_jQuery.default)("#txtIdDeviceDescription",page).val(idInfo.DeviceDescription||""),(0,_jQuery.default)("#txtAlbumArtPn",page).val(profile.AlbumArtPn||""),(0,_jQuery.default)("#txtAlbumArtMaxWidth",page).val(profile.MaxAlbumArtWidth||""),(0,_jQuery.default)("#txtAlbumArtMaxHeight",page).val(profile.MaxAlbumArtHeight||""),(0,_jQuery.default)("#txtIconMaxWidth",page).val(profile.MaxIconWidth||""),(0,_jQuery.default)("#txtIconMaxHeight",page).val(profile.MaxIconHeight||""),(0,_jQuery.default)("#chkIgnoreTranscodeByteRangeRequests",page).prop("checked",profile.IgnoreTranscodeByteRangeRequests),(0,_jQuery.default)("#txtMaxAllowedBitrate",page).val(profile.MaxStreamingBitrate||""),(0,_jQuery.default)("#txtMusicStreamingTranscodingBitrate",page).val(profile.MusicStreamingTranscodingBitrate||""),(0,_jQuery.default)("#chkRequiresPlainFolders",page).prop("checked",profile.RequiresPlainFolders),(0,_jQuery.default)("#chkRequiresPlainVideoItems",page).prop("checked",profile.RequiresPlainVideoItems),(0,_jQuery.default)("#txtProtocolInfo",page).val(profile.ProtocolInfo||""),(0,_jQuery.default)("#txtXDlnaCap",page).val(profile.XDlnaCap||""),(0,_jQuery.default)("#txtXDlnaDoc",page).val(profile.XDlnaDoc||""),(0,_jQuery.default)("#txtSonyAggregationFlags",page).val(profile.SonyAggregationFlags||""),profile.DirectPlayProfiles=profile.DirectPlayProfiles||[],profile.TranscodingProfiles=profile.TranscodingProfiles||[],profile.ContainerProfiles=profile.ContainerProfiles||[],profile.CodecProfiles=profile.CodecProfiles||[],profile.ResponseProfiles=profile.ResponseProfiles||[];var usersHtml="<option></option>"+users.map((function(u){return'<option value="'+u.Id+'">'+u.Name+"</option>"})).join("");(0,_jQuery.default)("#selectUser",page).html(usersHtml).val(profile.UserId||""),renderSubProfiles(page,profile)}(page,currentProfile,responses[1]),_loading.default.hide()}))}function renderIdentificationHeaders(page,headers){var index=0,html='<div class="paperList">'+headers.map((function(h){var li='<div class="listItem">';return li+='<span class="material-icons listItemIcon info"></span>',li+='<div class="listItemBody">',li+='<h3 class="listItemBodyText">'+h.Name+": "+(h.Value||"")+"</h3>",li+='<div class="listItemBodyText secondary">'+(h.Match||"")+"</div>",li+="</div>",li+='<button type="button" is="paper-icon-button-light" class="btnDeleteIdentificationHeader listItemButton" data-index="'+index+'"><span class="material-icons delete"></span></button>',index++,li+="</div>"})).join("")+"</div>",elem=(0,_jQuery.default)(".httpHeaderIdentificationList",page).html(html).trigger("create");(0,_jQuery.default)(".btnDeleteIdentificationHeader",elem).on("click",(function(){var itemIndex=parseInt(this.getAttribute("data-index"));currentProfile.Identification.Headers.splice(itemIndex,1),renderIdentificationHeaders(page,currentProfile.Identification.Headers)}))}function openPopup(elem){elem.classList.remove("hide")}function closePopup(elem){elem.classList.add("hide")}function renderXmlDocumentAttributes(page,attribute){var html='<div class="paperList">'+attribute.map((function(h){var li='<div class="listItem">';return li+='<span class="material-icons listItemIcon info"></span>',li+='<div class="listItemBody">',li+='<h3 class="listItemBodyText">'+h.Name+" = "+(h.Value||"")+"</h3>",li+="</div>",(li+='<button type="button" is="paper-icon-button-light" class="btnDeleteXmlAttribute listItemButton" data-index="0"><span class="material-icons delete"></span></button>')+"</div>"})).join("")+"</div>",elem=(0,_jQuery.default)(".xmlDocumentAttributeList",page).html(html).trigger("create");(0,_jQuery.default)(".btnDeleteXmlAttribute",elem).on("click",(function(){var itemIndex=parseInt(this.getAttribute("data-index"));currentProfile.XmlRootAttributes.splice(itemIndex,1),renderXmlDocumentAttributes(page,currentProfile.XmlRootAttributes)}))}function renderSubtitleProfiles(page,profiles){var index=0,html='<div class="paperList">'+profiles.map((function(h){var li='<div class="listItem lnkEditSubProfile" data-index="'+index+'">';return li+='<span class="material-icons listItemIcon info"></span>',li+='<div class="listItemBody">',li+='<h3 class="listItemBodyText">'+(h.Format||"")+"</h3>",li+="</div>",li+='<button type="button" is="paper-icon-button-light" class="btnDeleteProfile listItemButton" data-index="'+index+'"><span class="material-icons delete"></span></button>',index++,li+="</div>"})).join("")+"</div>",elem=(0,_jQuery.default)(".subtitleProfileList",page).html(html).trigger("create");(0,_jQuery.default)(".btnDeleteProfile",elem).on("click",(function(){var itemIndex=parseInt(this.getAttribute("data-index"));currentProfile.SubtitleProfiles.splice(itemIndex,1),renderSubtitleProfiles(page,currentProfile.SubtitleProfiles)})),(0,_jQuery.default)(".lnkEditSubProfile",elem).on("click",(function(){var itemIndex=parseInt(this.getAttribute("data-index"));editSubtitleProfile(page,currentProfile.SubtitleProfiles[itemIndex])}))}function editSubtitleProfile(page,profile){isSubProfileNew=null==profile,currentSubProfile=profile=profile||{};var popup=(0,_jQuery.default)("#subtitleProfilePopup",page);(0,_jQuery.default)("#txtSubtitleProfileFormat",popup).val(profile.Format||""),(0,_jQuery.default)("#selectSubtitleProfileMethod",popup).val(profile.Method||""),(0,_jQuery.default)("#selectSubtitleProfileDidlMode",popup).val(profile.DidlMode||""),openPopup(popup[0])}function renderSubProfiles(page,profile){renderDirectPlayProfiles(page,profile.DirectPlayProfiles),renderTranscodingProfiles(page,profile.TranscodingProfiles),renderContainerProfiles(page,profile.ContainerProfiles),renderCodecProfiles(page,profile.CodecProfiles),renderResponseProfiles(page,profile.ResponseProfiles)}function renderDirectPlayProfiles(page,profiles){var currentType,html="";html+='<ul data-role="listview" data-inset="true" data-split-icon="delete">';var _step,_iterator=function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e3){didErr=!0,err=_e3},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}(profiles.entries());try{for(_iterator.s();!(_step=_iterator.n()).done;){var _step$value=_slicedToArray(_step.value,2),index=_step$value[0],profile=_step$value[1];profile.Type!==currentType&&(html+='<li data-role="list-divider">'+profile.Type+"</li>",currentType=profile.Type),html+="<div>",html+='<a is="emby-linkbutton" href="#" class="lnkEditSubProfile" data-profileindex="'+index+'">',html+="<p>"+_globalize.default.translate("ValueContainer",profile.Container||allText)+"</p>","Video"==profile.Type?(html+="<p>"+_globalize.default.translate("ValueVideoCodec",profile.VideoCodec||allText)+"</p>",html+="<p>"+_globalize.default.translate("ValueAudioCodec",profile.AudioCodec||allText)+"</p>"):"Audio"==profile.Type&&(html+="<p>"+_globalize.default.translate("ValueCodec",profile.AudioCodec||allText)+"</p>"),html+="</a>",html+='<button type="button" is="paper-icon-button-light" class="btnDeleteProfile listItemButton" data-profileindex="'+index+'"><span class="material-icons delete"></span></button>',html+="</div>"}}catch(err){_iterator.e(err)}finally{_iterator.f()}html+="</ul>";var elem=(0,_jQuery.default)(".directPlayProfiles",page).html(html).trigger("create");(0,_jQuery.default)(".btnDeleteProfile",elem).on("click",(function(){var index=this.getAttribute("data-profileindex");!function deleteDirectPlayProfile(page,index){currentProfile.DirectPlayProfiles.splice(index,1),renderDirectPlayProfiles(page,currentProfile.DirectPlayProfiles)}(page,index)})),(0,_jQuery.default)(".lnkEditSubProfile",elem).on("click",(function(){var index=parseInt(this.getAttribute("data-profileindex"));editDirectPlayProfile(page,currentProfile.DirectPlayProfiles[index])}))}function editDirectPlayProfile(page,directPlayProfile){isSubProfileNew=null==directPlayProfile,currentSubProfile=directPlayProfile=directPlayProfile||{};var popup=(0,_jQuery.default)("#popupEditDirectPlayProfile",page);(0,_jQuery.default)("#selectDirectPlayProfileType",popup).val(directPlayProfile.Type||"Video").trigger("change"),(0,_jQuery.default)("#txtDirectPlayContainer",popup).val(directPlayProfile.Container||""),(0,_jQuery.default)("#txtDirectPlayAudioCodec",popup).val(directPlayProfile.AudioCodec||""),(0,_jQuery.default)("#txtDirectPlayVideoCodec",popup).val(directPlayProfile.VideoCodec||""),openPopup(popup[0])}function renderTranscodingProfiles(page,profiles){var currentType,html="";html+='<ul data-role="listview" data-inset="true" data-split-icon="delete">';for(var i=0,length=profiles.length;i<length;i++){var profile=profiles[i];profile.Type!==currentType&&(html+='<li data-role="list-divider">'+profile.Type+"</li>",currentType=profile.Type),html+="<div>",html+='<a is="emby-linkbutton" href="#" class="lnkEditSubProfile" data-profileindex="'+i+'">',html+="<p>Protocol: "+(profile.Protocol||"Http")+"</p>",html+="<p>"+_globalize.default.translate("ValueContainer",profile.Container||allText)+"</p>","Video"==profile.Type?(html+="<p>"+_globalize.default.translate("ValueVideoCodec",profile.VideoCodec||allText)+"</p>",html+="<p>"+_globalize.default.translate("ValueAudioCodec",profile.AudioCodec||allText)+"</p>"):"Audio"==profile.Type&&(html+="<p>"+_globalize.default.translate("ValueCodec",profile.AudioCodec||allText)+"</p>"),html+="</a>",html+='<button type="button" is="paper-icon-button-light" class="btnDeleteProfile listItemButton" data-profileindex="'+i+'"><span class="material-icons delete"></span></button>',html+="</div>"}html+="</ul>";var elem=(0,_jQuery.default)(".transcodingProfiles",page).html(html).trigger("create");(0,_jQuery.default)(".btnDeleteProfile",elem).on("click",(function(){var index=this.getAttribute("data-profileindex");!function deleteTranscodingProfile(page,index){currentProfile.TranscodingProfiles.splice(index,1),renderTranscodingProfiles(page,currentProfile.TranscodingProfiles)}(page,index)})),(0,_jQuery.default)(".lnkEditSubProfile",elem).on("click",(function(){var index=parseInt(this.getAttribute("data-profileindex"));editTranscodingProfile(page,currentProfile.TranscodingProfiles[index])}))}function editTranscodingProfile(page,transcodingProfile){isSubProfileNew=null==transcodingProfile,currentSubProfile=transcodingProfile=transcodingProfile||{};var popup=(0,_jQuery.default)("#transcodingProfilePopup",page);(0,_jQuery.default)("#selectTranscodingProfileType",popup).val(transcodingProfile.Type||"Video").trigger("change"),(0,_jQuery.default)("#txtTranscodingContainer",popup).val(transcodingProfile.Container||""),(0,_jQuery.default)("#txtTranscodingAudioCodec",popup).val(transcodingProfile.AudioCodec||""),(0,_jQuery.default)("#txtTranscodingVideoCodec",popup).val(transcodingProfile.VideoCodec||""),(0,_jQuery.default)("#selectTranscodingProtocol",popup).val(transcodingProfile.Protocol||"Http"),(0,_jQuery.default)("#chkEnableMpegtsM2TsMode",popup).prop("checked",transcodingProfile.EnableMpegtsM2TsMode||!1),(0,_jQuery.default)("#chkEstimateContentLength",popup).prop("checked",transcodingProfile.EstimateContentLength||!1),(0,_jQuery.default)("#chkReportByteRangeRequests",popup).prop("checked","Bytes"==transcodingProfile.TranscodeSeekInfo),(0,_jQuery.default)(".radioTabButton:first",popup).trigger("click"),openPopup(popup[0])}function renderContainerProfiles(page,profiles){var currentType,html="";html+='<ul data-role="listview" data-inset="true" data-split-icon="delete">';for(var i=0,length=profiles.length;i<length;i++){var profile=profiles[i];profile.Type!==currentType&&(html+='<li data-role="list-divider">'+profile.Type+"</li>",currentType=profile.Type),html+="<div>",html+='<a is="emby-linkbutton" href="#" class="lnkEditSubProfile" data-profileindex="'+i+'">',html+="<p>"+_globalize.default.translate("ValueContainer",profile.Container||allText)+"</p>",profile.Conditions&&profile.Conditions.length&&(html+="<p>",html+=_globalize.default.translate("ValueConditions",profile.Conditions.map((function(c){return c.Property})).join(", ")),html+="</p>"),html+="</a>",html+='<button type="button" is="paper-icon-button-light" class="btnDeleteProfile listItemButton" data-profileindex="'+i+'"><span class="material-icons delete"></span></button>',html+="</div>"}html+="</ul>";var elem=(0,_jQuery.default)(".containerProfiles",page).html(html).trigger("create");(0,_jQuery.default)(".btnDeleteProfile",elem).on("click",(function(){var index=this.getAttribute("data-profileindex");!function deleteContainerProfile(page,index){currentProfile.ContainerProfiles.splice(index,1),renderContainerProfiles(page,currentProfile.ContainerProfiles)}(page,index)})),(0,_jQuery.default)(".lnkEditSubProfile",elem).on("click",(function(){var index=parseInt(this.getAttribute("data-profileindex"));editContainerProfile(page,currentProfile.ContainerProfiles[index])}))}function editContainerProfile(page,containerProfile){isSubProfileNew=null==containerProfile,currentSubProfile=containerProfile=containerProfile||{};var popup=(0,_jQuery.default)("#containerProfilePopup",page);(0,_jQuery.default)("#selectContainerProfileType",popup).val(containerProfile.Type||"Video").trigger("change"),(0,_jQuery.default)("#txtContainerProfileContainer",popup).val(containerProfile.Container||""),(0,_jQuery.default)(".radioTabButton:first",popup).trigger("click"),openPopup(popup[0])}function renderCodecProfiles(page,profiles){var currentType,html="";html+='<ul data-role="listview" data-inset="true" data-split-icon="delete">';for(var i=0,length=profiles.length;i<length;i++){var profile=profiles[i],type=profile.Type.replace("VideoAudio","Video Audio");type!==currentType&&(html+='<li data-role="list-divider">'+type+"</li>",currentType=type),html+="<div>",html+='<a is="emby-linkbutton" href="#" class="lnkEditSubProfile" data-profileindex="'+i+'">',html+="<p>"+_globalize.default.translate("ValueCodec",profile.Codec||allText)+"</p>",profile.Conditions&&profile.Conditions.length&&(html+="<p>",html+=_globalize.default.translate("ValueConditions",profile.Conditions.map((function(c){return c.Property})).join(", ")),html+="</p>"),html+="</a>",html+='<button type="button" is="paper-icon-button-light" class="btnDeleteProfile listItemButton" data-profileindex="'+i+'"><span class="material-icons delete"></span></button>',html+="</div>"}html+="</ul>";var elem=(0,_jQuery.default)(".codecProfiles",page).html(html).trigger("create");(0,_jQuery.default)(".btnDeleteProfile",elem).on("click",(function(){var index=this.getAttribute("data-profileindex");!function deleteCodecProfile(page,index){currentProfile.CodecProfiles.splice(index,1),renderCodecProfiles(page,currentProfile.CodecProfiles)}(page,index)})),(0,_jQuery.default)(".lnkEditSubProfile",elem).on("click",(function(){var index=parseInt(this.getAttribute("data-profileindex"));editCodecProfile(page,currentProfile.CodecProfiles[index])}))}function editCodecProfile(page,codecProfile){isSubProfileNew=null==codecProfile,currentSubProfile=codecProfile=codecProfile||{};var popup=(0,_jQuery.default)("#codecProfilePopup",page);(0,_jQuery.default)("#selectCodecProfileType",popup).val(codecProfile.Type||"Video").trigger("change"),(0,_jQuery.default)("#txtCodecProfileCodec",popup).val(codecProfile.Codec||""),(0,_jQuery.default)(".radioTabButton:first",popup).trigger("click"),openPopup(popup[0])}function renderResponseProfiles(page,profiles){var currentType,html="";html+='<ul data-role="listview" data-inset="true" data-split-icon="delete">';for(var i=0,length=profiles.length;i<length;i++){var profile=profiles[i];profile.Type!==currentType&&(html+='<li data-role="list-divider">'+profile.Type+"</li>",currentType=profile.Type),html+="<div>",html+='<a is="emby-linkbutton" href="#" class="lnkEditSubProfile" data-profileindex="'+i+'">',html+="<p>"+_globalize.default.translate("ValueContainer",profile.Container||allText)+"</p>","Video"==profile.Type?(html+="<p>"+_globalize.default.translate("ValueVideoCodec",profile.VideoCodec||allText)+"</p>",html+="<p>"+_globalize.default.translate("ValueAudioCodec",profile.AudioCodec||allText)+"</p>"):"Audio"==profile.Type&&(html+="<p>"+_globalize.default.translate("ValueCodec",profile.AudioCodec||allText)+"</p>"),profile.Conditions&&profile.Conditions.length&&(html+="<p>",html+=_globalize.default.translate("ValueConditions",profile.Conditions.map((function(c){return c.Property})).join(", ")),html+="</p>"),html+="</a>",html+='<button type="button" is="paper-icon-button-light" class="btnDeleteProfile listItemButton" data-profileindex="'+i+'"><span class="material-icons delete"></span></button>',html+="</div>"}html+="</ul>";var elem=(0,_jQuery.default)(".mediaProfiles",page).html(html).trigger("create");(0,_jQuery.default)(".btnDeleteProfile",elem).on("click",(function(){var index=this.getAttribute("data-profileindex");!function deleteResponseProfile(page,index){currentProfile.ResponseProfiles.splice(index,1),renderResponseProfiles(page,currentProfile.ResponseProfiles)}(page,index)})),(0,_jQuery.default)(".lnkEditSubProfile",elem).on("click",(function(){var index=parseInt(this.getAttribute("data-profileindex"));editResponseProfile(page,currentProfile.ResponseProfiles[index])}))}function editResponseProfile(page,responseProfile){isSubProfileNew=null==responseProfile,currentSubProfile=responseProfile=responseProfile||{};var popup=(0,_jQuery.default)("#responseProfilePopup",page);(0,_jQuery.default)("#selectResponseProfileType",popup).val(responseProfile.Type||"Video").trigger("change"),(0,_jQuery.default)("#txtResponseProfileContainer",popup).val(responseProfile.Container||""),(0,_jQuery.default)("#txtResponseProfileAudioCodec",popup).val(responseProfile.AudioCodec||""),(0,_jQuery.default)("#txtResponseProfileVideoCodec",popup).val(responseProfile.VideoCodec||""),(0,_jQuery.default)(".radioTabButton:first",popup).trigger("click"),openPopup(popup[0])}function saveProfile(page,profile){!function updateProfile(page,profile){profile.Name=(0,_jQuery.default)("#txtName",page).val(),profile.EnableAlbumArtInDidl=(0,_jQuery.default)("#chkEnableAlbumArtInDidl",page).is(":checked"),profile.EnableSingleAlbumArtLimit=(0,_jQuery.default)("#chkEnableSingleImageLimit",page).is(":checked"),profile.SupportedMediaTypes=(0,_jQuery.default)(".chkMediaType:checked",page).get().map((function(c){return c.getAttribute("data-value")})).join(","),profile.Identification=profile.Identification||{},profile.FriendlyName=(0,_jQuery.default)("#txtInfoFriendlyName",page).val(),profile.ModelName=(0,_jQuery.default)("#txtInfoModelName",page).val(),profile.ModelNumber=(0,_jQuery.default)("#txtInfoModelNumber",page).val(),profile.ModelDescription=(0,_jQuery.default)("#txtInfoModelDescription",page).val(),profile.ModelUrl=(0,_jQuery.default)("#txtInfoModelUrl",page).val(),profile.Manufacturer=(0,_jQuery.default)("#txtInfoManufacturer",page).val(),profile.ManufacturerUrl=(0,_jQuery.default)("#txtInfoManufacturerUrl",page).val(),profile.SerialNumber=(0,_jQuery.default)("#txtInfoSerialNumber",page).val(),profile.Identification.FriendlyName=(0,_jQuery.default)("#txtIdFriendlyName",page).val(),profile.Identification.ModelName=(0,_jQuery.default)("#txtIdModelName",page).val(),profile.Identification.ModelNumber=(0,_jQuery.default)("#txtIdModelNumber",page).val(),profile.Identification.ModelDescription=(0,_jQuery.default)("#txtIdModelDescription",page).val(),profile.Identification.ModelUrl=(0,_jQuery.default)("#txtIdModelUrl",page).val(),profile.Identification.Manufacturer=(0,_jQuery.default)("#txtIdManufacturer",page).val(),profile.Identification.ManufacturerUrl=(0,_jQuery.default)("#txtIdManufacturerUrl",page).val(),profile.Identification.SerialNumber=(0,_jQuery.default)("#txtIdSerialNumber",page).val(),profile.Identification.DeviceDescription=(0,_jQuery.default)("#txtIdDeviceDescription",page).val(),profile.AlbumArtPn=(0,_jQuery.default)("#txtAlbumArtPn",page).val(),profile.MaxAlbumArtWidth=(0,_jQuery.default)("#txtAlbumArtMaxWidth",page).val(),profile.MaxAlbumArtHeight=(0,_jQuery.default)("#txtAlbumArtMaxHeight",page).val(),profile.MaxIconWidth=(0,_jQuery.default)("#txtIconMaxWidth",page).val(),profile.MaxIconHeight=(0,_jQuery.default)("#txtIconMaxHeight",page).val(),profile.RequiresPlainFolders=(0,_jQuery.default)("#chkRequiresPlainFolders",page).is(":checked"),profile.RequiresPlainVideoItems=(0,_jQuery.default)("#chkRequiresPlainVideoItems",page).is(":checked"),profile.IgnoreTranscodeByteRangeRequests=(0,_jQuery.default)("#chkIgnoreTranscodeByteRangeRequests",page).is(":checked"),profile.MaxStreamingBitrate=(0,_jQuery.default)("#txtMaxAllowedBitrate",page).val(),profile.MusicStreamingTranscodingBitrate=(0,_jQuery.default)("#txtMusicStreamingTranscodingBitrate",page).val(),profile.ProtocolInfo=(0,_jQuery.default)("#txtProtocolInfo",page).val(),profile.XDlnaCap=(0,_jQuery.default)("#txtXDlnaCap",page).val(),profile.XDlnaDoc=(0,_jQuery.default)("#txtXDlnaDoc",page).val(),profile.SonyAggregationFlags=(0,_jQuery.default)("#txtSonyAggregationFlags",page).val(),profile.UserId=(0,_jQuery.default)("#selectUser",page).val()}(page,profile);var id=getParameterByName("id");id?ApiClient.ajax({type:"POST",url:ApiClient.getUrl("Dlna/Profiles/"+id),data:JSON.stringify(profile),contentType:"application/json"}).then((function(){new Promise((function(_resolve,_reject){return _require(["toast"],(function(imported){return _resolve(function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;if(null===obj||"object"!==_typeof(obj)&&"function"!=typeof obj)return{default:obj};var cache=_getRequireWildcardCache();if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}return newObj.default=obj,cache&&cache.set(obj,newObj),newObj}(imported))}),_reject)})).then((function(_ref){(0,_ref.default)("Settings saved.")}))}),Dashboard.processErrorResponse):ApiClient.ajax({type:"POST",url:ApiClient.getUrl("Dlna/Profiles"),data:JSON.stringify(profile),contentType:"application/json"}).then((function(){Dashboard.navigate("dlnaprofiles.html")}),Dashboard.processErrorResponse),_loading.default.hide()}var currentProfile,currentSubProfile,isSubProfileNew;_jQuery=_interopRequireDefault(_jQuery),_loading=_interopRequireDefault(_loading);var allText=(_globalize=_interopRequireDefault(_globalize)).default.translate("All");(0,_jQuery.default)(document).on("pageinit","#dlnaProfilePage",(function(){var page=this;(0,_jQuery.default)(".radioTabButton",page).on("click",(function(){(0,_jQuery.default)(this).siblings().removeClass("ui-btn-active"),(0,_jQuery.default)(this).addClass("ui-btn-active");var value="A"==this.tagName?this.getAttribute("data-value"):this.value,elem=(0,_jQuery.default)("."+value,page);elem.siblings(".tabContent").hide(),elem.show()})),(0,_jQuery.default)("#selectDirectPlayProfileType",page).on("change",(function(){"Video"==this.value?(0,_jQuery.default)("#fldDirectPlayVideoCodec",page).show():(0,_jQuery.default)("#fldDirectPlayVideoCodec",page).hide(),"Photo"==this.value?(0,_jQuery.default)("#fldDirectPlayAudioCodec",page).hide():(0,_jQuery.default)("#fldDirectPlayAudioCodec",page).show()})),(0,_jQuery.default)("#selectTranscodingProfileType",page).on("change",(function(){"Video"==this.value?((0,_jQuery.default)("#fldTranscodingVideoCodec",page).show(),(0,_jQuery.default)("#fldTranscodingProtocol",page).show(),(0,_jQuery.default)("#fldEnableMpegtsM2TsMode",page).show()):((0,_jQuery.default)("#fldTranscodingVideoCodec",page).hide(),(0,_jQuery.default)("#fldTranscodingProtocol",page).hide(),(0,_jQuery.default)("#fldEnableMpegtsM2TsMode",page).hide()),"Photo"==this.value?((0,_jQuery.default)("#fldTranscodingAudioCodec",page).hide(),(0,_jQuery.default)("#fldEstimateContentLength",page).hide(),(0,_jQuery.default)("#fldReportByteRangeRequests",page).hide()):((0,_jQuery.default)("#fldTranscodingAudioCodec",page).show(),(0,_jQuery.default)("#fldEstimateContentLength",page).show(),(0,_jQuery.default)("#fldReportByteRangeRequests",page).show())})),(0,_jQuery.default)("#selectResponseProfileType",page).on("change",(function(){"Video"==this.value?(0,_jQuery.default)("#fldResponseProfileVideoCodec",page).show():(0,_jQuery.default)("#fldResponseProfileVideoCodec",page).hide(),"Photo"==this.value?(0,_jQuery.default)("#fldResponseProfileAudioCodec",page).hide():(0,_jQuery.default)("#fldResponseProfileAudioCodec",page).show()})),(0,_jQuery.default)(".btnAddDirectPlayProfile",page).on("click",(function(){editDirectPlayProfile(page)})),(0,_jQuery.default)(".btnAddTranscodingProfile",page).on("click",(function(){editTranscodingProfile(page)})),(0,_jQuery.default)(".btnAddContainerProfile",page).on("click",(function(){editContainerProfile(page)})),(0,_jQuery.default)(".btnAddCodecProfile",page).on("click",(function(){editCodecProfile(page)})),(0,_jQuery.default)(".btnAddResponseProfile",page).on("click",(function(){editResponseProfile(page)})),(0,_jQuery.default)(".btnAddIdentificationHttpHeader",page).on("click",(function(){!function editIdentificationHeader(page,header){isSubProfileNew=null==header,currentSubProfile=header=header||{};var popup=(0,_jQuery.default)("#identificationHeaderPopup",page);(0,_jQuery.default)("#txtIdentificationHeaderName",popup).val(header.Name||""),(0,_jQuery.default)("#txtIdentificationHeaderValue",popup).val(header.Value||""),(0,_jQuery.default)("#selectMatchType",popup).val(header.Match||"Equals"),openPopup(popup[0])}(page)})),(0,_jQuery.default)(".btnAddXmlDocumentAttribute",page).on("click",(function(){!function editXmlDocumentAttribute(page,attribute){isSubProfileNew=null==attribute,currentSubProfile=attribute=attribute||{};var popup=(0,_jQuery.default)("#xmlAttributePopup",page);(0,_jQuery.default)("#txtXmlAttributeName",popup).val(attribute.Name||""),(0,_jQuery.default)("#txtXmlAttributeValue",popup).val(attribute.Value||""),openPopup(popup[0])}(page)})),(0,_jQuery.default)(".btnAddSubtitleProfile",page).on("click",(function(){editSubtitleProfile(page)})),(0,_jQuery.default)(".dlnaProfileForm").off("submit",DlnaProfilePage.onSubmit).on("submit",DlnaProfilePage.onSubmit),(0,_jQuery.default)(".editDirectPlayProfileForm").off("submit",DlnaProfilePage.onDirectPlayFormSubmit).on("submit",DlnaProfilePage.onDirectPlayFormSubmit),(0,_jQuery.default)(".transcodingProfileForm").off("submit",DlnaProfilePage.onTranscodingProfileFormSubmit).on("submit",DlnaProfilePage.onTranscodingProfileFormSubmit),(0,_jQuery.default)(".containerProfileForm").off("submit",DlnaProfilePage.onContainerProfileFormSubmit).on("submit",DlnaProfilePage.onContainerProfileFormSubmit),(0,_jQuery.default)(".codecProfileForm").off("submit",DlnaProfilePage.onCodecProfileFormSubmit).on("submit",DlnaProfilePage.onCodecProfileFormSubmit),(0,_jQuery.default)(".editResponseProfileForm").off("submit",DlnaProfilePage.onResponseProfileFormSubmit).on("submit",DlnaProfilePage.onResponseProfileFormSubmit),(0,_jQuery.default)(".identificationHeaderForm").off("submit",DlnaProfilePage.onIdentificationHeaderFormSubmit).on("submit",DlnaProfilePage.onIdentificationHeaderFormSubmit),(0,_jQuery.default)(".xmlAttributeForm").off("submit",DlnaProfilePage.onXmlAttributeFormSubmit).on("submit",DlnaProfilePage.onXmlAttributeFormSubmit),(0,_jQuery.default)(".subtitleProfileForm").off("submit",DlnaProfilePage.onSubtitleProfileFormSubmit).on("submit",DlnaProfilePage.onSubtitleProfileFormSubmit)})).on("pageshow","#dlnaProfilePage",(function(){(0,_jQuery.default)("#radioInfo",this).trigger("click"),loadProfile(this)})),window.DlnaProfilePage={onSubmit:function onSubmit(){return _loading.default.show(),saveProfile((0,_jQuery.default)(this).parents(".page"),currentProfile),!1},onDirectPlayFormSubmit:function onDirectPlayFormSubmit(){return function saveDirectPlayProfile(page){currentSubProfile.Type=(0,_jQuery.default)("#selectDirectPlayProfileType",page).val(),currentSubProfile.Container=(0,_jQuery.default)("#txtDirectPlayContainer",page).val(),currentSubProfile.AudioCodec=(0,_jQuery.default)("#txtDirectPlayAudioCodec",page).val(),currentSubProfile.VideoCodec=(0,_jQuery.default)("#txtDirectPlayVideoCodec",page).val(),isSubProfileNew&&currentProfile.DirectPlayProfiles.push(currentSubProfile),renderSubProfiles(page,currentProfile),currentSubProfile=null,closePopup((0,_jQuery.default)("#popupEditDirectPlayProfile",page)[0])}((0,_jQuery.default)(this).parents(".page")),!1},onTranscodingProfileFormSubmit:function onTranscodingProfileFormSubmit(){return function saveTranscodingProfile(page){currentSubProfile.Type=(0,_jQuery.default)("#selectTranscodingProfileType",page).val(),currentSubProfile.Container=(0,_jQuery.default)("#txtTranscodingContainer",page).val(),currentSubProfile.AudioCodec=(0,_jQuery.default)("#txtTranscodingAudioCodec",page).val(),currentSubProfile.VideoCodec=(0,_jQuery.default)("#txtTranscodingVideoCodec",page).val(),currentSubProfile.Protocol=(0,_jQuery.default)("#selectTranscodingProtocol",page).val(),currentSubProfile.Context="Streaming",currentSubProfile.EnableMpegtsM2TsMode=(0,_jQuery.default)("#chkEnableMpegtsM2TsMode",page).is(":checked"),currentSubProfile.EstimateContentLength=(0,_jQuery.default)("#chkEstimateContentLength",page).is(":checked"),currentSubProfile.TranscodeSeekInfo=(0,_jQuery.default)("#chkReportByteRangeRequests",page).is(":checked")?"Bytes":"Auto",isSubProfileNew&&currentProfile.TranscodingProfiles.push(currentSubProfile),renderSubProfiles(page,currentProfile),currentSubProfile=null,closePopup((0,_jQuery.default)("#transcodingProfilePopup",page)[0])}((0,_jQuery.default)(this).parents(".page")),!1},onContainerProfileFormSubmit:function onContainerProfileFormSubmit(){return function saveContainerProfile(page){currentSubProfile.Type=(0,_jQuery.default)("#selectContainerProfileType",page).val(),currentSubProfile.Container=(0,_jQuery.default)("#txtContainerProfileContainer",page).val(),isSubProfileNew&&currentProfile.ContainerProfiles.push(currentSubProfile),renderSubProfiles(page,currentProfile),currentSubProfile=null,closePopup((0,_jQuery.default)("#containerProfilePopup",page)[0])}((0,_jQuery.default)(this).parents(".page")),!1},onCodecProfileFormSubmit:function onCodecProfileFormSubmit(){return function saveCodecProfile(page){currentSubProfile.Type=(0,_jQuery.default)("#selectCodecProfileType",page).val(),currentSubProfile.Codec=(0,_jQuery.default)("#txtCodecProfileCodec",page).val(),isSubProfileNew&&currentProfile.CodecProfiles.push(currentSubProfile),renderSubProfiles(page,currentProfile),currentSubProfile=null,closePopup((0,_jQuery.default)("#codecProfilePopup",page)[0])}((0,_jQuery.default)(this).parents(".page")),!1},onResponseProfileFormSubmit:function onResponseProfileFormSubmit(){return function saveResponseProfile(page){currentSubProfile.Type=(0,_jQuery.default)("#selectResponseProfileType",page).val(),currentSubProfile.Container=(0,_jQuery.default)("#txtResponseProfileContainer",page).val(),currentSubProfile.AudioCodec=(0,_jQuery.default)("#txtResponseProfileAudioCodec",page).val(),currentSubProfile.VideoCodec=(0,_jQuery.default)("#txtResponseProfileVideoCodec",page).val(),isSubProfileNew&&currentProfile.ResponseProfiles.push(currentSubProfile),renderSubProfiles(page,currentProfile),currentSubProfile=null,closePopup((0,_jQuery.default)("#responseProfilePopup",page)[0])}((0,_jQuery.default)(this).parents(".page")),!1},onIdentificationHeaderFormSubmit:function onIdentificationHeaderFormSubmit(){return function saveIdentificationHeader(page){currentSubProfile.Name=(0,_jQuery.default)("#txtIdentificationHeaderName",page).val(),currentSubProfile.Value=(0,_jQuery.default)("#txtIdentificationHeaderValue",page).val(),currentSubProfile.Match=(0,_jQuery.default)("#selectMatchType",page).val(),isSubProfileNew&&(currentProfile.Identification=currentProfile.Identification||{},currentProfile.Identification.Headers=currentProfile.Identification.Headers||[],currentProfile.Identification.Headers.push(currentSubProfile)),renderIdentificationHeaders(page,currentProfile.Identification.Headers),currentSubProfile=null,closePopup((0,_jQuery.default)("#identificationHeaderPopup",page)[0])}((0,_jQuery.default)(this).parents(".page")),!1},onXmlAttributeFormSubmit:function onXmlAttributeFormSubmit(){return function saveXmlDocumentAttribute(page){currentSubProfile.Name=(0,_jQuery.default)("#txtXmlAttributeName",page).val(),currentSubProfile.Value=(0,_jQuery.default)("#txtXmlAttributeValue",page).val(),isSubProfileNew&&currentProfile.XmlRootAttributes.push(currentSubProfile),renderXmlDocumentAttributes(page,currentProfile.XmlRootAttributes),currentSubProfile=null,closePopup((0,_jQuery.default)("#xmlAttributePopup",page)[0])}((0,_jQuery.default)(this).parents(".page")),!1},onSubtitleProfileFormSubmit:function onSubtitleProfileFormSubmit(){return function saveSubtitleProfile(page){currentSubProfile.Format=(0,_jQuery.default)("#txtSubtitleProfileFormat",page).val(),currentSubProfile.Method=(0,_jQuery.default)("#selectSubtitleProfileMethod",page).val(),currentSubProfile.DidlMode=(0,_jQuery.default)("#selectSubtitleProfileDidlMode",page).val(),isSubProfileNew&&currentProfile.SubtitleProfiles.push(currentSubProfile),renderSubtitleProfiles(page,currentProfile.SubtitleProfiles),currentSubProfile=null,closePopup((0,_jQuery.default)("#subtitleProfilePopup",page)[0])}((0,_jQuery.default)(this).parents(".page")),!1}}}));
//# sourceMappingURL=profile.js.map
