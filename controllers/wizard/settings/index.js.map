{"version":3,"sources":["controllers/wizard/settings/index.js"],"names":["define","_exports","_loading","_embyCheckbox","_embyButton","_embySelect","save","page","loading","show","apiClient","ApiClient","getJSON","getUrl","then","config","PreferredMetadataLanguage","querySelector","value","MetadataCountryCode","ajax","type","data","JSON","stringify","url","hide","navigateToNextPage","Dashboard","navigate","onSubmit","e","this","preventDefault","Object","defineProperty","default","_default","view","params","addEventListener","document","classList","add","reload","promise1","promise2","getCultures","promise3","getCountries","Promise","all","responses","reloadData","cultures","countries","populateLanguages","select","languages","html","i","length","culture","TwoLetterISOLanguageName","DisplayName","innerHTML","populateCountries","allCountries","TwoLetterISORegionName","remove","_interopRequireDefault","obj","__esModule"],"mappings":"AAAAA,OAAO,CAAC,UAAW,UAAW,gBAAiB,cAAe,gBAAgB,SAAUC,SAAUC,SAAUC,cAAeC,YAAaC,aACtI,aAIF,SAASC,KAAKC,MACVC,SAAAA,QAAQC,OACR,IAAMC,UAAYC,UAClBD,UAAUE,QAAQF,UAAUG,OAAO,0BAA0BC,MAAK,SAAUC,QACxEA,OAAOC,0BAA4BT,KAAKU,cAAc,mBAAmBC,MACzEH,OAAOI,oBAAsBZ,KAAKU,cAAc,kBAAkBC,MAClER,UAAUU,KAAK,CACXC,KAAM,OACNC,KAAMC,KAAKC,UAAUT,QACrBU,IAAKf,UAAUG,OAAO,2BACvBC,MAAK,WACJN,SAAAA,QAAQkB,OAiDpB,SAASC,qBACLC,UAAUC,SAAS,2BAjDXF,SAoDZ,SAASG,SAASC,GAGd,OAFAzB,KAAK0B,MACLD,EAAEE,kBACK,EArETC,OAAOC,eAAelC,SAAU,aAAc,CAC5CiB,OAAO,IAETjB,SAASmC,QAqEI,SAAAC,SAAUC,KAAMC,QAC3BD,KAAKrB,cAAc,uBAAuBuB,iBAAiB,SAAUV,UACrEQ,KAAKE,iBAAiB,YAAY,WAC9BC,SAASxB,cAAc,eAAeyB,UAAUC,IAAI,sBAxB5D,SAASC,OAAOrC,MACZC,SAAAA,QAAQC,OACR,IAAMC,UAAYC,UACZkC,SAAWnC,UAAUE,QAAQF,UAAUG,OAAO,0BAC9CiC,SAAWpC,UAAUqC,cACrBC,SAAWtC,UAAUuC,eAC3BC,QAAQC,IAAI,CAACN,SAAUC,SAAUE,WAAWlC,MAAK,SAAUsC,YAd/D,SAASC,WAAW9C,KAAMQ,OAAQuC,SAAUC,YAxB5C,SAASC,kBAAkBC,OAAQC,WAC/B,IAAIC,KAAO,GACXA,MAAQ,6BAER,IAAK,IAAIC,EAAI,EAAGC,OAASH,UAAUG,OAAQD,EAAIC,OAAQD,IAAK,CACxD,IAAME,QAAUJ,UAAUE,GAC1BD,MAAQ,kBAAoBG,QAAQC,yBAA2B,KAAOD,QAAQE,YAAc,YAGhGP,OAAOQ,UAAYN,MAgBnBH,CAAkBjD,KAAKU,cAAc,mBAAoBqC,UAb7D,SAASY,kBAAkBT,OAAQU,cAC/B,IAAIR,KAAO,GACXA,MAAQ,6BAER,IAAK,IAAIC,EAAI,EAAGC,OAASM,aAAaN,OAAQD,EAAIC,OAAQD,IAAK,CAC3D,IAAME,QAAUK,aAAaP,GAC7BD,MAAQ,kBAAoBG,QAAQM,uBAAyB,KAAON,QAAQE,YAAc,YAG9FP,OAAOQ,UAAYN,KAKnBO,CAAkB3D,KAAKU,cAAc,kBAAmBsC,WACxDhD,KAAKU,cAAc,mBAAmBC,MAAQH,OAAOC,0BACrDT,KAAKU,cAAc,kBAAkBC,MAAQH,OAAOI,oBACpDX,SAAAA,QAAQkB,OAUJ2B,CAAW9C,KAAM6C,UAAU,GAAIA,UAAU,GAAIA,UAAU,OAkBvDR,CAAOZ,SAEXM,KAAKE,iBAAiB,YAAY,WAC9BC,SAASxB,cAAc,eAAeyB,UAAU2B,OAAO,0BAlF/DnE,SASE,SAASoE,uBAAuBC,KAAO,OAAOA,KAAOA,IAAIC,WAAaD,IAAM,CAAEnC,QAASmC,KATzFD,CAAApE","file":"index.js","sourcesContent":["import loading from 'loading';\nimport 'emby-checkbox';\nimport 'emby-button';\nimport 'emby-select';\n\nfunction save(page) {\n    loading.show();\n    const apiClient = ApiClient;\n    apiClient.getJSON(apiClient.getUrl('Startup/Configuration')).then(function (config) {\n        config.PreferredMetadataLanguage = page.querySelector('#selectLanguage').value;\n        config.MetadataCountryCode = page.querySelector('#selectCountry').value;\n        apiClient.ajax({\n            type: 'POST',\n            data: JSON.stringify(config),\n            url: apiClient.getUrl('Startup/Configuration')\n        }).then(function () {\n            loading.hide();\n            navigateToNextPage();\n        });\n    });\n}\n\nfunction populateLanguages(select, languages) {\n    let html = '';\n    html += \"<option value=''></option>\";\n\n    for (let i = 0, length = languages.length; i < length; i++) {\n        const culture = languages[i];\n        html += \"<option value='\" + culture.TwoLetterISOLanguageName + \"'>\" + culture.DisplayName + '</option>';\n    }\n\n    select.innerHTML = html;\n}\n\nfunction populateCountries(select, allCountries) {\n    let html = '';\n    html += \"<option value=''></option>\";\n\n    for (let i = 0, length = allCountries.length; i < length; i++) {\n        const culture = allCountries[i];\n        html += \"<option value='\" + culture.TwoLetterISORegionName + \"'>\" + culture.DisplayName + '</option>';\n    }\n\n    select.innerHTML = html;\n}\n\nfunction reloadData(page, config, cultures, countries) {\n    populateLanguages(page.querySelector('#selectLanguage'), cultures);\n    populateCountries(page.querySelector('#selectCountry'), countries);\n    page.querySelector('#selectLanguage').value = config.PreferredMetadataLanguage;\n    page.querySelector('#selectCountry').value = config.MetadataCountryCode;\n    loading.hide();\n}\n\nfunction reload(page) {\n    loading.show();\n    const apiClient = ApiClient;\n    const promise1 = apiClient.getJSON(apiClient.getUrl('Startup/Configuration'));\n    const promise2 = apiClient.getCultures();\n    const promise3 = apiClient.getCountries();\n    Promise.all([promise1, promise2, promise3]).then(function (responses) {\n        reloadData(page, responses[0], responses[1], responses[2]);\n    });\n}\n\nfunction navigateToNextPage() {\n    Dashboard.navigate('wizardremoteaccess.html');\n}\n\nfunction onSubmit(e) {\n    save(this);\n    e.preventDefault();\n    return false;\n}\n\nexport default function (view, params) {\n    view.querySelector('.wizardSettingsForm').addEventListener('submit', onSubmit);\n    view.addEventListener('viewshow', function () {\n        document.querySelector('.skinHeader').classList.add('noHomeButtonHeader');\n        reload(this);\n    });\n    view.addEventListener('viewhide', function () {\n        document.querySelector('.skinHeader').classList.remove('noHomeButtonHeader');\n    });\n}\n"]}