define(["require","exports","globalize","listView","layoutManager","userSettings","focusManager","cardBuilder","loading","connectionManager","alphaNumericShortcuts","playbackManager","alphaPicker","emby-itemscontainer","emby-scroller"],(function(_require,_exports,_globalize,_listView,_layoutManager,userSettings,_focusManager,_cardBuilder,_loading,_connectionManager,_alphaNumericShortcuts,_playbackManager,_alphaPicker,_embyItemscontainer,_embyScroller){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _getRequireWildcardCache(){if("function"!=typeof WeakMap)return null;var cache=new WeakMap;return _getRequireWildcardCache=function _getRequireWildcardCache(){return cache},cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;if(null===obj||"object"!==_typeof(obj)&&"function"!=typeof obj)return{default:obj};var cache=_getRequireWildcardCache();if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}return newObj.default=obj,cache&&cache.set(obj,newObj),newObj}function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function getInitialLiveTvQuery(instance,params){var query={UserId:_connectionManager.default.getApiClient(params.serverId).getCurrentUserId(),StartIndex:0,Fields:"ChannelInfo,PrimaryImageAspectRatio",Limit:300};return"Recordings"===params.type?query.IsInProgress=!1:query.HasAired=!1,params.genreId&&(query.GenreIds=params.genreId),"true"===params.IsMovie?query.IsMovie=!0:"false"===params.IsMovie&&(query.IsMovie=!1),"true"===params.IsSeries?query.IsSeries=!0:"false"===params.IsSeries&&(query.IsSeries=!1),"true"===params.IsNews?query.IsNews=!0:"false"===params.IsNews&&(query.IsNews=!1),"true"===params.IsSports?query.IsSports=!0:"false"===params.IsSports&&(query.IsSports=!1),"true"===params.IsKids?query.IsKids=!0:"false"===params.IsKids&&(query.IsKids=!1),"true"===params.IsAiring?query.IsAiring=!0:"false"===params.IsAiring&&(query.IsAiring=!1),modifyQueryWithFilters(instance,query)}function modifyQueryWithFilters(instance,query){var hasFilters,sortValues=instance.getSortValues();query.SortBy||(query.SortBy=sortValues.sortBy,query.SortOrder=sortValues.sortOrder),query.Fields=query.Fields?query.Fields+",PrimaryImageAspectRatio":"PrimaryImageAspectRatio",query.ImageTypeLimit=1;var queryFilters=[],filters=instance.getFilters();return filters.IsPlayed&&(queryFilters.push("IsPlayed"),hasFilters=!0),filters.IsUnplayed&&(queryFilters.push("IsUnplayed"),hasFilters=!0),filters.IsFavorite&&(queryFilters.push("IsFavorite"),hasFilters=!0),filters.IsResumable&&(queryFilters.push("IsResumable"),hasFilters=!0),filters.VideoTypes&&(hasFilters=!0,query.VideoTypes=filters.VideoTypes),filters.GenreIds&&(hasFilters=!0,query.GenreIds=filters.GenreIds),filters.Is4K&&(query.Is4K=!0,hasFilters=!0),filters.IsHD&&(query.IsHD=!0,hasFilters=!0),filters.IsSD&&(query.IsHD=!1,hasFilters=!0),filters.Is3D&&(query.Is3D=!0,hasFilters=!0),filters.HasSubtitles&&(query.HasSubtitles=!0,hasFilters=!0),filters.HasTrailer&&(query.HasTrailer=!0,hasFilters=!0),filters.HasSpecialFeature&&(query.HasSpecialFeature=!0,hasFilters=!0),filters.HasThemeSong&&(query.HasThemeSong=!0,hasFilters=!0),filters.HasThemeVideo&&(query.HasThemeVideo=!0,hasFilters=!0),query.Filters=queryFilters.length?queryFilters.join(","):null,instance.setFilterStatus(hasFilters),instance.alphaPicker&&(query.NameStartsWithOrGreater=instance.alphaPicker.value()),query}function updateSortText(instance){var btnSortText=instance.btnSortText;if(btnSortText){var _step,options=instance.getSortMenuOptions(),values=instance.getSortValues(),sortBy=values.sortBy,_iterator=_createForOfIteratorHelper(options);try{for(_iterator.s();!(_step=_iterator.n()).done;){var option=_step.value;if(sortBy===option.value){btnSortText.innerHTML=_globalize.default.translate("SortByValue",option.name);break}}}catch(err){_iterator.e(err)}finally{_iterator.f()}var btnSortIcon=instance.btnSortIcon;btnSortIcon&&function setSortButtonIcon(btnSortIcon,icon){btnSortIcon.classList.remove("arrow_downward"),btnSortIcon.classList.remove("arrow_upward"),btnSortIcon.classList.add(icon)}(btnSortIcon,"Descending"===values.sortOrder?"arrow_downward":"arrow_upward")}}function updateItemsContainerForViewType(instance){"list"===instance.getViewSettings().imageType?(instance.itemsContainer.classList.remove("vertical-wrap"),instance.itemsContainer.classList.add("vertical-list")):(instance.itemsContainer.classList.add("vertical-wrap"),instance.itemsContainer.classList.remove("vertical-list"))}function updateAlphaPickerState(instance,numItems){if(instance.alphaPicker){var alphaPicker=instance.alphaPickerElement;if(alphaPicker){var values=instance.getSortValues();null==numItems&&(numItems=100),"SortName"===values.sortBy&&"Ascending"===values.sortOrder&&numItems>40?(alphaPicker.classList.remove("hide"),instance.itemsContainer.parentNode.classList.add("padded-right-withalphapicker")):(alphaPicker.classList.add("hide"),instance.itemsContainer.parentNode.classList.remove("padded-right-withalphapicker"))}}}function getItems(instance,params,item,sortBy,startIndex,limit){var apiClient=_connectionManager.default.getApiClient(params.serverId);if(instance.queryRecursive=!1,"Recordings"===params.type)return apiClient.getLiveTvRecordings(getInitialLiveTvQuery(instance,params));if("Programs"===params.type)return"true"===params.IsAiring?apiClient.getLiveTvRecommendedPrograms(getInitialLiveTvQuery(instance,params)):apiClient.getLiveTvPrograms(getInitialLiveTvQuery(instance,params));if("nextup"===params.type)return apiClient.getNextUpEpisodes(modifyQueryWithFilters(instance,{Limit:limit,Fields:"PrimaryImageAspectRatio,SeriesInfo,DateCreated,BasicSyncInfo",UserId:apiClient.getCurrentUserId(),ImageTypeLimit:1,EnableImageTypes:"Primary,Backdrop,Thumb",EnableTotalRecordCount:!1,SortBy:sortBy}));if(!item){instance.queryRecursive=!0;var method="getItems";return"MusicArtist"===params.type?method="getArtists":"Person"===params.type&&(method="getPeople"),apiClient[method](apiClient.getCurrentUserId(),modifyQueryWithFilters(instance,{StartIndex:startIndex,Limit:limit,Fields:"PrimaryImageAspectRatio,SortName",ImageTypeLimit:1,IncludeItemTypes:"MusicArtist"===params.type||"Person"===params.type?null:params.type,Recursive:!0,IsFavorite:"true"===params.IsFavorite||null,ArtistIds:params.artistId||null,SortBy:sortBy}))}if("Genre"===item.Type||"MusicGenre"===item.Type||"Studio"===item.Type||"Person"===item.Type){instance.queryRecursive=!0;var query={StartIndex:startIndex,Limit:limit,Fields:"PrimaryImageAspectRatio,SortName",Recursive:!0,parentId:params.parentId,SortBy:sortBy};return"Studio"===item.Type?query.StudioIds=item.Id:"Genre"===item.Type||"MusicGenre"===item.Type?query.GenreIds=item.Id:"Person"===item.Type&&(query.PersonIds=item.Id),"MusicGenre"===item.Type?query.IncludeItemTypes="MusicAlbum":"GameGenre"===item.Type?query.IncludeItemTypes="Game":"movies"===item.CollectionType?query.IncludeItemTypes="Movie":"tvshows"===item.CollectionType?query.IncludeItemTypes="Series":"Genre"===item.Type?query.IncludeItemTypes="Movie,Series,Video":"Person"===item.Type&&(query.IncludeItemTypes=params.type),apiClient.getItems(apiClient.getCurrentUserId(),modifyQueryWithFilters(instance,query))}return apiClient.getItems(apiClient.getCurrentUserId(),modifyQueryWithFilters(instance,{StartIndex:startIndex,Limit:limit,Fields:"PrimaryImageAspectRatio,SortName,Path",ImageTypeLimit:1,ParentId:item.Id,SortBy:sortBy}))}function showViewSettingsMenu(){var instance=this;new Promise((function(_resolve,_reject){return _require(["viewSettings"],(function(imported){return _resolve(_interopRequireWildcard(imported))}),_reject)})).then((function(_ref){(new(0,_ref.default)).show({settingsKey:instance.getSettingsKey(),settings:instance.getViewSettings(),visibleSettings:instance.getVisibleViewSettings()}).then((function(){updateItemsContainerForViewType(instance),instance.itemsContainer.refreshItems()}))}))}function showFilterMenu(){var instance=this;new Promise((function(_resolve,_reject){return _require(["filterMenu"],(function(imported){return _resolve(_interopRequireWildcard(imported))}),_reject)})).then((function(_ref2){(new(0,_ref2.default)).show({settingsKey:instance.getSettingsKey(),settings:instance.getFilters(),visibleSettings:instance.getVisibleFilters(),onChange:instance.itemsContainer.refreshItems.bind(instance.itemsContainer),parentId:instance.params.parentId,itemTypes:instance.getItemTypes(),serverId:instance.params.serverId,filterMenuOptions:instance.getFilterMenuOptions()}).then((function(){instance.itemsContainer.refreshItems()}))}))}function showSortMenu(){var instance=this;new Promise((function(_resolve,_reject){return _require(["sortMenu"],(function(imported){return _resolve(_interopRequireWildcard(imported))}),_reject)})).then((function(_ref3){(new(0,_ref3.default)).show({settingsKey:instance.getSettingsKey(),settings:instance.getSortValues(),onChange:instance.itemsContainer.refreshItems.bind(instance.itemsContainer),serverId:instance.params.serverId,sortOptions:instance.getSortMenuOptions()}).then((function(){updateSortText(instance),updateAlphaPickerState(instance),instance.itemsContainer.refreshItems()}))}))}function onNewItemClick(){var instance=this;new Promise((function(_resolve,_reject){return _require(["playlistEditor"],(function(imported){return _resolve(_interopRequireWildcard(imported))}),_reject)})).then((function(_ref4){new(0,_ref4.default)({items:[],serverId:instance.params.serverId})}))}function hideOrShowAll(elems,hide){var _step2,_iterator2=_createForOfIteratorHelper(elems);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var elem=_step2.value;hide?elem.classList.add("hide"):elem.classList.remove("hide")}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}function bindAll(elems,eventName,fn){var _step3,_iterator3=_createForOfIteratorHelper(elems);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){_step3.value.addEventListener(eventName,fn)}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,_globalize=_interopRequireDefault(_globalize),_listView=_interopRequireDefault(_listView),_layoutManager=_interopRequireDefault(_layoutManager),userSettings=_interopRequireWildcard(userSettings),_focusManager=_interopRequireDefault(_focusManager),_cardBuilder=_interopRequireDefault(_cardBuilder),_loading=_interopRequireDefault(_loading),_connectionManager=_interopRequireDefault(_connectionManager),_alphaNumericShortcuts=_interopRequireDefault(_alphaNumericShortcuts),_playbackManager=_interopRequireDefault(_playbackManager),_alphaPicker=_interopRequireDefault(_alphaPicker);var _default=function(){function ItemsView(view,params){function onAlphaPickerValueChanged(){self.alphaPicker.value(),self.itemsContainer.refreshItems()}function setTitle(item){Emby.Page.setTitle(function getTitle(item){if("Recordings"===params.type)return _globalize.default.translate("Recordings");if("Programs"===params.type)return"true"===params.IsMovie?_globalize.default.translate("Movies"):"true"===params.IsSports?_globalize.default.translate("Sports"):"true"===params.IsKids?_globalize.default.translate("HeaderForKids"):"true"===params.IsAiring?_globalize.default.translate("HeaderOnNow"):"true"===params.IsSeries?_globalize.default.translate("Shows"):"true"===params.IsNews?_globalize.default.translate("News"):_globalize.default.translate("Programs");if("nextup"===params.type)return _globalize.default.translate("NextUp");if("favoritemovies"===params.type)return _globalize.default.translate("FavoriteMovies");if(item)return item.Name;if("Movie"===params.type)return _globalize.default.translate("Movies");if("Series"===params.type)return _globalize.default.translate("Shows");if("Season"===params.type)return _globalize.default.translate("Seasons");if("Episode"===params.type)return _globalize.default.translate("Episodes");if("MusicArtist"===params.type)return _globalize.default.translate("Artists");if("MusicAlbum"===params.type)return _globalize.default.translate("Albums");if("Audio"===params.type)return _globalize.default.translate("Songs");if("Video"===params.type)return _globalize.default.translate("Videos");return}(item)||""),item&&"playlists"===item.CollectionType?hideOrShowAll(view.querySelectorAll(".btnNewItem"),!1):hideOrShowAll(view.querySelectorAll(".btnNewItem"),!0)}function play(){var currentItem=self.currentItem;currentItem&&!self.hasFilters?_playbackManager.default.play({items:[currentItem]}):getItems(self,self.params,currentItem,null,null,300).then((function(result){_playbackManager.default.play({items:result.Items})}))}function queue(){var currentItem=self.currentItem;currentItem&&!self.hasFilters?_playbackManager.default.queue({items:[currentItem]}):getItems(self,self.params,currentItem,null,null,300).then((function(result){_playbackManager.default.queue({items:result.Items})}))}function shuffle(){var currentItem=self.currentItem;currentItem&&!self.hasFilters?_playbackManager.default.shuffle(currentItem):getItems(self,self.params,currentItem,"Random",null,300).then((function(result){_playbackManager.default.play({items:result.Items})}))}!function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ItemsView);var self=this;self.params=params,this.itemsContainer=view.querySelector(".itemsContainer"),params.parentId?this.itemsContainer.setAttribute("data-parentid",params.parentId):"nextup"===params.type?this.itemsContainer.setAttribute("data-monitor","videoplayback"):"favoritemovies"===params.type?this.itemsContainer.setAttribute("data-monitor","markfavorite"):"Programs"===params.type&&this.itemsContainer.setAttribute("data-refreshinterval","300000");var _step4,_iterator4=_createForOfIteratorHelper(view.querySelectorAll(".btnViewSettings"));try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){_step4.value.addEventListener("click",showViewSettingsMenu.bind(this))}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}var filterButtons=view.querySelectorAll(".btnFilter");this.filterButtons=filterButtons;var _step5,hasVisibleFilters=this.getVisibleFilters().length,_iterator5=_createForOfIteratorHelper(filterButtons);try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var btnFilter=_step5.value;btnFilter.addEventListener("click",showFilterMenu.bind(this)),hasVisibleFilters?btnFilter.classList.remove("hide"):btnFilter.classList.add("hide")}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}var sortButtons=view.querySelectorAll(".btnSort");this.sortButtons=sortButtons;var _step6,_iterator6=_createForOfIteratorHelper(sortButtons);try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var sortButton=_step6.value;sortButton.addEventListener("click",showSortMenu.bind(this)),"nextup"!==params.type&&sortButton.classList.remove("hide")}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}this.btnSortText=view.querySelector(".btnSortText"),this.btnSortIcon=view.querySelector(".btnSortIcon"),bindAll(view.querySelectorAll(".btnNewItem"),"click",onNewItemClick.bind(this)),this.alphaPickerElement=view.querySelector(".alphaPicker"),self.itemsContainer.fetchData=function fetchData(){return getItems(self,params,self.currentItem).then((function(result){return null==self.totalItemCount&&(self.totalItemCount=result.Items?result.Items.length:result.length),updateAlphaPickerState(self,self.totalItemCount),result}))},self.itemsContainer.getItemsHtml=function getItemsHtml(items){var shape,preferThumb,preferDisc,preferLogo,defaultShape,settings=self.getViewSettings();if("list"===settings.imageType)return _listView.default.getListViewHtml({items:items});var item=self.currentItem,lines=settings.showTitle?2:0;"banner"===settings.imageType?shape="banner":"disc"===settings.imageType?(shape="square",preferDisc=!0):"logo"===settings.imageType?(shape="backdrop",preferLogo=!0):"thumb"===settings.imageType?(shape="backdrop",preferThumb=!0):"nextup"===params.type?(shape="backdrop",preferThumb="thumb"===settings.imageType):"Programs"===params.type||"Recordings"===params.type?(shape="true"===params.IsMovie?"portrait":"autoVertical",preferThumb="true"!==params.IsMovie&&"auto",defaultShape="true"===params.IsMovie?"portrait":"backdrop"):shape="autoVertical";var posterOptions={shape:shape,showTitle:settings.showTitle,showYear:settings.showTitle,centerText:!0,coverImage:!0,preferThumb:preferThumb,preferDisc:preferDisc,preferLogo:preferLogo,overlayPlayButton:!1,overlayMoreButton:!0,overlayText:!settings.showTitle,defaultShape:defaultShape,action:"Audio"===params.type?"playallfromhere":null};if("nextup"===params.type)posterOptions.showParentTitle=settings.showTitle;else if("Person"===params.type)posterOptions.showYear=!1,posterOptions.showParentTitle=!1,lines=1;else if("Audio"===params.type)posterOptions.showParentTitle=settings.showTitle;else if("MusicAlbum"===params.type)posterOptions.showParentTitle=settings.showTitle;else if("Episode"===params.type)posterOptions.showParentTitle=settings.showTitle;else if("MusicArtist"===params.type)posterOptions.showYear=!1,lines=1;else if("Programs"===params.type){lines=settings.showTitle?1:0;var showParentTitle=settings.showTitle&&"true"!==params.IsMovie;showParentTitle&&lines++;var showAirTime=settings.showTitle&&"Recordings"!==params.type;showAirTime&&lines++;var showYear=settings.showTitle&&"true"===params.IsMovie&&"Recordings"===params.type;showYear&&lines++,posterOptions=Object.assign(posterOptions,{inheritThumb:"Recordings"===params.type,context:"livetv",showParentTitle:showParentTitle,showAirTime:showAirTime,showAirDateTime:showAirTime,overlayPlayButton:!1,overlayMoreButton:!0,showYear:showYear,coverImage:!0})}else posterOptions.showParentTitle=settings.showTitle;return posterOptions.lines=lines,posterOptions.items=items,item&&"folders"===item.CollectionType&&(posterOptions.context="folders"),_cardBuilder.default.getCardsHtml(posterOptions)},view.addEventListener("viewshow",(function(e){var isRestored=e.detail.isRestored;isRestored||(_loading.default.show(),updateSortText(self),updateItemsContainerForViewType(self)),setTitle(null),function getItem(params){if("Recordings"===params.type||"Programs"===params.type||"nextup"===params.type)return Promise.resolve(null);var apiClient=_connectionManager.default.getApiClient(params.serverId),itemId=params.genreId||params.musicGenreId||params.studioId||params.personId||params.parentId;return itemId?apiClient.getItem(apiClient.getCurrentUserId(),itemId):Promise.resolve(null)}(params).then((function(item){setTitle(item),self.currentItem=item;var refresh=!isRestored;self.itemsContainer.resume({refresh:refresh}).then((function(){_loading.default.hide(),refresh&&_focusManager.default.autoFocus(self.itemsContainer)})),!isRestored&&item&&"PhotoAlbum"!==item.Type&&function initAlphaPicker(){self.scroller=view.querySelector(".scrollFrameY");var alphaPickerElement=self.alphaPickerElement;alphaPickerElement.classList.add("alphaPicker-fixed-right"),alphaPickerElement.classList.add("focuscontainer-right"),self.itemsContainer.parentNode.classList.add("padded-right-withalphapicker"),self.alphaPicker=new _alphaPicker.default({element:alphaPickerElement,itemsContainer:_layoutManager.default.tv?self.itemsContainer:null,itemClass:"card",valueChangeEvent:_layoutManager.default.tv?null:"click"}),self.alphaPicker.on("alphavaluechanged",onAlphaPickerValueChanged)}();var itemType=item?item.Type:null;"MusicGenre"===itemType||"Programs"!==params.type&&"Channel"!==itemType?hideOrShowAll(view.querySelectorAll(".btnPlay"),!1):hideOrShowAll(view.querySelectorAll(".btnPlay"),!0),"MusicGenre"===itemType||"Programs"!==params.type&&"nextup"!==params.type&&"Channel"!==itemType?hideOrShowAll(view.querySelectorAll(".btnShuffle"),!1):hideOrShowAll(view.querySelectorAll(".btnShuffle"),!0),item&&_playbackManager.default.canQueue(item)?hideOrShowAll(view.querySelectorAll(".btnQueue"),!1):hideOrShowAll(view.querySelectorAll(".btnQueue"),!0)})),isRestored||(bindAll(view.querySelectorAll(".btnPlay"),"click",play),bindAll(view.querySelectorAll(".btnQueue"),"click",queue),bindAll(view.querySelectorAll(".btnShuffle"),"click",shuffle)),self.alphaNumericShortcuts=new _alphaNumericShortcuts.default({itemsContainer:self.itemsContainer})})),view.addEventListener("viewhide",(function(e){var itemsContainer=self.itemsContainer;itemsContainer&&itemsContainer.pause();var alphaNumericShortcuts=self.alphaNumericShortcuts;alphaNumericShortcuts&&(alphaNumericShortcuts.destroy(),self.alphaNumericShortcuts=null)})),view.addEventListener("viewdestroy",(function(){self.listController&&self.listController.destroy(),self.alphaPicker&&(self.alphaPicker.off("alphavaluechanged",onAlphaPickerValueChanged),self.alphaPicker.destroy()),self.currentItem=null,self.scroller=null,self.itemsContainer=null,self.filterButtons=null,self.sortButtons=null,self.btnSortText=null,self.btnSortIcon=null,self.alphaPickerElement=null}))}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(ItemsView,[{key:"getFilters",value:function getFilters(){var basekey=this.getSettingsKey();return{IsPlayed:"true"===userSettings.getFilter(basekey+"-filter-IsPlayed"),IsUnplayed:"true"===userSettings.getFilter(basekey+"-filter-IsUnplayed"),IsFavorite:"true"===userSettings.getFilter(basekey+"-filter-IsFavorite"),IsResumable:"true"===userSettings.getFilter(basekey+"-filter-IsResumable"),Is4K:"true"===userSettings.getFilter(basekey+"-filter-Is4K"),IsHD:"true"===userSettings.getFilter(basekey+"-filter-IsHD"),IsSD:"true"===userSettings.getFilter(basekey+"-filter-IsSD"),Is3D:"true"===userSettings.getFilter(basekey+"-filter-Is3D"),VideoTypes:userSettings.getFilter(basekey+"-filter-VideoTypes"),SeriesStatus:userSettings.getFilter(basekey+"-filter-SeriesStatus"),HasSubtitles:userSettings.getFilter(basekey+"-filter-HasSubtitles"),HasTrailer:userSettings.getFilter(basekey+"-filter-HasTrailer"),HasSpecialFeature:userSettings.getFilter(basekey+"-filter-HasSpecialFeature"),HasThemeSong:userSettings.getFilter(basekey+"-filter-HasThemeSong"),HasThemeVideo:userSettings.getFilter(basekey+"-filter-HasThemeVideo"),GenreIds:userSettings.getFilter(basekey+"-filter-GenreIds")}}},{key:"getSortValues",value:function getSortValues(){var basekey=this.getSettingsKey();return{sortBy:userSettings.getFilter(basekey+"-sortby")||this.getDefaultSortBy(),sortOrder:"Descending"===userSettings.getFilter(basekey+"-sortorder")?"Descending":"Ascending"}}},{key:"getDefaultSortBy",value:function getDefaultSortBy(){var sortNameOption=this.getNameSortOption(this.params);return this.params.type?sortNameOption.value:"IsFolder,"+sortNameOption.value}},{key:"getSortMenuOptions",value:function getSortMenuOptions(){var sortBy=[];"Programs"===this.params.type&&sortBy.push({name:_globalize.default.translate("AirDate"),value:"StartDate,SortName"});var option=this.getNameSortOption(this.params);return option&&sortBy.push(option),(option=this.getCommunityRatingSortOption())&&sortBy.push(option),(option=this.getCriticRatingSortOption())&&sortBy.push(option),"Programs"!==this.params.type&&sortBy.push({name:_globalize.default.translate("DateAdded"),value:"DateCreated,SortName"}),(option=this.getDatePlayedSortOption())&&sortBy.push(option),this.params.type||(option=this.getNameSortOption(this.params),sortBy.push({name:_globalize.default.translate("Folders"),value:"IsFolder,"+option.value})),sortBy.push({name:_globalize.default.translate("ParentalRating"),value:"OfficialRating,SortName"}),(option=this.getPlayCountSortOption())&&sortBy.push(option),sortBy.push({name:_globalize.default.translate("ReleaseDate"),value:"ProductionYear,PremiereDate,SortName"}),sortBy.push({name:_globalize.default.translate("Runtime"),value:"Runtime,SortName"}),sortBy}},{key:"getNameSortOption",value:function getNameSortOption(params){return"Episode"===params.type?{name:_globalize.default.translate("Name"),value:"SeriesName,SortName"}:{name:_globalize.default.translate("Name"),value:"SortName"}}},{key:"getPlayCountSortOption",value:function getPlayCountSortOption(){return"Programs"===this.params.type?null:{name:_globalize.default.translate("PlayCount"),value:"PlayCount,SortName"}}},{key:"getDatePlayedSortOption",value:function getDatePlayedSortOption(){return"Programs"===this.params.type?null:{name:_globalize.default.translate("DatePlayed"),value:"DatePlayed,SortName"}}},{key:"getCriticRatingSortOption",value:function getCriticRatingSortOption(){return"Programs"===this.params.type?null:{name:_globalize.default.translate("CriticRating"),value:"CriticRating,SortName"}}},{key:"getCommunityRatingSortOption",value:function getCommunityRatingSortOption(){return{name:_globalize.default.translate("CommunityRating"),value:"CommunityRating,SortName"}}},{key:"getVisibleFilters",value:function getVisibleFilters(){var filters=[],params=this.params;return"nextup"!==params.type&&("Programs"===params.type?filters.push("Genres"):(filters.push("IsUnplayed"),filters.push("IsPlayed"),params.IsFavorite||filters.push("IsFavorite"),filters.push("IsResumable"),filters.push("VideoType"),filters.push("HasSubtitles"),filters.push("HasTrailer"),filters.push("HasSpecialFeature"),filters.push("HasThemeSong"),filters.push("HasThemeVideo"))),filters}},{key:"setFilterStatus",value:function setFilterStatus(hasFilters){this.hasFilters=hasFilters;var filterButtons=this.filterButtons;if(filterButtons.length){var _step7,_iterator7=_createForOfIteratorHelper(filterButtons);try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){var btnFilter=_step7.value,bubble=btnFilter.querySelector(".filterButtonBubble");if(!bubble){if(!hasFilters)continue;btnFilter.insertAdjacentHTML("afterbegin",'<div class="filterButtonBubble">!</div>'),btnFilter.classList.add("btnFilterWithBubble"),bubble=btnFilter.querySelector(".filterButtonBubble")}hasFilters?bubble.classList.remove("hide"):bubble.classList.add("hide")}}catch(err){_iterator7.e(err)}finally{_iterator7.f()}}}},{key:"getFilterMenuOptions",value:function getFilterMenuOptions(){var params=this.params;return{IsAiring:params.IsAiring,IsMovie:params.IsMovie,IsSports:params.IsSports,IsKids:params.IsKids,IsNews:params.IsNews,IsSeries:params.IsSeries,Recursive:this.queryRecursive}}},{key:"getVisibleViewSettings",value:function getVisibleViewSettings(){var item=(this.params,this.currentItem),fields=["showTitle"];return(!item||"PhotoAlbum"!==item.Type&&"ChannelFolderItem"!==item.Type)&&fields.push("imageType"),fields.push("viewType"),fields}},{key:"getViewSettings",value:function getViewSettings(){var basekey=this.getSettingsKey(),params=this.params,item=this.currentItem,showTitle=userSettings.get(basekey+"-showTitle");"true"===showTitle?showTitle=!0:"false"===showTitle?showTitle=!1:("Programs"===params.type||"Recordings"===params.type||"Person"===params.type||"nextup"===params.type||"Audio"===params.type||"MusicAlbum"===params.type||"MusicArtist"===params.type||item&&"PhotoAlbum"!==item.Type)&&(showTitle=!0);var imageType=userSettings.get(basekey+"-imageType");return imageType||"nextup"!==params.type||(imageType="thumb"),{showTitle:showTitle,showYear:"false"!==userSettings.get(basekey+"-showYear"),imageType:imageType||"primary",viewType:userSettings.get(basekey+"-viewType")||"images"}}},{key:"getItemTypes",value:function getItemTypes(){var params=this.params;return"nextup"===params.type?["Episode"]:"Programs"===params.type?["Program"]:[]}},{key:"getSettingsKey",value:function getSettingsKey(){var values=[];values.push("items");var params=this.params;return params.type?values.push(params.type):params.parentId&&values.push(params.parentId),params.IsAiring&&values.push("IsAiring"),params.IsMovie&&values.push("IsMovie"),params.IsKids&&values.push("IsKids"),params.IsSports&&values.push("IsSports"),params.IsNews&&values.push("IsNews"),params.IsSeries&&values.push("IsSeries"),params.IsFavorite&&values.push("IsFavorite"),params.genreId&&values.push("Genre"),params.musicGenreId&&values.push("MusicGenre"),params.studioId&&values.push("Studio"),params.personId&&values.push("Person"),params.parentId&&values.push("Folder"),values.join("-")}}]),ItemsView}();_exports.default=_default}));
//# sourceMappingURL=list.js.map
