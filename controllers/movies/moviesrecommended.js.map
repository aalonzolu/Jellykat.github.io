{"version":3,"sources":["controllers/movies/moviesrecommended.js"],"names":["define","_require","_exports","_events","_layoutManager","_inputManager","userSettings","_libraryMenu","mainTabsManager","_cardBuilder","_dom","_imageLoader","_playbackManager","_globalize","_embyScroller","_embyItemscontainer","_embyTabs","_embyButton","_interopRequireDefault","obj","__esModule","default","_typeof","Symbol","iterator","constructor","prototype","_arrayLikeToArray","arr","len","length","i","arr2","Array","_getRequireWildcardCache","WeakMap","cache","_interopRequireWildcard","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","hasOwnProperty","call","desc","set","enableScrollX","layoutManager","desktop","getPortraitShape","getRecommendationHtml","recommendation","html","title","RecommendationType","globalize","translate","BaselineItemName","cardBuilder","getCardsHtml","Items","shape","scalable","overlayPlayButton","allowBottomPadding","showTitle","showYear","centerText","autoFocus","page","Promise","_resolve","_reject","imported","then","_ref","setScrollClasses","elem","scrollX","classList","add","tv","remove","getTabs","name","value","_default","view","params","_this","this","onBeforeTabChange","e","preLoadTab","index","getTabController","controller","renderedTabs","indexOf","preRender","parseInt","detail","selectedTabIndex","onTabChange","newIndex","loadTab","currentTabIndex","push","renderTab","getTabContainers","querySelectorAll","callback","depends","concat","_ref2","tabContent","controllerFactory","suggestionsTabIndex","querySelector","tabControllers","collectionType","parentId","topParentId","mode","initTab","onPlaybackStop","state","NowPlayingItem","MediaType","getTabsElement","triggerTabChange","onInputCommand","command","preventDefault","Dashboard","navigate","tab","getDefaultTabIndex","folderId","initSuggestedTab","_step","_iterator","_createForOfIteratorHelper","o","allowArrayLike","it","isArray","_unsupportedIterableToArray","minLen","n","toString","slice","from","test","F","s","done","_e","f","TypeError","err","normalCompletion","didErr","step","next","_e2","return","loadSuggestionsTab","userId","ApiClient","getCurrentUserId","loadResume","screenWidth","dom","getWindowSize","innerWidth","options","SortBy","SortOrder","IncludeItemTypes","Filters","Limit","Recursive","Fields","CollapseBoxSetItems","ParentId","ImageTypeLimit","EnableImageTypes","EnableTotalRecordCount","getItems","result","container","buildCards","itemsContainer","preferThumb","cardLayout","loadLatest","getJSON","getUrl","items","loadSuggestions","url","categoryLimit","ItemLimit","recommendations","innerHTML","map","join","recs","imageLoader","lazyChildren","addEventListener","initTabs","setTabs","getAttribute","getItem","item","setAttribute","Name","libraryMenu","setTitle","events","on","playbackManager","inputManager","window","off","_i","_tabControllers","tabController","destroy"],"mappings":"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","file":"moviesrecommended.js","sourcesContent":["import events from 'events';\nimport layoutManager from 'layoutManager';\nimport inputManager from 'inputManager';\nimport * as userSettings from 'userSettings';\nimport libraryMenu from 'libraryMenu';\nimport * as mainTabsManager from 'mainTabsManager';\nimport cardBuilder from 'cardBuilder';\nimport dom from 'dom';\nimport imageLoader from 'imageLoader';\nimport playbackManager from 'playbackManager';\nimport globalize from 'globalize';\nimport 'emby-scroller';\nimport 'emby-itemscontainer';\nimport 'emby-tabs';\nimport 'emby-button';\n\n/* eslint-disable indent */\n\n    function enableScrollX() {\n        return !layoutManager.desktop;\n    }\n\n    function getPortraitShape() {\n        return enableScrollX() ? 'overflowPortrait' : 'portrait';\n    }\n\n    function getThumbShape() {\n        return enableScrollX() ? 'overflowBackdrop' : 'backdrop';\n    }\n\n    function loadLatest(page, userId, parentId) {\n        const options = {\n            IncludeItemTypes: 'Movie',\n            Limit: 18,\n            Fields: 'PrimaryImageAspectRatio,MediaSourceCount,BasicSyncInfo',\n            ParentId: parentId,\n            ImageTypeLimit: 1,\n            EnableImageTypes: 'Primary,Backdrop,Banner,Thumb',\n            EnableTotalRecordCount: false\n        };\n        ApiClient.getJSON(ApiClient.getUrl('Users/' + userId + '/Items/Latest', options)).then(function (items) {\n            const allowBottomPadding = !enableScrollX();\n            const container = page.querySelector('#recentlyAddedItems');\n            cardBuilder.buildCards(items, {\n                itemsContainer: container,\n                shape: getPortraitShape(),\n                scalable: true,\n                overlayPlayButton: true,\n                allowBottomPadding: allowBottomPadding,\n                showTitle: true,\n                showYear: true,\n                centerText: true\n            });\n\n            // FIXME: Wait for all sections to load\n            autoFocus(page);\n        });\n    }\n\n    function loadResume(page, userId, parentId) {\n        let screenWidth = dom.getWindowSize().innerWidth;\n        const options = {\n            SortBy: 'DatePlayed',\n            SortOrder: 'Descending',\n            IncludeItemTypes: 'Movie',\n            Filters: 'IsResumable',\n            Limit: screenWidth >= 1920 ? 5 : screenWidth >= 1600 ? 5 : 3,\n            Recursive: true,\n            Fields: 'PrimaryImageAspectRatio,MediaSourceCount,BasicSyncInfo',\n            CollapseBoxSetItems: false,\n            ParentId: parentId,\n            ImageTypeLimit: 1,\n            EnableImageTypes: 'Primary,Backdrop,Banner,Thumb',\n            EnableTotalRecordCount: false\n        };\n        ApiClient.getItems(userId, options).then(function (result) {\n            if (result.Items.length) {\n                page.querySelector('#resumableSection').classList.remove('hide');\n            } else {\n                page.querySelector('#resumableSection').classList.add('hide');\n            }\n\n            const allowBottomPadding = !enableScrollX();\n            const container = page.querySelector('#resumableItems');\n            cardBuilder.buildCards(result.Items, {\n                itemsContainer: container,\n                preferThumb: true,\n                shape: getThumbShape(),\n                scalable: true,\n                overlayPlayButton: true,\n                allowBottomPadding: allowBottomPadding,\n                cardLayout: false,\n                showTitle: true,\n                showYear: true,\n                centerText: true\n            });\n\n            // FIXME: Wait for all sections to load\n            autoFocus(page);\n        });\n    }\n\n    function getRecommendationHtml(recommendation) {\n        let html = '';\n        let title = '';\n\n        switch (recommendation.RecommendationType) {\n            case 'SimilarToRecentlyPlayed':\n                title = globalize.translate('RecommendationBecauseYouWatched', recommendation.BaselineItemName);\n                break;\n\n            case 'SimilarToLikedItem':\n                title = globalize.translate('RecommendationBecauseYouLike', recommendation.BaselineItemName);\n                break;\n\n            case 'HasDirectorFromRecentlyPlayed':\n            case 'HasLikedDirector':\n                title = globalize.translate('RecommendationDirectedBy', recommendation.BaselineItemName);\n                break;\n\n            case 'HasActorFromRecentlyPlayed':\n            case 'HasLikedActor':\n                title = globalize.translate('RecommendationStarring', recommendation.BaselineItemName);\n                break;\n        }\n\n        html += '<div class=\"verticalSection\">';\n        html += '<h2 class=\"sectionTitle sectionTitle-cards padded-left\">' + title + '</h2>';\n        const allowBottomPadding = true;\n\n        if (enableScrollX()) {\n            html += '<div is=\"emby-scroller\" class=\"padded-top-focusscale padded-bottom-focusscale\" data-mousewheel=\"false\" data-centerfocus=\"true\">';\n            html += '<div is=\"emby-itemscontainer\" class=\"itemsContainer scrollSlider focuscontainer-x\">';\n        } else {\n            html += '<div is=\"emby-itemscontainer\" class=\"itemsContainer focuscontainer-x padded-left padded-right vertical-wrap\">';\n        }\n\n        html += cardBuilder.getCardsHtml(recommendation.Items, {\n            shape: getPortraitShape(),\n            scalable: true,\n            overlayPlayButton: true,\n            allowBottomPadding: allowBottomPadding,\n            showTitle: true,\n            showYear: true,\n            centerText: true\n        });\n\n        if (enableScrollX()) {\n            html += '</div>';\n        }\n        html += '</div>';\n        html += '</div>';\n        return html;\n    }\n\n    function loadSuggestions(page, userId, parentId) {\n        let screenWidth = dom.getWindowSize().innerWidth;\n        let url = ApiClient.getUrl('Movies/Recommendations', {\n            userId: userId,\n            categoryLimit: 6,\n            ItemLimit: screenWidth >= 1920 ? 8 : screenWidth >= 1600 ? 8 : screenWidth >= 1200 ? 6 : 5,\n            Fields: 'PrimaryImageAspectRatio,MediaSourceCount,BasicSyncInfo',\n            ImageTypeLimit: 1,\n            EnableImageTypes: 'Primary,Backdrop,Banner,Thumb'\n        });\n        ApiClient.getJSON(url).then(function (recommendations) {\n            if (!recommendations.length) {\n                page.querySelector('.noItemsMessage').classList.remove('hide');\n                page.querySelector('.recommendations').innerHTML = '';\n                return;\n            }\n\n            const html = recommendations.map(getRecommendationHtml).join('');\n            page.querySelector('.noItemsMessage').classList.add('hide');\n            let recs = page.querySelector('.recommendations');\n            recs.innerHTML = html;\n            imageLoader.lazyChildren(recs);\n\n            // FIXME: Wait for all sections to load\n            autoFocus(page);\n        });\n    }\n\n    function autoFocus(page) {\n        import('autoFocuser').then(({default: autoFocuser}) => {\n            autoFocuser.autoFocus(page);\n        });\n    }\n\n    function setScrollClasses(elem, scrollX) {\n        if (scrollX) {\n            elem.classList.add('hiddenScrollX');\n\n            if (layoutManager.tv) {\n                elem.classList.add('smoothScrollX');\n                elem.classList.add('padded-top-focusscale');\n                elem.classList.add('padded-bottom-focusscale');\n            }\n\n            elem.classList.add('scrollX');\n            elem.classList.remove('vertical-wrap');\n        } else {\n            elem.classList.remove('hiddenScrollX');\n            elem.classList.remove('smoothScrollX');\n            elem.classList.remove('scrollX');\n            elem.classList.add('vertical-wrap');\n        }\n    }\n\n    function initSuggestedTab(page, tabContent) {\n        const containers = tabContent.querySelectorAll('.itemsContainer');\n\n        for (const container of containers) {\n            setScrollClasses(container, enableScrollX());\n        }\n    }\n\n    function loadSuggestionsTab(view, params, tabContent) {\n        const parentId = params.topParentId;\n        const userId = ApiClient.getCurrentUserId();\n        loadResume(tabContent, userId, parentId);\n        loadLatest(tabContent, userId, parentId);\n        loadSuggestions(tabContent, userId, parentId);\n    }\n\n    function getTabs() {\n        return [{\n            name: globalize.translate('Movies')\n        }, {\n            name: globalize.translate('Suggestions')\n        }, {\n            name: globalize.translate('Trailers')\n        }, {\n            name: globalize.translate('Favorites')\n        }, {\n            name: globalize.translate('Collections')\n        }, {\n            name: globalize.translate('Genres')\n        }];\n    }\n\n    function getDefaultTabIndex(folderId) {\n        switch (userSettings.get('landing-' + folderId)) {\n            case 'suggestions':\n                return 1;\n\n            case 'favorites':\n                return 3;\n\n            case 'collections':\n                return 4;\n\n            case 'genres':\n                return 5;\n\n            default:\n                return 0;\n        }\n    }\n\n    export default function (view, params) {\n        function onBeforeTabChange(e) {\n            preLoadTab(view, parseInt(e.detail.selectedTabIndex));\n        }\n\n        function onTabChange(e) {\n            const newIndex = parseInt(e.detail.selectedTabIndex);\n            loadTab(view, newIndex);\n        }\n\n        function getTabContainers() {\n            return view.querySelectorAll('.pageTabContent');\n        }\n\n        function initTabs() {\n            mainTabsManager.setTabs(view, currentTabIndex, getTabs, getTabContainers, onBeforeTabChange, onTabChange);\n        }\n\n        const getTabController = (page, index, callback) => {\n            let depends = '';\n\n            switch (index) {\n                case 0:\n                    depends = 'controllers/movies/movies';\n                    break;\n\n                case 1:\n                    depends = 'controllers/movies/moviesrecommended.js';\n                    break;\n\n                case 2:\n                    depends = 'controllers/movies/movietrailers';\n                    break;\n\n                case 3:\n                    depends = 'controllers/movies/movies';\n                    break;\n\n                case 4:\n                    depends = 'controllers/movies/moviecollections';\n                    break;\n\n                case 5:\n                    depends = 'controllers/movies/moviegenres';\n                    break;\n            }\n\n            import(depends).then(({default: controllerFactory}) => {\n                let tabContent;\n\n                if (index === suggestionsTabIndex) {\n                    tabContent = view.querySelector(\".pageTabContent[data-index='\" + index + \"']\");\n                    this.tabContent = tabContent;\n                }\n\n                let controller = tabControllers[index];\n\n                if (!controller) {\n                    tabContent = view.querySelector(\".pageTabContent[data-index='\" + index + \"']\");\n\n                    if (index === suggestionsTabIndex) {\n                        controller = this;\n                    } else if (index === 6) {\n                        controller = new controllerFactory(view, tabContent, {\n                            collectionType: 'movies',\n                            parentId: params.topParentId\n                        });\n                    } else if (index == 0 || index == 3) {\n                        controller = new controllerFactory(view, params, tabContent, {\n                            mode: index ? 'favorites' : 'movies'\n                        });\n                    } else {\n                        controller = new controllerFactory(view, params, tabContent);\n                    }\n\n                    tabControllers[index] = controller;\n\n                    if (controller.initTab) {\n                        controller.initTab();\n                    }\n                }\n\n                callback(controller);\n            });\n        };\n\n        function preLoadTab(page, index) {\n            getTabController(page, index, function (controller) {\n                if (renderedTabs.indexOf(index) == -1 && controller.preRender) {\n                    controller.preRender();\n                }\n            });\n        }\n\n        function loadTab(page, index) {\n            currentTabIndex = index;\n            getTabController(page, index, ((controller) => {\n                if (renderedTabs.indexOf(index) == -1) {\n                    renderedTabs.push(index);\n                    controller.renderTab();\n                }\n            }));\n        }\n\n        function onPlaybackStop(e, state) {\n            if (state.NowPlayingItem && state.NowPlayingItem.MediaType == 'Video') {\n                renderedTabs = [];\n                mainTabsManager.getTabsElement().triggerTabChange();\n            }\n        }\n\n        function onInputCommand(e) {\n            switch (e.detail.command) {\n                case 'search':\n                    e.preventDefault();\n                    Dashboard.navigate('search.html?collectionType=movies&parentId=' + params.topParentId);\n            }\n        }\n\n        let currentTabIndex = parseInt(params.tab || getDefaultTabIndex(params.topParentId));\n        const suggestionsTabIndex = 1;\n\n        this.initTab = function () {\n            let tabContent = view.querySelector(\".pageTabContent[data-index='\" + suggestionsTabIndex + \"']\");\n            initSuggestedTab(view, tabContent);\n        };\n\n        this.renderTab = function () {\n            let tabContent = view.querySelector(\".pageTabContent[data-index='\" + suggestionsTabIndex + \"']\");\n            loadSuggestionsTab(view, params, tabContent);\n        };\n\n        let tabControllers = [];\n        let renderedTabs = [];\n        view.addEventListener('viewshow', function (e) {\n            initTabs();\n            if (!view.getAttribute('data-title')) {\n                var parentId = params.topParentId;\n\n                if (parentId) {\n                    ApiClient.getItem(ApiClient.getCurrentUserId(), parentId).then(function (item) {\n                        view.setAttribute('data-title', item.Name);\n                        libraryMenu.setTitle(item.Name);\n                    });\n                } else {\n                    view.setAttribute('data-title', globalize.translate('Movies'));\n                    libraryMenu.setTitle(globalize.translate('Movies'));\n                }\n            }\n\n            events.on(playbackManager, 'playbackstop', onPlaybackStop);\n            inputManager.on(window, onInputCommand);\n        });\n        view.addEventListener('viewbeforehide', function () {\n            inputManager.off(window, onInputCommand);\n        });\n        for (const tabController of tabControllers) {\n            if (tabController.destroy) {\n                tabController.destroy();\n            }\n        }\n    }\n\n/* eslint-enable indent */\n"]}