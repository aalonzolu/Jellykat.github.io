define(["exports","layoutManager","loading","datetime","cardBuilder","imageLoader","globalize","scrollStyles","emby-itemscontainer"],(function(_exports,_layoutManager,_loading,_datetime,_cardBuilder,_imageLoader,_globalize,_scrollStyles,_embyItemscontainer){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function enableScrollX(){return!_layoutManager.default.desktop}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=function _default(view,params,tabContent){var upcomingPromise;this.preRender=function(){upcomingPromise=function getUpcomingPromise(context,params){_loading.default.show();var query={Limit:48,Fields:"AirTime,UserData",UserId:ApiClient.getCurrentUserId(),ImageTypeLimit:1,EnableImageTypes:"Primary,Backdrop,Banner,Thumb",EnableTotalRecordCount:!1};return query.ParentId=params.topParentId,ApiClient.getJSON(ApiClient.getUrl("Shows/Upcoming",query))}(0,params)},this.renderTab=function(){!function loadUpcoming(context,params,promise){promise.then((function(result){var items=result.Items;items.length?context.querySelector(".noItemsMessage").style.display="none":context.querySelector(".noItemsMessage").style.display="block",function renderUpcoming(elem,items){for(var groups=[],currentGroupName="",currentGroup=[],i=0,length=items.length;i<length;i++){var item=items[i],dateText="";if(item.PremiereDate)try{var premiereDate=_datetime.default.parseISO8601Date(item.PremiereDate,!0);dateText=_datetime.default.isRelativeDay(premiereDate,-1)?_globalize.default.translate("Yesterday"):_datetime.default.toLocaleDateString(premiereDate,{weekday:"long",month:"short",day:"numeric"})}catch(err){console.error("error parsing timestamp for upcoming tv shows")}dateText!=currentGroupName?(currentGroup.length&&groups.push({name:currentGroupName,items:currentGroup}),currentGroupName=dateText,currentGroup=[item]):currentGroup.push(item)}for(var html="",_i=0,_length=groups.length;_i<_length;_i++){var group=groups[_i];html+='<div class="verticalSection">',html+='<h2 class="sectionTitle sectionTitle-cards padded-left">'+group.name+"</h2>";var allowBottomPadding=!0;if(enableScrollX()){allowBottomPadding=!1;var scrollXClass="scrollX hiddenScrollX";_layoutManager.default.tv&&(scrollXClass+=" smoothScrollX"),html+='<div is="emby-itemscontainer" class="itemsContainer '+scrollXClass+' padded-left padded-right">'}else html+='<div is="emby-itemscontainer" class="itemsContainer vertical-wrap padded-left padded-right">';html+=_cardBuilder.default.getCardsHtml({items:group.items,showLocationTypeIndicator:!1,shape:enableScrollX()?"overflowBackdrop":"backdrop",showTitle:!0,preferThumb:!0,lazy:!0,showDetailsMenu:!0,centerText:!0,showParentTitle:!0,overlayText:!1,allowBottomPadding:allowBottomPadding,cardLayout:!1,overlayMoreButton:!0,missingIndicator:!1}),html+="</div>",html+="</div>"}elem.innerHTML=html,_imageLoader.default.lazyChildren(elem)}(context.querySelector("#upcomingItems"),items),_loading.default.hide()}))}(tabContent,0,upcomingPromise)}},_layoutManager=_interopRequireDefault(_layoutManager),_loading=_interopRequireDefault(_loading),_datetime=_interopRequireDefault(_datetime),_cardBuilder=_interopRequireDefault(_cardBuilder),_imageLoader=_interopRequireDefault(_imageLoader),_globalize=_interopRequireDefault(_globalize)}));
//# sourceMappingURL=tvupcoming.js.map
